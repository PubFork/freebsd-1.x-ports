# File: Makefile.in
# Author: Jeff Bilmes
# Copyright (C) International Computer Science Institute, 1991
# Changes: Heinz Schmidt (hws@csis.dit.csiro.AU)
# Copyright (C) CSIRO Division of Information Technology, 1992
#
# COPYRIGHT NOTICE: This code is provided "AS IS" WITHOUT ANY WARRANTY
# and is subject to the terms of the SATHER LIBRARY GENERAL PUBLIC
# LICENSE contained in the file: "sather/doc/license.txt" of the Sather
# distribution. The license is also available from ICSI, 1947 Center
# St., Suite 600, Berkeley CA 94704, USA.
# ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
# FUNCTION:
#    Makefile for handling precompiled base classes
#
#* RCS: $Id: Makefile.in,v 1.1 1994/02/12 03:23:36 hsu Exp $
#* HISTORY:
#* Last edited: Feb  1 17:46 1992 (hws)
#*  Oct 24 22:20 1993 (hws): add distclean
#*  Sep  1 09:38 1993 (oscar): ensure the compiler ases the right $ARCH
#*  Apr 17 08:35 1993 (hws): use -ncs. This is useful during development.
#*  Feb  1 19:33 1992 (hws): include shared defaults now.
#*  Feb  1 17:46 1992 (hws): ARCH itecture dependent bin introduced 
#* Created: Mon Jan  7 09:33:08 1991
#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

# Local defaults
PREDIR   = ${TOPDIR}/bin.${ENVI}/precompiled

all:	mk_pre
	if [ -d ${PREDIR} ] ; then \
	   ${ECHO} ${PREDIR} exists ; \
	else \
	   ${MD} ${PREDIR} ; \
	fi 
	( ${ECHON} "Installing precompiled files in ${PREDIR}..." ; \
	  for i in array_1.o array22.o array33.o array44.o array_24.o bool__16.o \
	     char__14.o double18.o err___7.o file__11.o in____8.o int___15.o \
	     out___9.o real__17.o str___20.o str_cu12.o sys___13.o sux___22.o array_1.c \
	     array22.c array33.c array44.c array_24.c bool__16.c char__14.c \
	     double18.c err___7.c file__11.c in____8.c int___15.c out___9.c \
	     real__17.c str___20.c str_cu12.c sys___13.c sux___22.c c_names_.h offsets_.h ; \
	   do \
	     ${CP} ${TOPDIR}/sys/C/crt_pre/mk_pre.cs/$$i ${PREDIR} ; \
	   done ; \
	   ${ECHON} "... done." )

mk_pre:
	@echo Making precompiled classes.
	( SATHER_ENVI=${ENVI}; export SATHER_ENVI; \
	 SATHER_HOME=${TOPDIR}; export SATHER_HOME; \
	 ${CS} ${CSFLAGS} -x ${ENVI} -hom ${TOPDIR} -gen -ncs -info -all mk_pre ; \
	 ( cd  ${TOPDIR}/sys/C/crt_pre/mk_pre.cs ; \
	   ${MKCMD} MAINCC="${MAINCC}" MAINFLAGS="${MAINFLAGS}" ; ) ;  )
	${TOUCH} mk_pre


clean:
	-${RM} -r mk_pre.cs mk_pre

distclean:
	${MAKE} clean
