# Generated automatically from Makefile.in by configure.
#
# This file is a Makefile for Tcl.  If it has the name "Makefile.in"
# then it is a template for a Makefile;  to generate the actual Makefile,
# run "./configure", which is a configuration script generated by the
# "autoconf" program (constructs like "@foo@" will get replaced in the
# actual Makefile.

#----------------------------------------------------------------
# Things you can change to personalize the Makefile for your own
# site (you can make these changes in either Makefile.in or
# Makefile, but changes to Makefile will get lost if you re-run
# the configuration script).
#----------------------------------------------------------------

# Default top-level directories in which to install architecture-
# specific files (exec_prefix) and machine-independent files such
# as scripts (prefix).  The values specified here may be overridden
# at configure-time with the --exec-prefix and --prefix options
# to the "configure" script.

exec_prefix =	${prefix}
prefix =	/usr/local

# Directory in which to install the library of Tcl scripts (note:
# you can set the TCL_LIBRARY environment variable at run-time to
# override the compiled-in location):
TCL_LIBRARY =	$(prefix)/lib/tcl

# Directory in which to install the archive libtcl.a:
LIB_DIR =	$(exec_prefix)/lib

# Directory in which to install the program tclsh:
BIN_DIR =	$(exec_prefix)/bin

# Directory in which to install the include file tcl.h:
INCLUDE_DIR =	$(prefix)/include

# Top-level directory for manual entries:
MAN_DIR =	$(prefix)/man

# Directory in which to install manual entry for tclsh:
MAN1_DIR =	$(MAN_DIR)/man1

# Directory in which to install manual entries for Tcl's C library
# procedures:
MAN3_DIR =	$(MAN_DIR)/man3

# Directory in which to install manual entries for the built-in
# Tcl commands:
MANN_DIR =	$(MAN_DIR)/mann

# To change the compiler switches, for example to change from -O
# to -g, change the following line:
CFLAGS =-O2 -m486

# To disable ANSI-C procedure prototypes reverse the comment characters
# on the following lines:
PROTO_FLAGS =
#PROTO_FLAGS = -DNO_PROTOTYPE

# Mathematical functions like sin and atan2 are enabled for expressions
# by default.  To disable them, reverse the comment characters on the
# following pairs of lines:
MATH_FLAGS =
#MATH_FLAGS = -DTCL_NO_MATH
MATH_LIBS = -lm
#MATH_LIBS =

# To compile for non-UNIX systems (so that only the non-UNIX-specific
# commands are available), reverse the comment characters on the
# following pairs of lines.  In addition, you'll have to provide your
# own replacement for the "panic" procedure (see panic.c for what
# the current one does).
GENERIC_FLAGS =
#GENERIC_FLAGS = -DTCL_GENERIC_ONLY
UNIX_OBJS = panic.o tclEnv.o tclGlob.o tclMain.o tclUnixAZ.o \
	tclUnixStr.o tclUnixUtil.o
UNIX_SOBJS = panic.so tclEnv.so tclGlob.so tclMain.so tclUnixAZ.so \
	tclUnixStr.so tclUnixUtil.so
#UNIX_OBJS =

# To enable memory debugging reverse the comment characters on the following
# lines.  Warning:  if you enable memory debugging, you must do it
# *everywhere*, including all the code that calls Tcl, and you must use
# ckalloc and ckfree everywhere instead of malloc and free.
MEM_DEBUG_FLAGS =
#MEM_DEBUG_FLAGS = -DTCL_MEM_DEBUG

# Some versions of make, like SGI's, use the following variable to
# determine which shell to use for executing commands:
SHELL =		/bin/sh

#----------------------------------------------------------------
# The information below is modified by the configure script when
# Makefile is generated from Makefile.in.  You shouldn't normally
# modify any of this stuff by hand.
#----------------------------------------------------------------

COMPAT_OBJS =
# getcwd.o opendir.o strerror.o strstr.o strtol.o tmpnam.o waitpid.o strtoul.o strtod.o
COMPAT_SOBJS =
#AC_FLAGS =		 -DNO_GETTOD=1 -DNO_GETWD=1 -DNO_WAIT3=1 -DNO_DIRENT_H=1 -DNO_ERRNO_H=1 -DNO_FLOAT_H=1 -DNO_LIMITS_H=1 -DNO_STDLIB_H=1 -DNO_STRING_H=1 -DNO_SYS_TIME_H=1 -DNO_SYS_WAIT_H=1 -Dmode_t=int -Dpid_t=int -Dsize_t=unsigned -Duid_t=int -Dgid_t=int -DUSE_DIRENT2_H=1 -DNO_UNION_WAIT=1

AC_FLAGS =

INSTALL =		/usr/bin/install -c
INSTALL_PROGRAM =	$(INSTALL)
INSTALL_DATA =		$(INSTALL) -m 644
RANLIB =		ranlib
SRC_DIR =		.
VPATH =			.

#----------------------------------------------------------------
# The information below should be usable as is.  The configure
# script won't modify it and you shouldn't need to modify it
# either.
#----------------------------------------------------------------


CC =		cc
CC_SWITCHES =	${CFLAGS} -I. -I${SRC_DIR} ${AC_FLAGS} ${MATH_FLAGS} \
${GENERIC_FLAGS} ${PROTO_FLAGS} ${MEM_DEBUG_FLAGS} \
-DTCL_LIBRARY=\"${TCL_LIBRARY}\"

GENERIC_OBJS =	regexp.o tclAsync.o tclBasic.o tclCkalloc.o \
	tclCmdAH.o tclCmdIL.o tclCmdMZ.o tclExpr.o tclGet.o \
	tclHash.o tclHistory.o tclLink.o tclParse.o tclProc.o \
	tclUtil.o tclVar.o

OBJS = ${GENERIC_OBJS} ${UNIX_OBJS} ${COMPAT_OBJS}

GENERIC_SOBJS =	regexp.so tclAsync.so tclBasic.so tclCkalloc.so \
	tclCmdAH.so tclCmdIL.so tclCmdMZ.so tclExpr.so tclGet.so \
	tclHash.so tclHistory.so tclLink.so tclParse.so tclProc.so \
	tclUtil.so tclVar.so

SOBJS = ${GENERIC_SOBJS} ${UNIX_SOBJS} ${COMPAT_SOBJS}

VERS_MAJOR=7
VERS_MINOR=3

all: libtcl.a libtcl.so.${VERS_MAJOR}.${VERS_MINOR} tclsh

libtcl.a: ${OBJS}
	rm -f libtcl.a
	ar cr libtcl.a ${OBJS}
	$(RANLIB) libtcl.a

libtcl.so.${VERS_MAJOR}.${VERS_MINOR}: ${SOBJS}
	rm -f libtcl.so.${VERS_MAJOR}.${VERS_MINOR}
	ld -Bshareable -Bforcearchive -o libtcl.so.${VERS_MAJOR}.${VERS_MINOR} ${SOBJS}

tclsh: tclAppInit.o libtcl.a
	${CC} ${CC_SWITCHES} tclAppInit.o -L. -ltcl ${MATH_LIBS} -o tclsh

tcltest: tclTest.o libtcl.a
	${CC} ${CC_SWITCHES} tclTest.o -L. -ltcl ${MATH_LIBS} -o tcltest

test: tcltest
	@cwd=`pwd`; \
	cd $(SRC_DIR); TCL_LIBRARY=`pwd`/library; export TCL_LIBRARY; \
	cd $$cwd; ( echo cd $(SRC_DIR)/tests\; source all ) | ./tcltest

package:	pkg_bin

pkg_bin: pkg/+DESC pkg/+ONELINE pkg/+PLIST all install
	pkg_create -c pkg/+ONELINE -d pkg/+DESC -f pkg/+PLIST tcl_bin

install: install-binaries install-libraries install-man

install-binaries: libtcl.a libtcl.so.${VERS_MAJOR}.${VERS_MINOR} tclsh
	@for i in $(LIB_DIR) $(BIN_DIR) ; \
	    do \
	    if [ ! -d $$i ] ; then \
		echo "Making directory $$i"; \
		mkdir $$i; \
		chmod 755 $$i; \
		else true; \
		fi; \
	    done;
	@echo "Installing libtcl.a"
	@$(INSTALL_DATA) libtcl.a $(LIB_DIR)
	@$(RANLIB) $(LIB_DIR)/libtcl.a
	@echo "Installing libtcl.so.${VERS_MAJOR}.${VERS_MINOR}"
	@$(INSTALL_DATA) libtcl.so.${VERS_MAJOR}.${VERS_MINOR} $(LIB_DIR)
	@echo "Installing tclsh"
	@$(INSTALL_PROGRAM) tclsh $(BIN_DIR)

install-libraries:
	@for i in $(prefix)/lib $(INCLUDE_DIR) $(TCL_LIBRARY) ; \
	    do \
	    if [ ! -d $$i ] ; then \
		echo "Making directory $$i"; \
		mkdir $$i; \
		chmod 755 $$i; \
		else true; \
		fi; \
	    done;
	@echo "Installing tcl.h"
	@$(INSTALL_DATA) $(SRC_DIR)/tcl.h $(INCLUDE_DIR)
	@cd $(SRC_DIR)/library; for i in *.tcl tclIndex; \
	    do \
	    echo "Installing library/$$i"; \
	    $(INSTALL_DATA) $$i $(TCL_LIBRARY); \
	    done;

install-man:
	@for i in $(MAN_DIR) $(MAN1_DIR) $(MAN3_DIR) $(MANN_DIR) ; \
	    do \
	    if [ ! -d $$i ] ; then \
		echo "Making directory $$i"; \
		mkdir $$i; \
		chmod 755 $$i; \
		else true; \
		fi; \
	    done;
	@cd $(SRC_DIR)/doc; for i in *.[3n]; \
	    do \
	    echo "Installing doc/$$i"; \
	    rm -f $(MAN1_DIR)/$$i; \
	    sed -e '/man\.macros/r man.macros' -e '/man\.macros/d' \
		    $$i > $(MAN1_DIR)/$$i; \
	    chmod 444 $(MAN1_DIR)/$$i; \
	    done;
	@cd $(SRC_DIR)/doc; for i in *.3; \
	    do \
	    echo "Installing doc/$$i"; \
	    rm -f $(MAN3_DIR)/$$i; \
	    sed -e '/man\.macros/r man.macros' -e '/man\.macros/d' \
		    $$i > $(MAN3_DIR)/$$i; \
	    chmod 444 $(MAN3_DIR)/$$i; \
	    done;
	@cd $(SRC_DIR)/doc; for i in *.n; \
	    do \
	    echo "Installing doc/$$i"; \
	    rm -f $(MANN_DIR)/$$i; \
	    sed -e '/man\.macros/r man.macros' -e '/man\.macros/d' \
		    $$i > $(MANN_DIR)/$$i; \
	    chmod 444 $(MANN_DIR)/$$i; \
	    done;

Makefile: $(SRC_DIR)/Makefile.in
	$(SHELL) config.status

clean:
	rm -f *.a *.o *.so *.so.* core errs *~ \#* TAGS *.E a.out errors tclsh tcltest

distclean: clean
	rm -f Makefile config.status

PICFLAGS=-fpic -DPIC

getcwd.o: $(SRC_DIR)/compat/getcwd.c
	$(CC) -c $(CC_SWITCHES) $(SRC_DIR)/compat/getcwd.c

getcwd.so: $(SRC_DIR)/compat/getcwd.c
	$(CC) $(PICFLAGS) -c $(CC_SWITCHES) $(SRC_DIR)/compat/getcwd.c -o getcwd.so

opendir.o: $(SRC_DIR)/compat/opendir.c
	$(CC) -c $(CC_SWITCHES) $(SRC_DIR)/compat/opendir.c

opendir.so: $(SRC_DIR)/compat/opendir.c
	$(CC) $(PICFLAGS) -c $(CC_SWITCHES) $(SRC_DIR)/compat/opendir.c -o opendir.so

strerror.o: $(SRC_DIR)/compat/strerror.c
	$(CC) -c $(CC_SWITCHES) $(SRC_DIR)/compat/strerror.c

strerror.so: $(SRC_DIR)/compat/strerror.c
	$(CC) $(PICFLAGS) -c $(CC_SWITCHES) $(SRC_DIR)/compat/strerror.c -o strerror.so

strstr.o: $(SRC_DIR)/compat/strstr.c
	$(CC) -c $(CC_SWITCHES) $(SRC_DIR)/compat/strstr.c

strstr.so: $(SRC_DIR)/compat/strstr.c
	$(CC) $(PICFLAGS) -c $(CC_SWITCHES) $(SRC_DIR)/compat/strstr.c -o strstr.so

strtod.o: $(SRC_DIR)/compat/strtod.c
	$(CC) -c $(CC_SWITCHES) $(SRC_DIR)/compat/strtod.c

strtod.so: $(SRC_DIR)/compat/strtod.c
	$(CC) $(PICFLAGS) -c $(CC_SWITCHES) $(SRC_DIR)/compat/strtod.c -o strtod.so

strtol.o: $(SRC_DIR)/compat/strtol.c
	$(CC) -c $(CC_SWITCHES) $(SRC_DIR)/compat/strtol.c

strtol.so: $(SRC_DIR)/compat/strtol.c
	$(CC) $(PICFLAGS) -c $(CC_SWITCHES) $(SRC_DIR)/compat/strtol.c -o strtol.so

strtoul.o: $(SRC_DIR)/compat/strtoul.c
	$(CC) -c $(CC_SWITCHES) $(SRC_DIR)/compat/strtoul.c

strtoul.so: $(SRC_DIR)/compat/strtoul.c
	$(CC) $(PICFLAGS) -c $(CC_SWITCHES) $(SRC_DIR)/compat/strtoul.c -o strtoul.so

tmpnam.o: $(SRC_DIR)/compat/tmpnam.c
	$(CC) -c $(CC_SWITCHES) $(SRC_DIR)/compat/tmpnam.c

tmpnam.so: $(SRC_DIR)/compat/tmpnam.c
	$(CC) $(PICFLAGS) -c $(CC_SWITCHES) $(SRC_DIR)/compat/tmpnam.c -o tmpnam.so

waitpid.o: $(SRC_DIR)/compat/waitpid.c
	$(CC) -c $(CC_SWITCHES) $(SRC_DIR)/compat/waitpid.c

waitpid.so: $(SRC_DIR)/compat/waitpid.c
	$(CC) $(PICFLAGS) -c $(CC_SWITCHES) $(SRC_DIR)/compat/waitpid.c -o waitpid.so

.c.o:
	$(CC) -c $(CC_SWITCHES) $<

${OBJS}: $(SRC_DIR)/tcl.h $(SRC_DIR)/tclInt.h
${UNIX_OBJS}: $(SRC_DIR)/tclUnix.h
tclCmdIL.o: $(SRC_DIR)/patchlevel.h

.SUFFIXES: .so

.c.so:
	$(CC) $(PICFLAGS) $(CC_SWITCHES) -c $< -o $@

${SOBJS}: $(SRC_DIR)/tcl.h $(SRC_DIR)/tclInt.h
${UNIX_SOBJS}: $(SRC_DIR)/tclUnix.h
tclCmdIL.so: $(SRC_DIR)/patchlevel.h
