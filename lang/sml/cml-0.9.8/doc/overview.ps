%!PS-Adobe-2.0
%%Creator: dvips 5.497 Copyright 1986, 1992 Radical Eye Software
%%Title: paper.dvi
%%CreationDate: Mon Feb 15 18:02:25 1993
%%Pages: 25
%%PageOrder: Ascend
%%BoundingBox: 0 0 612 792
%%DocumentFonts: Helvetica Times-Roman Times-Bold Times-Italic
%%EndComments
%DVIPSCommandLine: /usr/local/tex/bin/dvips -o paper.ps paper.dvi
%DVIPSSource:  TeX output 1993.02.15:1802
%%BeginProcSet: tex.pro
/TeXDict 250 dict def TeXDict begin /N{def}def /B{bind def}N /S{exch}N /X{S N}
B /TR{translate}N /isls false N /vsize 11 72 mul N /@rigin{isls{[0 -1 1 0 0 0]
concat}if 72 Resolution div 72 VResolution div neg scale isls{Resolution hsize
-72 div mul 0 TR}if Resolution VResolution vsize -72 div 1 add mul TR matrix
currentmatrix dup dup 4 get round 4 exch put dup dup 5 get round 5 exch put
setmatrix}N /@landscape{/isls true N}B /@manualfeed{statusdict /manualfeed
true put}B /@copies{/#copies X}B /FMat[1 0 0 -1 0 0]N /FBB[0 0 0 0]N /nn 0 N
/IE 0 N /ctr 0 N /df-tail{/nn 8 dict N nn begin /FontType 3 N /FontMatrix
fntrx N /FontBBox FBB N string /base X array /BitMaps X /BuildChar{
CharBuilder}N /Encoding IE N end dup{/foo setfont}2 array copy cvx N load 0 nn
put /ctr 0 N[}B /df{/sf 1 N /fntrx FMat N df-tail}B /dfs{div /sf X /fntrx[sf 0
0 sf neg 0 0]N df-tail}B /E{pop nn dup definefont setfont}B /ch-width{ch-data
dup length 5 sub get}B /ch-height{ch-data dup length 4 sub get}B /ch-xoff{128
ch-data dup length 3 sub get sub}B /ch-yoff{ch-data dup length 2 sub get 127
sub}B /ch-dx{ch-data dup length 1 sub get}B /ch-image{ch-data dup type
/stringtype ne{ctr get /ctr ctr 1 add N}if}B /id 0 N /rw 0 N /rc 0 N /gp 0 N
/cp 0 N /G 0 N /sf 0 N /CharBuilder{save 3 1 roll S dup /base get 2 index get
S /BitMaps get S get /ch-data X pop /ctr 0 N ch-dx 0 ch-xoff ch-yoff ch-height
sub ch-xoff ch-width add ch-yoff setcachedevice ch-width ch-height true[1 0 0
-1 -.1 ch-xoff sub ch-yoff .1 add]{ch-image}imagemask restore}B /D{/cc X dup
type /stringtype ne{]}if nn /base get cc ctr put nn /BitMaps get S ctr S sf 1
ne{dup dup length 1 sub dup 2 index S get sf div put}if put /ctr ctr 1 add N}
B /I{cc 1 add D}B /bop{userdict /bop-hook known{bop-hook}if /SI save N @rigin
0 0 moveto /V matrix currentmatrix dup 1 get dup mul exch 0 get dup mul add
.99 lt{/QV}{/RV}ifelse load def pop pop}N /eop{SI restore showpage userdict
/eop-hook known{eop-hook}if}N /@start{userdict /start-hook known{start-hook}
if pop /VResolution X /Resolution X 1000 div /DVImag X /IE 256 array N 0 1 255
{IE S 1 string dup 0 3 index put cvn put}for 65781.76 div /vsize X 65781.76
div /hsize X}N /p{show}N /RMat[1 0 0 -1 0 0]N /BDot 260 string N /rulex 0 N
/ruley 0 N /v{/ruley X /rulex X V}B /V{}B /RV statusdict begin /product where{
pop product dup length 7 ge{0 7 getinterval dup(Display)eq exch 0 4
getinterval(NeXT)eq or}{pop false}ifelse}{false}ifelse end{{gsave TR -.1 -.1
TR 1 1 scale rulex ruley false RMat{BDot}imagemask grestore}}{{gsave TR -.1
-.1 TR rulex ruley scale 1 1 false RMat{BDot}imagemask grestore}}ifelse B /QV{
gsave transform round exch round exch itransform moveto rulex 0 rlineto 0
ruley neg rlineto rulex neg 0 rlineto fill grestore}B /a{moveto}B /delta 0 N
/tail{dup /delta X 0 rmoveto}B /M{S p delta add tail}B /b{S p tail}B /c{-4 M}
B /d{-3 M}B /e{-2 M}B /f{-1 M}B /g{0 M}B /h{1 M}B /i{2 M}B /j{3 M}B /k{4 M}B
/w{0 rmoveto}B /l{p -4 w}B /m{p -3 w}B /n{p -2 w}B /o{p -1 w}B /q{p 1 w}B /r{
p 2 w}B /s{p 3 w}B /t{p 4 w}B /x{0 S rmoveto}B /y{3 2 roll p a}B /bos{/SS save
N}B /eos{SS restore}B end
%%EndProcSet
%%BeginProcSet: texps.pro
TeXDict begin /rf{findfont dup length 1 add dict begin{1 index /FID ne 2 index
/UniqueID ne and{def}{pop pop}ifelse}forall[1 index 0 6 -1 roll exec 0 exch 5
-1 roll VResolution Resolution div mul neg 0 0]/Metrics exch def dict begin
Encoding{exch dup type /integertype ne{pop pop 1 sub dup 0 le{pop}{[}ifelse}{
FontMatrix 0 get div Metrics 0 get div def}ifelse}forall Metrics /Metrics
currentdict end def[2 index currentdict end definefont 3 -1 roll makefont
/setfont load]cvx def}def /ObliqueSlant{dup sin S cos div neg}B /SlantFont{4
index mul add}def /ExtendFont{3 -1 roll mul exch}def /ReEncodeFont{/Encoding
exch def}def end
%%EndProcSet
TeXDict begin 40258431 52099146 1000 300 300
(/golem/5/people/jhr/sml/CML/doc/overview/paper.dvi) @start
/Fa 1 44 df<006000006000006000006000006000006000006000006000006000006000FFFFF0
FFFFF000600000600000600000600000600000600000600000600000600000600014167E9119>
43 D E /Fb 1 23 df<01E00F0001E00F0003E01F0003E01E0003C01E0003C01E0007C03E0007
C03C0007803C0007803C000F807C000F8078000F0078000F0078C01F00F8C01F00F1C01F01F180
1F03F1803F87FB803FFE7F003DFC3E003C0000007C0000007C0000007800000078000000F80000
00F8000000F0000000F0000000F0000000E00000001A207F941D>22 D E
/Fc 2 42 df<00E001E003C0038007000F000E001E001C003C00380038007800780070007000F0
00F000F000F000F000F000F000F000F000F000F000F000F000F000700070007800780038003800
3C001C001E000E000F000700038003C001E000E00B2E7CA112>40 D<E000F000780038001C001E
000E000F00070007800380038003C003C001C001C001E001E001E001E001E001E001E001E001E0
01E001E001E001E001E001C001C003C003C003800380078007000F000E001E001C0038007800F0
00E0000B2E7EA112>I E /Fd 1 44 df<00300000300000300000300000300000300000300000
3000003000003000003000FFFFFCFFFFFC00300000300000300000300000300000300000300000
300000300000300000300016187E931B>43 D E /Fe 78[21 2[21 52[18
18 28 18 21 12 16 16 1[21 21 21 30 12 18 1[12 21 21 12 18 21
18 21 21 8[25 35 1[30 23 21 25 1[25 30 28 35 23 2[14 30 30
25 25 30 28 1[25 6[14 21 21 21 21 21 21 21 21 21 21 12 10 14
10 4[14 39[{}60 41.666668 /Times-Italic rf /Ff 6 122 df<0FC01FE078607060E0E0FF
E0FF80E000C000E060E1E07FC03F000B0D7E8C10>101 D<3E3E1E1C1C3C3C383878787070F0F0
ECECFCF87807147F930A>108 D<1F7C3FFE37CF7787670707070F0F0F0E0E0E0E1E1F3C1FF81F
E01C003C003C003800FE00FE001013818C11>112 D<07D81FF83CF83878707070707070F0F0E0
E0E1E073E07FE03FC001C001C003C003800FE01FE00D137F8C0F>I<3EF07FF06FB0EF70CE700E
001E001E001C001C003C003C0038000C0D808C0F>I<1E0E7F0E771EE71CCF1C0E1C0E3C1E381C
381C781EF80FF00FF0007030F071E073C07F803F000F13808C11>121 D
E /Fg 2 105 df<007E0003FF0007C3800F07801E07803C07803C0200780000780000780000F8
0000F00000F00000F00000F000007003007807003C3E003FFC000FE00011147C9315>99
D<01F0000FF0000FF00001E00001E00001E00003E00003C00003C00003C00007C00007800007BF
0007FFC00FE3C00FC1E00F81E00F03E01F03C01E03C01E03C01E07C03E07803C07803C0F803C0F
1C7C0F18781F18781E38780E70F80FE07007C016207E9F17>104 D E /Fh
2 111 df<01C003C003C00380000000000000000000001E003F0077006700E7000F000E001E00
1C001CC03DC039803F801F000A1780960C>105 D<3E3F007FFF806FE3806F8380CF83800F0380
0E03801E07801E07001C07301C0F703C0E703C0FE03807C0140E808D15>110
D E /Fi 4 100 df<01C01C0003E03E0003E03E0003C03C0003C03C0007C07C0007C078000780
7800078078000F80F8000F80F0000F00F0000F00F0001F01F1801F01E3001F03E3001F03E7003F
8FE6003FFEFE003DF87C003C0000007C0000007C0000007800000078000000F8000000F8000000
F0000000F0000000E0000000191E7F931B>22 D<70F8F8F87818181838303070E060050E7C840D
>59 D<0000FF000007FFC0001F83E0003C00F00078007801F0003C03E0003C03C0003E0780001E
0F80001E1F00001E1E00001E3E00001E3E00001E7C00003E7C00003E7C00003E7C00003EF80000
7CF800007CF8000078F80000F8F80000F0780001F0780003E07C0003C07C0007803C000F001E00
1E001F007C000FC1F00003FFC00000FF00001F217F9F23>79 D<00FE0003FF0007C7800F0F801E
0F803C0F803C0F00780000780000780000F80000F00000F00000F00000F00000F00300780F007C
3E003FFC000FE00011147E9314>99 D E /Fj 4 84 df<0F80000FC00001E00001E00000F00000
F000007000007800007800003800003C00003C00001C00001C00001E00001E00003E00007F0000
F70001E70003C7800787800F03801E03C03C03C07C01C0F801E0F001E0E000F0141D7E9C18>21
D<0380700380700380700780F00780F00700E00700E00F01E00F01E00E01C00E01C01E03CE1E03
CE1E078C1E0F8C3F1FD83FFBF83BF1F0380000780000780000700000700000F00000F00000E000
00E00000171B7F9119>I<70F8F8F87005057D840C>58 D<000FE3003FF700F87F01E01E01C00E
03800E03800E07800C07000C07800007800007E00007FE0003FFC003FFE000FFE0001FF00003F0
0000F00000F00000703000707000F07000E07000E07001C0F80380FE0F00EFFE00C3F800181E7E
9C19>83 D E /Fk 55[14 22[21 1[23 23 51[18 21 21 30 21 21 12
16 14 21 21 21 21 32 12 21 12 12 21 21 14 18 21 18 21 18 3[14
1[14 1[30 30 39 30 30 25 23 28 30 23 30 30 37 25 30 16 14 30
30 23 25 30 28 28 30 6[12 21 21 21 21 21 21 21 21 21 21 12
10 14 10 2[14 14 14 32 38[{}76 41.666668 /Times-Roman rf /Fl
134[21 2[21 23 14 16 18 1[23 21 23 35 12 2[12 23 21 1[18 1[18
1[21 12[28 23 30 1[25 32 1[39 6[25 28 30 30 1[30 6[14 21 2[21
21 21 1[21 21 21 12 1[14 3[14 14 40[{}40 41.666668 /Times-Bold
rf /Fm 139[10 15 15 3[19 5[19 19 1[17 101[{}7 37.500000 /Times-Italic
rf /Fn 20 121 df<38787C3C1C1C1C3C78F8F0E0060C799614>39 D<FFFEFFFEFFFE0F037E8C
14>45 D<0300070007000F003F00FF00FF00E70007000700070007000700070007000700070007
0007000700FFF0FFF0FFF00C177C9614>49 D<70F8F8F87000000000000070F8F8F8700510798F
14>58 D<4000F000F8007E003F000F8007E003F000FC007E001E007E00FC03F007E00F803F007E
00F800F00040000F157E9514>62 D<FFFF80FFFF80FFFF801C03801C03801C03801C03801C0000
1C1C001C1C001FFC001FFC001FFC001C1C001C1C001C00001C01C01C01C01C01C01C01C0FFFFC0
FFFFC0FFFFC01217809614>69 D<FE0FE0FE0FE0FE0FE03B1B803B1B803B1B803B1B803BBB803B
BB8039B38039B38039B38039F38038E38038E380380380380380380380380380380380FE0FE0FE
0FE0FE0FE01317809614>77 D<1FF07FFC7FFC701CF01EE00EE00EE00EE00EE00EE00EE00EE00E
E00EE00EE00EE00EE00EF01E783C7FFC7FFC1FF00F177E9614>79 D<0FCC3FFC7FFCF87CF03CE0
1CE01CF000F8007F003FE01FF801FC003C001E000EE00EE00EF01EF83CFFFCFFF8CFE00F177E96
14>83 D<3FC0007FF0007FF800787C00301C0000FC001FFC007FFC007F9C00F01C00E01C00E03C
00F87C007FFF807FFF801F8F8011107E8F14>97 D<07FC1FFE3FFE7C1E780CF000E000E000E000
E000F00E780E7E1E3FFC1FF807F00F107E8F14>99 D<07E01FF83FFC7C3C781EF00EFFFEFFFEFF
FEE000F00E780E7E1E3FFC1FF807E00F107E8F14>101 D<FC0000FC0000FC00001C00001C0000
1C00001C00001CFC001FFE001FFF001F0F001E07001C07001C07001C07001C07001C07001C0700
1C07001C0700FF9FE0FF9FE0FF9FE01317809614>104 D<030007800780030000000000000000
00FF80FF80FF800380038003800380038003800380038003800380FFFCFFFCFFFC0E187D9714>
I<FF80FF80FF800380038003800380038003800380038003800380038003800380038003800380
0380FFFEFFFEFFFE0F177E9614>108 D<FCFC00FFFE00FFFF001F0F001E07001C07001C07001C
07001C07001C07001C07001C07001C0700FF9FE0FF9FE0FF9FE01310808F14>110
D<07C01FF03FF8783C701CF01EE00EE00EE00EE00EF01E701C7C7C3FF81FF007C00F107E8F14>
I<FCFC00FFFE00FFFF001F8F801E03801C03C01C01C01C01C01C01C01C01C01E03C01E07801F8F
801FFF001FFE001CFC001C00001C00001C00001C00001C0000FF8000FF8000FF80001218808F14
>I<0E000E000E000E000E00FFFCFFFCFFFC0E000E000E000E000E000E000E0E0E0E0E0E0F1E07
FC07F803E00F157F9414>116 D<FE7F80FE7F80FE7F800E780007700007E00003E00001C00003
C00003E0000770000E78000E3800FF7F80FF7F80FF7F8011107F8F14>120
D E /Fo 204[12 12 12 49[{}3 25.000000 /Times-Roman rf /Fp 50
122 df<387C7E7E3E0E0E1E1E3C7CF8F0E0070E789B18>39 D<007000F003F007E00FC00F801F
003E003E007C007C0078007800F800F000F000F000F000F000F000F000F000F800780078007C00
7C003E003E001F000F800FC007E003F000F000700C24799F18>I<E000F000FC007E003F001F00
0F8007C007C003E003E001E001E001F000F000F000F000F000F000F000F000F001F001E001E003
E003E007C007C00F801F003F007E00FC00F000E0000C247C9F18>I<01C00001C00001C00001C0
0061C300F9CF80FDDF807FFF003FFE000FF8000FF8003FFE007FFF00FDDF80F9CF8061C30001C0
0001C00001C00001C00011147D9718>I<FFFFE0FFFFE0FFFFE0FFFFE013047E8F18>45
D<78FCFCFCFC780606778518>I<01C003C003C007C00FC03FC0FFC0FFC063C003C003C003C003
C003C003C003C003C003C003C003C003C003C003C003C003C0FFFFFFFFFFFF101C7C9B18>49
D<07F8001FFE003FFF807E1FC0F807C0F803E0F803E0F801E0F801E00001E00003E00003E00007
C00007C0000F80001F80003F00007E0000FC0001F80003E00007C0001F80003F01E07E01E0FFFF
E0FFFFE0FFFFE0131C7E9B18>I<78FCFCFCFC78000000000000000078FCFCFCFC780614779318>
58 D<F00000F80000FE0000FF00003FC0001FE00007F80003FC0000FF00007F80001FE0000FE0
000FE0001FE0007F8000FF0003FC0007F8001FE0003FC000FF0000FE0000F80000F0000013187E
9918>62 D<00FC0003FF0007FF800F87C01F03C03E3FC07C7FE078FFE071F7E0F1E3E0F3C1E0E3
C1E0E380E0E380E0E380E0E380E0E3C1E0F3C1E0F1E3C071F7C078FF807C7F003E3E001F01E00F
83E007FFE003FF8000FE00131C7E9B18>64 D<00F80000F80000F80001FC0001DC0001DC0001DC
0003DE0003DE0003DE0003DE00038E00078F00078F00078F00078F00078F000F07800FFF800FFF
800FFF800F07801E03C01E03C01E03C0FF8FF8FF8FF8FF8FF8151C7F9B18>I<01FCE007FFE00F
FFE01F8FE03F07E03E03E07C03E07C01E07801E0F80000F00000F00000F00000F00000F00000F0
0000F00000F00000F800007801E07C01E07C01E03E03E03F07E01F8FC00FFF8007FF0001FC0013
1C7E9B18>67 D<FFFC00FFFF00FFFF801E07C01E03E01E01E01E01F01E00F01E00F01E00F81E00
781E00781E00781E00781E00781E00781E00781E00781E00781E00F01E00F01E01F01E01E01E03
E01E07C0FFFF80FFFF00FFFC00151C809B18>I<FFFFF0FFFFF0FFFFF01E00F01E00F01E00F01E
00F01E00001E00001E0F001E0F001E0F001FFF001FFF001FFF001E0F001E0F001E0F001E00001E
00001E00781E00781E00781E00781E0078FFFFF8FFFFF8FFFFF8151C7F9B18>I<01F9C007FFC0
0FFFC01F1FC03E0FC03E07C07C03C07803C07803C0F80000F00000F00000F00000F00000F00000
F03FF0F03FF0F03FF0F803C07803C07807C07C07C03E07C03E0FC01F1FC00FFFC007FFC001FBC0
141C7E9B18>71 D<FFDFF8FFDFF8FFDFF81E03C01E03C01E03C01E03C01E03C01E03C01E03C01E
03C01E03C01FFFC01FFFC01FFFC01E03C01E03C01E03C01E03C01E03C01E03C01E03C01E03C01E
03C01E03C0FFDFF8FFDFF8FFDFF8151C7F9B18>I<FFFFC0FFFFC0FFFFC001E00001E00001E000
01E00001E00001E00001E00001E00001E00001E00001E00001E00001E00001E00001E00001E000
01E00001E00001E00001E00001E00001E000FFFFC0FFFFC0FFFFC0121C7D9B18>I<FFE000FFE0
00FFE0001E00001E00001E00001E00001E00001E00001E00001E00001E00001E00001E00001E00
001E00001E00001E00001E00001E00001E00F01E00F01E00F01E00F01E00F0FFFFF0FFFFF0FFFF
F0141C7F9B18>76 D<FC01F8FE03F8FE03F83F07E03B06E03B06E03B06E03B8EE03B8EE0398CE0
398CE039DCE039DCE039DCE038D8E038F8E038F8E03870E03870E03800E03800E03800E03800E0
3800E03800E0FE03F8FE03F8FE03F8151C7F9B18>I<FE0FF8FF0FF8FF0FF81F81C01D81C01D81
C01DC1C01CC1C01CC1C01CE1C01CE1C01CE1C01C61C01C71C01C71C01C31C01C39C01C39C01C39
C01C19C01C19C01C1DC01C0DC01C0DC01C0FC0FF87C0FF87C0FF83C0151C7F9B18>I<0FFE003F
FF807FFFC07C07C07803C0F803E0F001E0F001E0F001E0F001E0F001E0F001E0F001E0F001E0F0
01E0F001E0F001E0F001E0F001E0F001E0F001E0F001E0F803E07803C07C07C07FFFC03FFF800F
FE00131C7E9B18>I<0FFE003FFF807FFFC07C07C07803C0F803E0F001E0F001E0F001E0F001E0
F001E0F001E0F001E0F001E0F001E0F001E0F001E0F001E0F001E0F001E0F0F1E0F0F1E0F87BE0
787BC07C3FC07FFFC03FFF800FFF00000F00000F800007800007C00007C00003C013227E9B18>
81 D<FFF800FFFE00FFFF001E1F801E07801E07C01E03C01E03C01E03C01E07C01E07801E1F80
1FFF001FFE001FFF001E1F001E0F801E07801E07801E07801E07801E07801E07BC1E07BC1E07FC
FFC7FCFFC3F8FFC0F0161C7F9B18>I<07F9C01FFFC03FFFC07C1FC0F807C0F807C0F003C0F003
C0F80000F80000FE00007FC0003FFC001FFF0007FF80007FC00007C00003E00003E00001E0F001
E0F001E0F003E0F807C0FE0FC0FFFF80FFFF00E7FC00131C7E9B18>I<FFFFF8FFFFF8FFFFF8F0
7878F07878F07878F0787800780000780000780000780000780000780000780000780000780000
780000780000780000780000780000780000780000780000780007FF8007FF8007FF80151C7F9B
18>I<FFC7FEFFC7FEFFC7FE1E00F01E00F01E00F01E00F01E00F01E00F01E00F01E00F01E00F0
1E00F01E00F01E00F01E00F01E00F01E00F01E00F01E00F01E00F01F01F01F01F00F83E00FC7E0
07FFC001FF00007C00171C809B18>I<FFFFE0FFFFE0FFFFE0FFFFE013047E7F18>95
D<1FF0007FFC007FFF007C1F007C0F80380F8000078000FF800FFF803FFF807F8780FC0780F807
80F00780F00780F80F80FC1F807FFFF83FFFF807F1F815147E9318>97 D<FF0000FF0000FF0000
0F00000F00000F00000F00000F00000F3F000FFFC00FFFE00FE3F00FC0F80F80F80F007C0F007C
0F003C0F003C0F003C0F003C0F007C0F807C0F80F80FC1F80FE3F00FFFE00FFFC00F3E00161C80
9B18>I<01FE000FFF801FFF803F0F807E0F807C0700F80000F80000F00000F00000F00000F000
00F80000F800007C03C07E07C03F0FC01FFF800FFF0001FC0012147D9318>I<003FC0003FC000
3FC00003C00003C00003C00003C00003C001FBC00FFFC01FFFC03F1FC07E0FC07C07C0F803C0F8
03C0F003C0F003C0F003C0F003C0F803C0F807C07C07C07C0FC03F1FC01FFFFC0FFFFC03F3FC16
1C7F9B18>I<01F80007FE001FFF803F0FC07E07C07C03C0F803E0F801E0F001E0FFFFE0FFFFE0
FFFFE0F80000F800007C01E07E03E03F87E01FFFC007FF8001FE0013147E9318>I<001F80007F
E000FFE001FBE001F3E001E1C001E00001E000FFFFC0FFFFC0FFFFC001E00001E00001E00001E0
0001E00001E00001E00001E00001E00001E00001E00001E00001E00001E0007FFF807FFF807FFF
80131C7F9B18>I<03F1F00FFFF81FFFF83E1FF87C0FF07C0F807807807807807807807C0F807C
0F803E1F003FFE003FFC003BF0003800003C00003FFF003FFFC07FFFF07801F0F00078F00078E0
0038E00038F00078F800F87E03F03FFFE00FFF8003FE00151F7F9318>I<FF0000FF0000FF0000
0F00000F00000F00000F00000F00000F3F000FFFC00FFFC00FE3E00FC1E00F81E00F81E00F01E0
0F01E00F01E00F01E00F01E00F01E00F01E00F01E00F01E00F01E0FFF3FEFFF3FEFFF3FE171C80
9B18>I<01C00003E00003E00003E00001C000000000000000000000000000FFE000FFE000FFE0
0001E00001E00001E00001E00001E00001E00001E00001E00001E00001E00001E00001E00001E0
0001E000FFFF80FFFF80FFFF80111D7D9C18>I<FFE000FFE000FFE00001E00001E00001E00001
E00001E00001E00001E00001E00001E00001E00001E00001E00001E00001E00001E00001E00001
E00001E00001E00001E00001E00001E000FFFFC0FFFFC0FFFFC0121C7D9B18>108
D<FBE3E0FFF7F0FFFFF83F7F783E3E383C3C383C3C383838383838383838383838383838383838
38383838383838383838383838FE7E7EFE7E7EFE7E7E1714809318>I<FF3F00FFFFC0FFFFC00F
E3E00FC1E00F81E00F81E00F01E00F01E00F01E00F01E00F01E00F01E00F01E00F01E00F01E00F
01E0FFF3FEFFF3FEFFF3FE1714809318>I<01F0000FFE001FFF003E0F803C07807803C07803C0
F001E0F001E0F001E0F001E0F001E0F001E07803C07803C03C07803F1F801FFF000FFE0001F000
13147E9318>I<FF3F00FFFFC0FFFFE00FE3F00FC0F80F80F80F007C0F007C0F003C0F003C0F00
3C0F003C0F007C0F807C0F80F80FC1F80FE3F00FFFE00FFFC00F3E000F00000F00000F00000F00
000F00000F00000F0000FFF000FFF000FFF000161E809318>I<01F9E007FFE01FFFE03F0FE07E
07E07C03E0F803E0F801E0F001E0F001E0F001E0F001E0F801E0F803E07C03E07E07E03F0FE01F
FFE00FFFE003F9E00001E00001E00001E00001E00001E00001E00001E0001FFE001FFE001FFE17
1E7F9318>I<FF87E0FF9FF8FFFFF807FC7807F07807E00007E00007C00007C000078000078000
078000078000078000078000078000078000FFFF00FFFF00FFFF0015147F9318>I<0FFF003FFF
007FFF00F81F00F00F00E00F00F00000FF00007FF8003FFE000FFF00003F80F00780F00380F803
80F80780FE0F80FFFF00FFFE00E7F80011147D9318>I<078000078000078000078000078000FF
FFC0FFFFC0FFFFC00780000780000780000780000780000780000780000780000780000780C007
81E00781E007C3E007C7E003FFC001FF80007E0013197F9818>I<FF1FE0FF1FE0FF1FE00F01E0
0F01E00F01E00F01E00F01E00F01E00F01E00F01E00F01E00F01E00F01E00F03E00F03E00F87E0
0FFFFE07FFFE01FDFE1714809318>I<FF8FF8FF8FF8FF8FF81C01C00E03800E03800E03800707
00070700070700078F00038E00038E0003DE0001DC0001DC0001DC0000F80000F8000070001514
7F9318>I<FF8FF8FF8FF8FF8FF83800E03800E03800E03800E01C01C01C71C01CF9C01CF9C01C
F9C01DDDC00DDD800DDD800DDD800F8F800F8F800F8F8007070015147F9318>I<FF8FF8FF8FF8
FF8FF80E01C00E03800E0380070380070700070700038700038700038E0001CE0001CE0001CC00
00DC0000FC0000780000780000780000700000700000700000F0007CE0007DE00073C0007F8000
3F00001E0000151E7F9318>121 D E /Fq 62[15 18[23 51[18 20 2[20
23 13 18 18 23 23 23 23 33 13 20 13 13 23 23 13 20 23 20 23
23 51[15 45[{}27 45.833332 /Times-Italic rf /Fr 4 107 df<70F8F8F87005057C8D0D>
1 D<03F0000FFC001FFE003FFF007FFF807FFF80FFFFC0FFFFC0FFFFC0FFFFC0FFFFC0FFFFC07F
FF807FFF803FFF001FFE000FFC0003F00012127E9317>15 D<07E000041FF800043FFC00047C3E
000C700F000CE007801CC003C038C001F0F88000FFF080007FE080001F801E0B7E9023>24
D<C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0
C0C0C0C0C0C0C0022D7BA10D>106 D E /Fs 69[17 15[17 48[19 19 27
19 19 10 15 12 1[19 19 19 29 10 19 10 10 19 19 12 17 19 17
19 17 12[23 21 25 2[27 27 7[21 2[25 9[19 19 1[19 19 19 19 19
19 2[9 12 9 2[12 12 12 39[{}47 37.500000 /Times-Roman rf /Ft
1 4 df<0C000E00CCC0FFC0FFC03F00FFC0FFC0CCC00E000C000A0B7D8B10>3
D E /Fu 133[22 25 25 36 25 28 17 19 22 1[28 25 28 41 14 28
1[14 28 25 17 22 28 22 28 25 12[33 28 3[39 1[47 33 2[19 1[39
30 33 36 36 1[36 11[25 25 25 25 25 1[14 12 17 45[{}44 50.000000
/Times-Bold rf /Fv 1 44 df<00C00000C00000C00000C00000C00000C00000C00000C00000
C000FFFF80FFFF8000C00000C00000C00000C00000C00000C00000C00000C00000C00011147E8F
17>43 D E /Fw 134[17 3[17 2[11 1[17 17 3[17 1[9 17 17 1[15
1[15 1[15 3[11 1[11 6[20 18 22 1[18 1[24 30 20 1[13 1[24 24
2[24 22 22 24 7[17 17 17 17 17 17 17 17 17 17 3[8 44[{}39 33.333332
/Times-Roman rf /Fx 133[20 23 23 33 23 25 15 18 20 1[25 23
25 38 13 2[13 25 23 15 20 25 20 25 23 8[33 2[33 30 25 33 1[28
36 33 43 30 1[23 18 2[28 30 1[33 1[33 17[13 11 15 45[{}42 45.833332
/Times-Bold rf /Fy 69[20 10[25 25 3[20 47[20 23 23 33 23 23
13 18 15 23 23 23 23 36 13 23 13 13 23 23 15 20 23 20 23 20
3[15 1[15 3[43 33 33 28 25 30 1[25 33 33 41 28 33 18 15 33
33 25 28 33 30 30 33 1[20 3[13 13 23 23 23 23 23 23 23 23 23
23 13 11 15 11 2[15 15 15 36 38 37[{}76 45.833332 /Times-Roman
rf /Fz 78[29 55[29 29 42 29 32 19 23 26 1[32 29 32 48 16 32
1[16 1[29 19 26 32 26 32 29 13[32 42 1[36 2[55 39 2[23 5[42
39 42 9[29 29 29 29 29 29 29 49[{}39 58.333336 /Times-Bold
rf /FA 70 126 df<01C00001C00001C00001C00007F8001FFC003FFF007DDF00F1C780E1C780
E1C780E1C780F1C30079C0007FC0001FF8000FFC0001FE0001DF0001C780F1C380F1C380F1C380
E1C780F1C7807DDF003FFE001FFC0007F00001C00001C00001C00011207E9C16>36
D<387C7E7E3E0E0E0E1E3C3CF8F060070E799816>39 D<00E001E007C007800F001E003C003800
7800700070007000F000E000E000E000E000E000E000E000F000700070007000780038003C001E
000F00078007C001E000E00B217A9C16>I<E000F0007C003C001E000F000780038003C001C001
C001C001E000E000E000E000E000E000E000E001E001C001C001C003C0038007800F001E003C00
7C00F000E0000B217C9C16>I<0380038003800380E38EFBBEFFFE3FF80FE00FE03FF8FFFEFBBE
E38E03800380038003800F127D9516>I<00E00000E00000E00000E00000E00000E00000E00000
E000FFFFE0FFFFE0FFFFE000E00000E00000E00000E00000E00000E00000E00000E00013137F95
16>I<78FCFEFEFE7E1E1E3CF8F0E0070C788516>I<FFFF80FFFF80FFFF8011037E8D16>I<78FC
FCFCFC780606788516>I<03E0000FF8001FFC001E3C00380E00780F00700700700700E00380E0
0380E00380E00380E00380E00380E00380E00380F00780700700700700780F003C1E001E3C001F
FC000FF80003E00011197E9816>48 D<070007000F001F003F00FF00FF00F70007000700070007
000700070007000700070007000700070007000700FFF8FFF8FFF80D197B9816>I<0FF0001FFC
007FFE00783F00F00F00F00780F00380F00380000380000380000780000700000F00001E00003C
0000780000F00003E00007C0000F00001E03803C0380FFFF80FFFF80FFFF8011197E9816>I<0F
F0003FFC007FFE00781F00780F00780700300700000F00000F00003E0007FC0007F80007FC0000
1E00000F00000780000380600380F00380F00780F00F00F81F007FFE003FFC000FF00011197E98
16>I<007C0000FC0000FC0001DC00039C00039C00071C000F1C000E1C001E1C003C1C00381C00
781C00F01C00FFFFE0FFFFE0FFFFE0001C00001C00001C00001C00001C0001FFC001FFC001FFC0
13197F9816>I<7FFE007FFE007FFE0070000070000070000070000070000070000070000077F0
007FFC007FFE007C1F00700700000780000380600380F00380F00780F00F00F83F007FFE003FFC
000FF00011197E9816>I<01FC0007FE000FFF001F8F003E0F003C0F00780600700000F04000E7
F800FFFE00FFFE00F80F00F00780F00780E00380F00380F00380700380780780780F003E1F001F
FE000FFC0007F00011197E9816>I<78FCFCFCFC7800000000000078FCFCFCFC780612789116>
58 D<78FCFCFCFC7800000000000078F8FCFCFC7C1C3C78F8F0E00618789116>I<7FFFC0FFFFE0
FFFFE0000000000000000000000000000000FFFFE0FFFFE07FFFC0130B7F9116>61
D<E00000F80000FC00003F00001F800007E00003F00000FC00007E00001F80000F80001F80007E
0000FC0003F00007E0001F80003F0000FC0000F80000E0000011157E9616>I<01F80007FE000F
FF001F0F803E7F803CFF8079FFC073C7C0F383C0E783C0E701C0E701C0E701C0E701C0E701C0E7
83C0F3838073C78079FF003CFE003E7C001F03C00FFFC007FF8001FC0012197E9816>64
D<00E00001F00001F00001B00001B00003B80003B80003B800031800071C00071C00071C00071C
00071C000E0E000E0E000FFE000FFE001FFF001C07001C07001C0700FF1FE0FF1FE0FF1FE01319
7F9816>I<FFF800FFFE00FFFF001C07001C07801C03801C03801C03801C03801C07001FFF001F
FE001FFE001C1F001C03801C03C01C01C01C01C01C01C01C01C01C03C01C0780FFFF80FFFF00FF
FC0012197F9816>I<03F18007FF800FFF801F0F803C0780780780780380700380F00000E00000
E00000E00000E00000E00000E00000E00000F000007003807803807803803C07801F0F000FFE00
07FC0003F00011197E9816>I<FFF800FFFE00FFFF001C0F001C07801C03C01C01C01C01C01C01
E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C01C01C01C01C03C01C07801C0F
80FFFF00FFFE00FFF8001319809816>I<FFFFC0FFFFC0FFFFC01C01C01C01C01C01C01C01C01C
00001C00001C1C001C1C001FFC001FFC001FFC001C1C001C1C001C00001C00E01C00E01C00E01C
00E01C00E0FFFFE0FFFFE0FFFFE013197F9816>I<FFFFE0FFFFE0FFFFE01C00E01C00E01C00E0
1C00E01C00001C00001C1C001C1C001FFC001FFC001FFC001C1C001C1C001C00001C00001C0000
1C00001C00001C0000FFC000FFC000FFC00013197F9816>I<03F18007FF800FFF801F0F803C07
80780780780380700380F00000E00000E00000E00000E00000E01FE0E01FE0E01FE0F003807003
807807807807803C0F801F1F800FFF8007FB8003F38013197F9816>I<FF8FF8FF8FF8FF8FF81C
01C01C01C01C01C01C01C01C01C01C01C01C01C01FFFC01FFFC01FFFC01C01C01C01C01C01C01C
01C01C01C01C01C01C01C01C01C01C01C0FF8FF8FF8FF8FF8FF81519809816>I<FFFEFFFEFFFE
0380038003800380038003800380038003800380038003800380038003800380038003800380FF
FEFFFEFFFE0F197D9816>I<FFC000FFC000FFC0001C00001C00001C00001C00001C00001C0000
1C00001C00001C00001C00001C00001C00001C00001C00001C00401C00E01C00E01C00E01C00E0
FFFFE0FFFFE0FFFFE013197F9816>76 D<FC07E0FE0FE0FE0FE03A0B803B1B803B1B803B1B803B
1B803BBB803BBB8039B38039B38039B38039B38039F38038E38038E38038038038038038038038
0380380380FE0FE0FE0FE0FE0FE013197F9816>I<FE0FF8FF0FF8FF0FF81D81C01D81C01D81C0
1DC1C01CC1C01CE1C01CE1C01C61C01C71C01C71C01C71C01C31C01C39C01C39C01C19C01C1DC0
1C0DC01C0DC01C0DC0FF87C0FF87C0FF83C01519809816>I<1FFC003FFE007FFF00780F00F007
80E00380E00380E00380E00380E00380E00380E00380E00380E00380E00380E00380E00380E003
80E00380F00780F00780780F007FFF003FFE001FFC0011197E9816>I<FFF800FFFE00FFFF001C
0F801C03801C03C01C01C01C01C01C01C01C03C01C03801C0F801FFF001FFE001FF8001C00001C
00001C00001C00001C00001C00001C0000FF8000FF8000FF800012197F9816>I<1FFC003FFE00
7FFF00780F00F00780E00380E00380E00380E00380E00380E00380E00380E00380E00380E00380
E00380E00380E00380E0E380E1E380F0F780787F007FFF003FFE001FFC00001C00001E00000E00
000F00000700000700111F7E9816>I<FFF000FFFC00FFFE001C0F001C07801C03801C03801C03
801C03801C07801C0F001FFE001FFC001FFE001C1F001C0F001C07001C07001C07001C07381C07
381C07F8FF87F8FF83F0FF81E01519809816>I<0FF3001FFF007FFF00781F00F00F00E00700E0
0700E00000F000007800007F80003FF8000FFC0000FE00000F00000780000380000380E00380E0
0380F00780F81F00FFFE00FFFC00CFF80011197E9816>I<FFFFE0FFFFE0FFFFE0E0E0E0E0E0E0
E0E0E0E0E0E000E00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E000
00E00000E00000E00000E0000FFE000FFE000FFE0013197F9816>I<FF8FF8FF8FF8FF8FF81C01
C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01C01
C01C01C01E03C01E03C00F07800F8F8007FF0003FE0000F8001519809816>I<FFF0FFF0FFF0E0
00E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000
E000E000E000E000E000E000FFF0FFF0FFF00C20789C16>91 D<FFF0FFF0FFF000700070007000
700070007000700070007000700070007000700070007000700070007000700070007000700070
007000700070FFF0FFF0FFF00C207F9C16>93 D<FFFF80FFFF80FFFF8011037E7E16>95
D<1FE0007FF8007FFC00783E00301E00000E00007E000FFE003FFE007FCE00F80E00E00E00E00E
00F01E00F83E007FFFE03FFFE01FC3E013127E9116>97 D<FC0000FC0000FC00001C00001C0000
1C00001C00001CFC001FFF001FFF801F8FC01E03C01E01E01C01E01C00E01C00E01C00E01C00E0
1E01E01E01C01F03C01F8F801FFF801FFE001CFC0013197F9816>I<03FC0FFE1FFE3E1E780C70
00F000E000E000E000E000F00070077C073E1F1FFE0FFC03F010127D9116>I<003F00003F0000
3F0000070000070000070000070007E7001FFF003FFF003E3F00780F00700F00F00700E00700E0
0700E00700E00700F00F00F00F00781F007E3F003FFFE01FF7E007E7E013197F9816>I<03F000
0FFC003FFE003E1F00780F80F80780F00380FFFF80FFFF80FFFF80E00000F00000F803807C0780
3E0F801FFF000FFE0003F80011127E9116>I<003F0000FF8001FF8003E7800383000380000380
00FFFF00FFFF00FFFF000380000380000380000380000380000380000380000380000380000380
00038000038000FFFE00FFFE00FFFE0011197F9816>I<03E7C00FFFE01FFFE01E3CE03C1E0038
0E00380E00380E003C1E001E3C001FFC003FF8003BE0003800003C00003FFE003FFF807FFFC078
07C0F001E0E000E0E000E0E000E0F001E07E0FC03FFF801FFF0007FC00131C7F9116>I<FC0000
FC0000FC00001C00001C00001C00001C00001CFC001FFE001FFF001F8F001E07001E07001C0700
1C07001C07001C07001C07001C07001C07001C07001C0700FF9FE0FF9FE0FF9FE013197F9816>
I<07000F800F800F800700000000000000FF80FF80FF8003800380038003800380038003800380
0380038003800380FFFEFFFEFFFE0F1A7C9916>I<007000F800F800F800700000000000001FF8
1FF81FF80038003800380038003800380038003800380038003800380038003800380038003800
380078F078F0F0FFF0FFE03F800D237E9916>I<FFC000FFC000FFC00001C00001C00001C00001
C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001C00001
C00001C00001C000FFFF80FFFF80FFFF8011197E9816>108 D<FBC780FFEFC0FFFFE03E7CE03C
78E03870E03870E03870E03870E03870E03870E03870E03870E03870E03870E0FE7CF8FE7CF8FE
7CF81512809116>I<FCFC00FFFE00FFFF001F8F001E07001E07001C07001C07001C07001C0700
1C07001C07001C07001C07001C0700FF9FE0FF9FE0FF9FE013127F9116>I<03E0000FF8001FFC
003C1E00780F00700700E00380E00380E00380E00380E00380F00780700700780F003C1E001FFC
000FF80003E00011127E9116>I<FCFC00FFFF00FFFF801F8FC01E03C01E01E01C01E01C00E01C
00E01C00E01C00E01E01E01E01C01F03C01F8F801FFF801FFE001CFC001C00001C00001C00001C
00001C00001C0000FF8000FF8000FF8000131B7F9116>I<07F3800FFB801FFF803E1F80780F80
700780F00780E00380E00380E00380E00380F00780700780780F803E1F803FFF801FFB8007E380
000380000380000380000380000380000380003FF8003FF8003FF8151B7F9116>I<FF1FC0FF7F
E0FFFFE007F9E007E0C007C0000780000780000700000700000700000700000700000700000700
00FFFC00FFFC00FFFC0013127F9116>I<1FEC3FFC7FFCF03CE01CE01CF8007FC03FF007FC003E
E00EE00EF00EF83EFFFCFFF8CFF00F127D9116>I<070000070000070000070000070000FFFF00
FFFF00FFFF00070000070000070000070000070000070000070000070100070380070380070780
078F8003FF0003FE0000F80011177F9616>I<FC3F00FC3F00FC3F001C07001C07001C07001C07
001C07001C07001C07001C07001C07001C07001C0F001E1F001FFFE00FFFE007F7E013127F9116
>I<FF9FE0FF9FE0FF9FE01C07001C07000E0E000E0E000E0E00071C00071C00071C00071C0003
B80003B80003B80001F00001F00000E00013127F9116>I<FF1FE0FF1FE0FF1FE0380380380380
38038038038039F38039F38019F30019B30019B30019B3001DB7001D17001F1F000F1E000E0E00
13127F9116>I<7F3FC07F3FC07F3FC00F1E00073C0003B80003F00001F00000E00001E00001F0
0003B800073C00071C000E0E00FF3FE0FF3FE0FF3FE013127F9116>I<FF9FE0FF9FE0FF9FE01C
07000E07000E0E000E0E00070E00071C00071C00039C00039C0003980001B80001B80000F00000
F00000F00000E00000E00000E00001C00079C0007BC0007F80007F00003C0000131B7F9116>I<
003F8000FF8001FF8001E00001C00001C00001C00001C00001C00001C00001C00001C00001C000
03C000FF8000FF0000FF0000FF800003C00001C00001C00001C00001C00001C00001C00001C000
01C00001C00001E00001FF8000FF80003F8011207E9C16>123 D<E0E0E0E0E0E0E0E0E0E0E0E0
E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E0E00320779C16>I<FE0000FF8000FFC00003C000
01C00001C00001C00001C00001C00001C00001C00001C00001C00001E00000FF80007F80007F80
00FF8001E00001C00001C00001C00001C00001C00001C00001C00001C00001C00003C000FFC000
FF8000FE000011207E9C16>I E /FB 134[25 2[25 25 14 19 17 1[25
25 25 1[14 2[14 25 2[22 2[25 22 11[36 2[33 7[19 1[36 1[28 2[33
9[25 3[25 1[25 1[25 2[12 1[12 44[{}27 50.000000 /Times-Roman
rf /FC 1 4 df<00C00000E00000C00000C00000C000E0C1C0F8C7C07CCF801FFE0007F80001E0
0007F8001FFE007CCF80F8C7C0E0C1C000C00000C00000C00000E00000C00012157D9619>3
D E /FD 138[35 20 1[23 2[35 35 4[20 35 35 1[31 35 31 1[31 19[63
43 3[51 4[47 1[51 6[20 12[23 45[{}19 70.833336 /Times-Roman
rf /FE 137[23 25 13 23 15 1[25 25 25 38 10 2[10 25 25 13 25
25 23 1[25 13[30 2[30 1[33 1[25 1[23 13 1[36 2[33 33 1[30 7[25
7[25 4[13 4[10 39[{}32 45.833332 /Helvetica rf end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 300dpi
TeXDict begin

%%EndSetup
%%Page: 1 1
1 0 bop 75 40 a FE(A)15 b(re)o(vised)h(v)o(ersion)f(of)g(a)g(paper)h
(presented)h(at)e(the)g(SIGPLAN'91)h(Conf)o(erence)g(on)g(Programming)75
96 y(Language)g(Design)e(and)f(Implementation,)i(J)o(une)f(1991)347
310 y FD(CML:)j(A)g(Higher)o(-order)k(Concurrent)f(Language)1601
284 y FC(\003)827 457 y FB(John)12 b(H.)h(Reppy)790 515 y(Cornell)f(Uni)o(v)o
(ersity)779 573 y FA(jhr@cs.cornell.ed)o(u)792 696 y FB(February)f(15,)i
(1993)75 982 y Fz(1)58 b(Intr)o(oduction)75 1118 y Fy(Concurrent)10
b(ML)g(\()p Fx(CML)p Fy(\))h(is)e(a)h(high-le)o(v)o(el,)g(high-performance)g
(language)g(for)g(concurrent)g(programming.)15 b(It)75 1185
y(is)c(an)g(e)o(xtension)g(of)h(Standard)f(ML)g(\()p Fx(SML)p
Fy(\))788 1171 y Fw([MTH90)q(])919 1185 y Fy(,)h(and)f(is)g(implemented)f(on)
h(top)f(of)i(Standard)g(ML)e(of)i(Ne)o(w)75 1253 y(Jerse)o(y)i(\()p
Fx(SML/NJ)p Fy(\))399 1239 y Fw([AM87])509 1253 y Fy(.)24 b
Fx(CML)14 b Fy(is)g(a)g(practical)g(language)f(and)h(is)f(being)h(used)f(to)g
(b)o(uild)g(real)h(systems.)23 b(It)75 1321 y(demonstrates)10
b(that)h(we)h(need)g(not)e(sacri\256ce)j(high-le)o(v)o(el)e(notation)f(in)h
(order)g(to)g(ha)o(v)o(e)h(good)f(performance.)146 1409 y(Although)i(most)g
(research)i(in)f(the)h(area)g(of)g(concurrent)f(language)h(design)e(has)i
(been)f(moti)o(v)o(ated)f(by)h(the)75 1477 y(desire)k(to)f(impro)o(v)o(e)h
(performance)g(by)g(e)o(xploiting)e(multiprocessors,)i(we)g(belie)o(v)o(e)g
(that)g(concurrenc)o(y)g(is)g(a)75 1545 y(useful)c(programming)f(paradigm)h
(for)h(certain)g(application)e(domains.)25 b(F)o(or)15 b(e)o(xample,)h
(interacti)o(v)o(e)e(systems)75 1613 y(often)i(ha)o(v)o(e)g(a)g(naturally)f
(concurrent)h(structure)870 1598 y Fw([CP85)o(,)9 b(RG86)o(,)g(Pik89)o(,)g
(Haa90)o(])1259 1613 y Fy(.)29 b(Another)16 b(e)o(xample)f(is)h(distrib)o
(uted)75 1680 y(systems:)e(most)c(systems)f(for)i(distrib)o(uted)e
(programming)g(pro)o(vide)i(multi-threading)d(at)j(the)f(node)h(le)o(v)o(el)f
(\(e.g.,)75 1748 y Fx(Isis)142 1734 y Fw([BCJ)210 1722 y Fv(+)235
1734 y Fw(90)o(])293 1748 y Fy(and)j Fx(Argus)491 1734 y Fw([LCJS87])620
1748 y Fy(\).)24 b(Sequential)13 b(programs)g(in)h(these)f(application)g
(domains)f(often)i(must)e(use)75 1816 y(comple)o(x)i(and)h(arti\256cial)f
(control)g(structures)g(to)h(schedule)f(and)g(interlea)o(v)o(e)h(acti)o
(vities)f(\(e.g.,)j(e)o(v)o(ent-loops)c(in)75 1884 y(graphics)h(libraries\).)
25 b(The)o(y)15 b(are,)h(in)e(ef)o(fect,)i(simulating)c(concurrenc)o(y)m(.)26
b(These)15 b(application)e(domains)g(need)75 1951 y(a)19 b(high-le)o(v)o(el)f
(concurrent)h(language)g(that)f(pro)o(vides)g(both)g(ef)o(\256cient)h
(sequential)f(e)o(x)o(ecution)h(and)g(ef)o(\256cient)75 2019
y(concurrent)12 b(e)o(x)o(ecution:)k Fx(CML)c Fy(satis\256es)f(this)f(need.)
75 2165 y Fu(1.1)50 b(An)12 b(overview)f(of)h(CML)75 2284 y
Fx(CML)d Fy(is)g(based)f(on)h(the)f(sequential)g(language)h
Fx(SML)p Fy(raisecitesml-de\256nition)f(and)h(inherits)f(the)g(good)g
(features)75 2352 y(of)13 b Fx(SML)p Fy(:)h(functions)e(as)h(\256rst-class)g
(v)o(alues,)h(strong)e(static)h(typing,)f(polymorphism,)g(datatypes)g(and)h
(pattern)75 2420 y(matching,)f(le)o(xical)g(scoping,)g(e)o(xception)g
(handling)g(and)g(a)g(state-of-the-art)h(module)e(facility)m(.)19
b(A)12 b(brief)h(intro-)75 2487 y(duction)e(to)g Fx(SML)h Fy(is)g(gi)o(v)o
(en)f(as)h(an)f(appendix;)g(also)g(see)h([P)o(au91)q(])g(or)g([Har86].)18
b(The)11 b(sequential)g(performance)p 75 2528 720 2 v 124 2555
a Ft(\003)142 2571 y Fs(This)d(work)g(was)f(supported,)g(in)h(part,)h(by)e
(the)h(NSF)g(and)f(ONR)h(under)g(NSF)g(grant)g(CCR-85-14862,)f(and)g(by)h
(the)f(NSF)h(under)f(NSF)75 2616 y(grant)i(CCR-89-18233.)p
eop
%%Page: 2 2
2 1 bop 75 82 a Fy(of)14 b Fx(CML)h Fy(bene\256ts)f(from)g(the)g(quality)f
(of)h(the)g Fx(SML/NJ)g Fy(compiler)m(.)25 b(In)14 b(addition)f
Fx(CML)i Fy(has)f(the)g(follo)o(wing)75 150 y(properties:)143
264 y Fr(\017)23 b Fx(CML)9 b Fy(pro)o(vides)g(a)h(high-le)o(v)o(el)e(model)h
(of)g(concurrenc)o(y)h(with)e(dynamic)h(creation)g(of)g(threads)g(and)h
(typed)189 321 y(channels,)h(and)h Fq(r)n(endezvous)f Fy(communication.)16
b(This)11 b(distrib)o(uted-memory)e(model)i(\256ts)g(well)g(with)g(the)189
377 y(mostly)e(applicati)o(v)o(e)i(style)g(of)g Fx(SML)p Fy(.)143
471 y Fr(\017)23 b Fx(CML)15 b Fy(is)f(a)g(higher)o(-order)h(concurrent)g
(language.)26 b(Just)13 b(as)i Fx(SML)g Fy(supports)e(functions)g(as)i
(\256rst-class)189 528 y(v)o(alues,)j Fx(CML)g Fy(supports)e(synchronous)g
(operations)h(as)g(\256rst-class)g(v)o(alues.)34 b(These)17
b(v)o(alues,)i(called)189 584 y Fq(e)o(vents)p Fy(,)f(pro)o(vide)e(the)g
(tools)f(for)i(b)o(uilding)d(ne)o(w)i(synchronization)f(abstractions.)31
b(F)o(or)17 b(e)o(xample,)h(we)189 641 y(ha)o(v)o(e)e(found)g(uses)g(for)g
(widely)f(v)o(arying)h(abstractions,)h(such)e(as)h(remote)g(procedure)h
(call,)h(multicast)189 697 y(channels)10 b(and)g(b)o(uf)o(fered)h(channels.)
16 b(This)10 b(\257e)o(xibility)f(is)h(important,)g(as)g(it)g(allo)o(ws)f
(the)h(synchronization)189 753 y(and)18 b(communication)f(abstractions)h(to)g
(be)h(tailored)f(to)g(the)h(application.)37 b Fx(CML)p Fy(')m(s)20
b(e)o(v)o(ents)e(are)i(an)189 810 y(e)o(xtension)10 b(of)i(the)f(mechanism)f
(described)i(in)f([Rep88].)143 904 y Fr(\017)23 b Fx(CML)13
b Fy(pro)o(vides)g(inte)o(grated)g(I/O)g(support.)21 b(Potentially)12
b(blocking)g(I/O)h(operations,)g(such)g(as)g(reading)189 960
y(from)j(an)h(input)e(stream,)k(are)e(full-\257edged)g(synchronous)e
(operations.)32 b(Lo)o(w-le)o(v)o(el)17 b(support)e(is)h(also)189
1017 y(pro)o(vided,)11 b(from)g(which)g(distrib)o(uted)f(communication)g
(abstractions)g(can)i(be)g(constructed.)143 1110 y Fr(\017)23
b Fx(CML)11 b Fy(pro)o(vides)g(automatic)f(reclamation)h(of)g(threads)g(and)h
(channels,)f(once)g(the)o(y)h(become)f(in)f(accessi-)189 1167
y(ble.)23 b(This)13 b(permits)f(a)i(technique)f(of)h(speculati)o(v)o(e)f
(communication,)g(which)g(is)g(not)g(possible)f(in)h(other)189
1223 y(threads)e(packages.)143 1317 y Fr(\017)23 b Fx(CML)13
b Fy(uses)e(pre-empti)o(v)o(e)i(scheduling.)18 b(T)l(o)13 b(guarantee)f
(interacti)o(v)o(e)h(responsi)o(v)o(eness,)f(a)g(single)g(thread)189
1374 y(cannot)i(be)h(allo)o(wed)g(to)f(monopolize)f(the)i(processor)m(.)28
b(Pre-emption)14 b(insures)h(that)f(a)h(conte)o(xt)g(switch)189
1430 y(will)i(occur)h(at)g(re)o(gular)g(interv)o(als,)h(which)e(allo)o(ws)g
(\252of)o(f-the-shelf)s(\272)h(code)g(to)g(be)g(incorporated)f(in)h(a)189
1487 y(concurrent)11 b(thread)h(without)e(destroying)g(interacti)o(v)o(e)h
(responsi)o(v)o(eness.)143 1580 y Fr(\017)23 b Fx(CML)c Fy(is)e(ef)o
(\256cient.)39 b(Thread)18 b(creation,)j(thread)d(switching)f(and)i(message)f
(passing)f(are)i(v)o(ery)g(ef)o(\256-)189 1637 y(cient)e(\(benchmarks)g(are)h
(gi)o(v)o(en)f(in)f(section)h(5\).)34 b(Experience)18 b(with)e
Fx(CML)i Fy(has)f(sho)o(wn)g(that)f(it)h(is)g(a)189 1693 y(viable)d(language)
g(for)h(implementing)d(usable)j(interacti)o(v)o(e)f(systems;)g(this)g(is)g
(in)g(direct)h(contrast)f(with)189 1750 y(Haahr')m(s)f(e)o(xperience)h(with)e
(concurrenc)o(y)i(in)e Fx(scheme)1074 1735 y Fw([Haa90])1184
1750 y Fy(.)21 b(In)13 b(fact,)h(message)e(passing)g(in)g Fx(CML)i
Fy(is)189 1806 y(signi\256cantly)c(faster)h(than)g(in)g(Sun')m(s)h
(light-weight)e(process)h(library)m(.)143 1900 y Fr(\017)23
b Fx(CML)15 b Fy(is)f(portable.)26 b(It)15 b(is)f(written)g(in)g
Fx(SML)h Fy(and)g(runs)f(on)h(essentially)e(e)o(v)o(ery)i(system)f(supported)
f(by)189 1956 y Fx(SML/NJ)e Fy(\(four)h(dif)o(ferent)g(architectures)f(and)h
(man)o(y)f(dif)o(ferent)g(operating)g(systems\).)75 2102 y
Fu(1.2)50 b(Organization)10 b(of)i(this)g(paper)75 2221 y Fy(The)c(rest)g(of)
g(the)g(paper)g(has)g(four)g(parts:)j(section)d(2)g(describes)g(and)g(moti)n
(v)o(ates)g(t)o(he)g(desig)o(n)g(of)f Fx(CML)h Fy(\(a)g(complete)75
2289 y(description)g(can)i(be)g(found)f(in)g([Rep90b]\);)h(section)f(3)g
(describes)h(the)f(use)g(of)h Fx(CML)g Fy(in)f(two)f(application)h(areas;)75
2357 y(sections)j(4)h(and)g(5)f(describe)h(the)g(implementation)e(and)i(its)f
(performance;)i(and,)f(lastly)m(,)g(section)f(6)h(compares)75
2425 y Fx(CML)f Fy(with)f(related)g(work.)16 b(A)c(brief)f(introduction)f(to)
h Fx(SML)h Fy(is)f(included)g(as)g(an)h(appendix.)964 2802
y(2)p eop
%%Page: 3 3
3 2 bop 75 82 a Fz(2)58 b(Basic)14 b(concurr)o(ency)g(primiti)o(v)o(es)75
218 y Fy(A)g Fx(CML)g Fy(program)g(consists)e(of)i(a)g(number)f(of)h
Fq(thr)n(eads)p Fy(,)g(which)g(use)f(message)h(passing)f(on)g(typed)g
(channels)75 286 y(to)k(communicate)g(and)h(synchronize.)37
b(The)18 b(signature)f(of)h(the)g(basic)f(thread)h(and)g(channel)g
(operations)g(is)75 353 y(gi)o(v)o(en)13 b(in)g(\256gure)h(1.)22
b(The)13 b(function)g Fp(spawn)f Fy(dynamically)g(creates)i(a)g(ne)o(w)f
(thread)h(to)e(e)o(v)o(aluate)i(its)e(ar)o(gument.)146 492
y FA(\(*)21 b(create)f(a)i(new)f(thread)g(*\))146 542 y(val)g(spawn)f(:)i
(\(unit)f(->)g(unit\))g(->)g(thread_id)146 641 y(\(*)g(create)f(a)i(new)f
(channel)g(*\))146 691 y(val)g(channel)f(:)i(unit)f(->)g('1a)g(chan)146
791 y(\(*)g(message)f(passing)h(operations)e(*\))146 841 y(val)i(accept)42
b(:)22 b('a)f(chan)g(->)g('a)146 890 y(val)g(send)86 b(:)22
b(\('a)f(chan)g(*)g('a\))h(->)f(unit)617 1065 y Fy(Figure)12
b(1:)k(Basic)c(concurrenc)o(y)g(primiti)o(v)o(es)75 1182 y(Channels)i(are)h
(also)f(created)h(dynamically)m(,)f(using)f(the)h(function)f
Fp(channel)1329 1166 y Fw(1)1347 1182 y Fy(.)25 b(The)14 b(functions)f
Fp(accept)g Fy(and)75 1250 y Fp(send)g Fy(are)g(the)g(synchronous)f
(communication)g(operations.)21 b(When)13 b(a)h(thread)f(wants)f(to)h
(communicate)f(on)h(a)75 1318 y(channel,)f(it)f(must)g Fq(r)n(endezvous)g
Fy(with)g(another)h(thread)g(that)f(wants)g(to)g(do)g(a)h(complementary)f
(communication)75 1385 y(on)17 b(the)h(same)g(channel.)36 b(Most)16
b Fx(CSP)p Fy(-style)i(languages)f(\(e.g.,)k Fx(occam)1266
1371 y Fw([Bur88])1389 1385 y Fy(and)d Fx(amber)1599 1371 y
Fw([Car86])1703 1385 y Fy(\))g(pro)o(vide)75 1453 y(similar)g(rendezv)o
(ous-style)h(communication.)38 b(In)19 b(addition,)i(the)o(y)e(pro)o(vide)g
(a)g(mechanism)f(for)i Fq(selective)75 1521 y(communication)p
Fy(,)10 b(which)h(is)g(necessary)h(for)g(threads)f(to)g(communicate)g(with)f
(multiple)g(partners.)146 1609 y(It)g(is)g(possible)f(to)h(use)h(polling)e
(to)h(implement)f(selecti)o(v)o(e)h(communication,)g(b)o(ut)g(to)g(do)g(so)g
(is)g(a)o(wkward)h(and)75 1677 y(requires)i(b)o(usy)e(waiting.)19
b(Usually)11 b(selecti)o(v)o(e)i(communication)d(is)i(pro)o(vided)g(as)h
(multiple)o(x)o(ed)e(I/O)h(operation.)75 1745 y(This)h(can)h(be)g(a)g
(multiple)o(x)o(ed)f(input)g(operation,)h(such)f(as)h Fx(occam)p
Fy(')m(s)h Fp(ALT)e Fy(construct)1446 1730 y Fw([Bur88)o(])1551
1745 y Fy(;)i(or)e(a)i(generalized)75 1813 y(\(or)h(symmetric\))f(select)g
(operation)g(that)h(multiple)o(x)o(es)e(both)h(input)f(and)i(output)f
(communications,)g(such)g(as)75 1880 y Fx(Pascal-m)p Fy(')m(s)e
Fp(select)f Fy(construct)620 1866 y Fw([AB86)o(])721 1880 y
Fy(.)22 b(Implementing)11 b(generalized)j(select)f(on)f(a)i(multi-processor)d
(can)j(be)75 1948 y(dif)o(\256cult)219 1934 y Fw([Bor86)o(])324
1948 y Fy(,)9 b(b)o(ut,)g(as)g(will)e(be)i(sho)o(wn)f(in)g(section)g(2.2,)h
(there)g(are)g(situations)e(in)h(which)g(generalized)h(selecti)o(v)o(e)75
2016 y(communication)h(is)g(necessary)m(.)146 2104 y(There)16
b(is)f(a)g(fundamental)g(con\257ict)h(between)f(the)h(desire)f(for)h
(abstraction)f(and)g(the)h(need)f(for)h(selecti)o(v)o(e)75
2172 y(communication.)j(F)o(or)14 b(e)o(xample,)f(consider)g(a)g(serv)o(er)g
(thread)g(that)f(pro)o(vides)h(a)g(service)g(via)f(a)h Fq(r)n(equest-r)n
(eply)p Fy(,)75 2240 y(or)c Fq(r)n(emote)h(pr)n(ocedur)n(e)f(call)g
Fy(\(RPC\))i(style,)f(protocol.)15 b(The)10 b(serv)o(er)g(side)f(of)g(this)g
(protocol)f(would)g(be)i(something)75 2308 y(like:)p 75 2339
720 2 v 128 2366 a Fo(1)142 2382 y Fs(The)g(\252)p Fn(1)p Fs(\272)f(in)h(the)
g(type)g(v)o(ariable)g(of)g Fn(channel)p Fs(')n(s)e(result)i(type)g(is)g(the)
g Fm(str)o(ength)e Fs(of)j(the)f(v)o(ariable.)16 b(This)9 b(is)i(a)f
(technical)f(mechanism)75 2428 y(used)f(to)h(allo)o(w)h(polymorphic)e(use)g
(of)i(updatable)d(objects)h(without)i(creating)e(type)h(loopholes.)964
2802 y Fy(3)p eop
%%Page: 4 4
4 3 bop 146 82 a FA(fun)21 b(serverLoop)e(\(\))j(=)f(if)h(serviceAvailable)o
(\(\))276 132 y(then)f(let)g(val)h(request)e(=)i(accept)e(reqCh)h(in)363
182 y(send)g(\(replyCh,)f(doit)h(request\);)363 232 y(serverLoop)f(\(\))320
281 y(end)276 331 y(else)h(doSomethingElse\(\))75 457 y Fy(where)13
b(the)g(function)f Fp(doit)g Fy(actually)h(implements)e(the)h(service.)22
b(This)12 b(protocol)g(requires)h(that)f(clients)g(obe)o(y)75
525 y(the)f(follo)o(wing)f(two)h(rules:)132 639 y(1.)23 b(A)11
b(client)g(must)f(send)h(a)h(request)f(before)h(trying)f(to)g(read)h(a)f
(reply)m(.)132 733 y(2.)23 b(F)o(ollo)o(wing)10 b(a)i(request)f(the)g(client)
g(must)f(read)i(e)o(xactly)g(one)f(reply)g(before)i(issuing)c(another)j
(request.)75 859 y(If)e(all)g(clients)f(follo)o(w)g(these)h(rules,)g(then)g
(we)g(can)g(guarantee)h(that)e(each)i(request)f(is)f(answered)h(with)g(the)f
(correct)75 927 y(reply)m(.)24 b(A)14 b(ob)o(vious)f(way)g(to)g(impro)o(v)o
(e)h(the)g(reliability)e(of)i(programs)f(that)h(use)f(this)g(service)h(is)g
(to)f(b)o(undle)g(the)75 995 y(client-side)f(protocol)f(into)h(a)h(function)e
(that)h(hides)g(the)h(details,)f(thus)g(ensuring)g(that)g(the)g(rules)g(are)h
(follo)o(wed.)75 1062 y(The)e(follo)o(wing)f(code)i(implements)d(this)i
(abstraction:)146 1170 y FA(fun)21 b(clientCall)e(x)j(=)g(\(send\(reqCh,)d
(x\);)i(accept)g(replyCh\))75 1296 y Fy(While)14 b(this)f(insures)g(that)h
(the)g(protocol)f(is)h(observ)o(ed,)h(it)e(hides)h(too)f(much.)25
b(If)14 b(a)g(client)g(blocks)f(on)h(a)g(call)g(to)75 1364
y Fp(clientCall)e Fy(\(e.g.,)j(if)e(the)f(serv)o(er)i(is)f(not)f(a)o(v)o
(ailable\),)i(then)f(it)f(cannot)h(respond)f(to)h(other)g(communications.)75
1432 y(The)k(client)g(would)f(like)h(to)g(use)g(selecti)o(v)o(e)g
(communication)f(in)h(this)f(situation,)h(b)o(ut)g(cannot,)i(because)f(the)75
1499 y(synchronous)12 b(aspect)h(of)h(the)f(protocol)f(has)h(been)h(hidden)e
(by)h(the)g(function)g(abstraction.)21 b(The)13 b(ne)o(xt)h(section)75
1567 y(describes)d(our)h(solution)d(to)i(this)g(dilemma.)75
1713 y Fu(2.1)50 b(First-class)13 b(synchr)o(onous)f(operations)75
1832 y Fy(F)o(ollo)o(wing)g([Rep88])i(and)e([Rep89)q(],)i(we)f(make)f
(synchronous)g(operations)g(into)g(\256rst-class)h(v)o(alues)g(by)g(intro-)75
1900 y(ducing)h(a)i(ne)o(w)f(kind)f(of)h(v)o(alue,)h(called)f(an)h
Fq(e)o(vent)p Fy(,)h(which)d(represents)h(a)h(potential)e(synchronous)g
(operation)75 1968 y(\(analogous)c(to)g(the)g(way)g(a)g(function)g(v)o(alue)g
(describes)g(a)h(potential)e(computation\).)15 b(These)c(v)o(alues)f(pro)o
(vide)g(an)75 2035 y(abstraction)i(of)g(a)h(protocol)e(implementation,)g
(without)g(obscuring)g(the)i(synchronous)e(aspect)h(of)h(a)f(protocol.)75
2103 y(Figure)h(2)g(gi)o(v)o(es)f(the)h(signature)f(of)h(the)f(basic)h(e)o(v)
o(ent)g(operations)f(from)h(the)f([Rep88)q(])h(model.)20 b
Fx(CML)13 b Fy(e)o(xtends)75 2171 y(this)c(model)g(in)h(se)o(v)o(eral)g
(signi\256cant)f(ways,)h(which)g(are)h(discussed)e(in)g(section)g(2.4.)17
b(The)10 b(operator)g Fp(sync)f Fy(forces)75 2239 y(synchronization)14
b(on)h(an)g(e)o(v)o(ent)g(v)o(alue.)28 b(The)15 b(functions)f
Fp(receive)g Fy(and)i Fp(transmit)e Fy(are)i(used)e(to)h(b)o(uild)f(the)75
2306 y(base)c(e)o(v)o(ent)g(v)o(alues)f(that)g(describe)h(channel)g
(communication.)15 b(The)10 b(e)o(v)o(ent)f(v)o(alues)h(returned)g(by)f
Fp(receive)g Fy(and)75 2374 y Fp(transmit)i Fy(are)i(called)f
Fq(base)g(e)o(vent)h Fy(v)o(alues.)18 b(W)l(e)13 b(can)f(de\256ne)h
Fp(accept)e Fy(and)h Fp(send)g Fy(using)f(these)h(and)g(function)75
2442 y(composition:)146 2550 y FA(val)21 b(accept)f(=)i(sync)f(o)g(receive)
146 2600 y(val)g(send)64 b(=)22 b(sync)f(o)g(transmit)964 2802
y Fy(4)p eop
%%Page: 5 5
5 4 bop 146 140 a FA(val)21 b(sync)64 b(:)22 b('a)f(event)g(->)g('a)146
240 y(val)g(receive)64 b(:)21 b('a)h(chan)f(->)g('a)g(event)146
290 y(val)g(transmit)42 b(:)21 b(\('a)g(chan)g(*)h('a\))f(->)h(unit)e(event)
146 389 y(val)h(choose)f(:)i('a)f(event)g(list)g(->)g('a)h(event)146
439 y(val)f(wrap)64 b(:)22 b(\('a)f(event)g(*)g(\('a)h(->)f('b\)\))g(->)g('b)
h(event)678 613 y Fy(Figure)12 b(2:)k(Basic)11 b(e)o(v)o(ent)h(operations)75
735 y(The)20 b(functions)e Fp(choose)h Fy(and)h Fp(wrap)f Fy(are)i
(combinators)d(for)i(constructing)f(ne)o(w)h(e)o(v)o(ent)f(v)o(alues:)33
b Fp(choose)75 803 y Fy(pro)o(vides)18 b(a)h(generalized)g(selecti)o(v)o(e)g
(communication)d(mechanism)i(and)h Fp(wrap)f Fy(combines)f(an)i(e)o(v)o(ent)g
(with)75 871 y(a)e(post-synchronization)f(action,)i(called)f(the)g(wrapper)m
(.)35 b(F)o(or)18 b(e)o(xample,)h(if)e(we)g(ha)o(v)o(e)h(two)e(inte)o(ger)h
(v)o(alued)75 938 y(channels,)11 b Fp(ch1)f Fy(and)g Fp(ch2)p
Fy(,)h(then)f(the)g(follo)o(wing)f(e)o(xpression)h(will)f(block)h(until)f(a)i
(message)f(is)g(a)o(v)o(ailable)g(on)g(one)75 1006 y(of)h(the)h(channels:)146
1098 y FA(sync)21 b(\(choose)f([)233 1148 y(wrap)h(\(receive)f(ch1,)h(fn)g(x)
h(=>)f(\(2)h(*)f(x\)\),)233 1198 y(wrap)g(\(receive)f(ch2,)h(fn)g(x)h(=>)f
(\(x)h(+)f(1\)\))189 1247 y(]\))75 1357 y Fy(When)11 b(a)g(message)f(becomes)
g(a)o(v)o(ailable,)h(then)f(we)h(say)g(the)f Fp(receive)g Fy(e)o(v)o(ent)g
(is)g Fq(enabled)p Fy(.)17 b(If)11 b(both)e(base)i(e)o(v)o(ents)75
1425 y(are)16 b(enabled)e(at)h(the)g(same)f(time,)i(then)e(one)h(will)f(be)h
(chosen)f(non-deterministically)m(.)25 b(When)15 b(a)g(base)g(e)o(v)o(ent)75
1493 y(v)o(alue)9 b(is)f(synchronized)g(on,)i(it)e(produces)g(a)h(result,)h
(which)e(to)g(which)h(its)f(wrappers)h(are)h(applied.)15 b(F)o(or)10
b(e)o(xample,)75 1560 y(if)15 b(the)g(abo)o(v)o(e)h(e)o(xpression)e
(synchronizes)h(on)g(\252)p Fp(receive)10 b(ch1)p Fy(,)m(\272)17
b(then)d(the)h(result)g(will)f(be)h(multiplied)e(by)i Fp(2)p
Fy(.)75 1628 y Fx(CML)10 b Fy(supports)e(generalized)i(\(or)g(symmetric\))f
(selecti)o(v)o(e)g(communication;)f(a)i(choice)f(e)o(v)o(ent)h(v)o(alue)f
(may)g(ha)o(v)o(e)75 1696 y(both)h(input)f(and)h(output)f(operations)h(in)g
(it.)16 b(A)10 b(formal)g(operational)g(semantics)g(of)g Fx(CML)h
Fy(has)g(been)f(de)o(v)o(eloped)75 1764 y(and)h(will)g(be)g(included)g(in)g
(the)g(author')m(s)h(forthcoming)e(Ph.D.)i(thesis)1188 1749
y Fw([Rep92)n(])1296 1764 y Fy(.)146 1852 y(T)l(o)h(understand)f(this)g(the)h
(higher)o(-order)g(nature)h(of)f(this)f(mechanism,)h(it)f(is)h(helpful)f(to)h
(dra)o(w)g(an)g(analogy)75 1920 y(with)e(\256rst-class)g(function)g(v)o
(alues.)16 b(T)l(able)c(1)f(compares)g(these)h(two)e(higher)o(-order)i
(mechanisms.)p 495 1975 950 2 v 494 2025 2 50 v 503 2025 V
529 2010 a Fl(Pr)o(operty)p 832 2025 V 171 w(Function)f(values)p
1161 2025 V 49 w(Event)f(values)p 1435 2025 V 1444 2025 V 495
2026 950 2 v 494 2076 2 50 v 503 2076 V 529 2061 a Fk(T)m(ype)g(constructor)p
832 2076 V 48 w FA(->)p 1161 2076 V 286 w(event)p 1435 2076
V 1444 2076 V 495 2078 950 2 v 494 2128 2 50 v 503 2128 V 529
2113 a Fk(Introduction)p 832 2128 V 120 w Fj(\025)p Fk(-abstraction)p
1161 2128 V 109 w FA(receive)p 1435 2128 V 1444 2128 V 494
2177 V 503 2177 V 832 2177 V 1161 2177 V 1187 2162 a(transmit)p
1435 2177 V 1444 2177 V 494 2227 V 503 2227 V 832 2227 V 1161
2227 V 1187 2212 a Fk(etc.)p 1435 2227 V 1444 2227 V 495 2229
950 2 v 494 2279 2 50 v 503 2279 V 529 2264 a(Elimination)p
832 2279 V 130 w(application)p 1161 2279 V 144 w FA(sync)p
1435 2279 V 1444 2279 V 495 2280 950 2 v 494 2330 2 50 v 503
2330 V 529 2315 a Fk(Combinators)p 832 2330 V 112 w(composition)p
1161 2330 V 123 w FA(choose)p 1435 2330 V 1444 2330 V 494 2380
V 503 2380 V 832 2380 V 857 2365 a(map)p 1161 2380 V 264 w(wrap)p
1435 2380 V 1444 2380 V 494 2430 V 503 2430 V 832 2430 V 857
2415 a Fk(etc.)p 1161 2430 V 272 w(etc.)p 1435 2430 V 1444
2430 V 495 2431 950 2 v 530 2478 a Fy(T)l(able)i(1:)k(Relating)11
b(\256rst-class)g(functions)g(and)g(e)o(v)o(ents)146 2610 y(The)16
b(great)g(bene\256t)h(of)f(this)f(approach)i(to)e(concurrenc)o(y)i(is)f(that)
g(it)f(allo)o(ws)g(the)h(programmer)g(to)g(create)75 2677 y(ne)o(w)f
(\256rst-class)g(synchronization)f(and)h(communication)e(abstractions.)27
b(F)o(or)16 b(e)o(xample,)g(we)g(can)f(de\256ne)h(an)964 2802
y(5)p eop
%%Page: 6 6
6 5 bop 75 82 a Fy(e)o(v)o(ent-v)o(alued)16 b(function)f(that)h(implements)e
(the)h(client-side)h(of)g(the)f(RPC)j(protocol)d(gi)o(v)o(en)h(in)f(the)h
(pre)o(vious)75 150 y(section:)146 257 y FA(fun)21 b(clientCallEvt)e(x)i(=)h
(wrap)f(\()276 307 y(transmit\(reqCh,)e(x\),)276 356 y(fn)j(\(\))f(=>)g
(accept)g(replyCh\))75 481 y Fy(Application)13 b(of)h(the)g(function)g
Fp(transmit)f Fy(produces)h(an)g(e)o(v)o(ent)g(v)o(alue)h(that)e(represents)i
(the)f(sending)f(of)h(the)75 549 y(request.)19 b(If)13 b(the)f(serv)o(er)h
(accepts)g(the)f(request,)h(then)f(we)g(need)h(to)f(wait)f(for)i(a)f(reply)m
(.)20 b(T)l(o)12 b(do)g(this)f(we)i(wrap)f(the)75 617 y(request)i(e)o(v)o
(ent)g(with)f(a)h(function)f(that)h(will)f(accept)h(the)g(reply)m(.)25
b(In)13 b(the)h(follo)o(wing)f(section,)h(we)g(gi)o(v)o(e)g(a)g(more)75
684 y(substantial)c(e)o(xample.)75 830 y Fu(2.2)50 b(An)12
b(example)75 949 y Fy(An)17 b(e)o(xample)g(that)g(illustrates)f(a)h(number)g
(of)g(ke)o(y)g(points)f(is)h(an)g(implementation)e(of)j(a)f
Fq(b)o(uf)o(fer)n(ed)g(c)o(hannel)75 1017 y Fy(abstraction.)38
b(Buf)o(fered)20 b(channels)e(pro)o(vide)g(a)h(mechanism)f(for)h
(asynchronous)e(communication,)i(which)75 1085 y(is)d(similar)g(to)g(the)h
(actor)g(mailbox)650 1070 y Fw([Agh86)m(])761 1085 y Fy(.)33
b(The)17 b(source)g(code)g(for)g(this)e(abstraction)i(is)f(gi)o(v)o(en)g(in)g
(\256gure)i(3.)75 1152 y(The)d(function)e Fp(buffer)h Fy(creates)h(a)g(ne)o
(w)f(b)o(uf)o(fered)h(channel,)h(which)e(consists)f(of)i(a)g(b)o(uf)o(fer)g
(thread,)h(an)e(input)146 1290 y FA(abstype)20 b('a)h(buffer_chan)f(=)h(BC)h
(of)f({)233 1340 y(inch)g(:)g('a)h(chan,)233 1390 y(outch)e(:)i('a)f(chan)189
1440 y(})146 1489 y(with)189 1539 y(fun)g(buffer)g(\(\))g(=)h(let)320
1589 y(val)f(inCh)g(=)h(channel\(\))e(and)h(outCh)f(=)i(channel\(\))320
1639 y(fun)f(loop)g(\([],)g([]\))g(=)h(loop\([accept)d(inCh],)i([]\))363
1689 y(|)h(loop)f(\(front)g(as)g(\(x::r\),)f(rear\))h(=)h(sync)f(\()451
1738 y(choose)f([)538 1788 y(wrap)h(\(receive)f(inCh,)581 1838
y(fn)i(y)f(=>)h(loop\(front,)d(y::rear\)\),)538 1888 y(wrap)i
(\(transmit\(outCh,)d(x\),)581 1938 y(fn)k(\(\))f(=>)h(loop\(r,)e(rear\)\))
494 1988 y(]\))363 2037 y(|)i(loop)f(\([],)g(rear\))g(=)g(loop\(rev)f(rear,)h
([]\))320 2087 y(in)363 2137 y(spawn)g(\(fn)g(\(\))h(=>)f(loop\([],)f
([]\)\);)363 2187 y(BC{inch=inCh,)g(outch=outCh})320 2237 y(end)189
2286 y(fun)h(bufferSend)f(\(BC{inch,)g(...},)h(x\))g(=)h(send\(inch,)d(x\))
189 2336 y(fun)i(bufferReceive)e(\(BC{outch,)h(...}\))h(=)g(receive)g(outch)
146 2386 y(end)g(\(*)g(abstype)f(*\))718 2560 y Fy(Figure)11
b(3:)16 b(Buf)o(fered)d(channels)75 2677 y(channel)g(and)g(an)g(output)f
(channel;)i(the)e(function)h Fp(bufferSend)e Fy(is)i(an)g(asynchronous)f
(send)h(operation;)g(and)964 2802 y(6)p eop
%%Page: 7 7
7 6 bop 75 82 a Fy(the)13 b(function)g Fp(bufferReceive)e Fy(is)i(an)g(e)o(v)
o(ent-v)o(alued)g(recei)o(v)o(e)i(operation.)22 b(The)13 b(b)o(uf)o(fer)h(is)
f(represented)g(as)h(a)75 150 y(queue)9 b(of)h(messages,)f(which)g(is)g
(implemented)e(as)j(a)f(pair)h(of)f(stacks)g(\(lists\);)f(the)h(Appendix)g
(gi)o(v)o(es)g(more)g(details)75 218 y(on)i(this)f(applicati)o(v)o(e)h
(implementation)f(of)h(queues.)17 b(This)10 b(e)o(xample)i(illustrates)e(se)o
(v)o(eral)i(ke)o(y)f(points:)143 332 y Fr(\017)23 b Fy(Buf)o(fered)15
b(channels)e(are)i(a)f(ne)o(w)f(communication)f(abstraction,)i(which)g(ha)o
(v)o(e)g(\256rst-class)g(citizenship.)189 389 y(A)g(thread)h(can)f(use)h(the)
f Fp(bufferReceive)f Fy(function)g(in)h(an)o(y)h(conte)o(xt)f(that)g(it)g
(could)g(use)g(the)g(b)o(uilt-in)189 445 y(function)c Fp(receive)p
Fy(,)h(such)g(as)h(selecti)o(v)o(e)f(communication.)143 539
y Fr(\017)23 b Fy(The)13 b(b)o(uf)o(fer)h(loop)f(uses)g(both)g(input)f(and)h
(output)g(operations)f(in)h(its)g(selecti)o(v)o(e)h(communication.)21
b(This)189 595 y(is)14 b(an)i(e)o(xample)f(of)g(the)g(necessity)g(of)g
(generalized)h(selecti)o(v)o(e)f(communication.)26 b(If)16
b(we)f(ha)o(v)o(e)h(only)f(a)189 652 y(multiple)o(x)o(ed)9
b(input)g(construct)h(\(e.g.,)i Fx(occam)p Fy(')m(s)f Fp(ALT)p
Fy(\),)g(then)f(we)g(must)f(to)h(use)g(a)h(request/reply)f(protocol)189
708 y(to)g(implement)g(the)g(serv)o(er)i(side)f(of)g(the)g
Fp(bufferReceive)e Fy(operation)h(\(see)i(pp.)f(37-41)g(of)g([Bur88],)h(for)
189 765 y(e)o(xample\).)17 b(But)10 b(if)h(a)h(request/reply)e(protocol)g(is)
g(used,)h(then)g(the)g Fp(bufferReceive)e Fy(operation)h(cannot)189
821 y(be)h(used)g(in)g(a)h(selecti)o(v)o(e)f(communication)f(by)h(the)g
(client.)143 915 y Fr(\017)23 b Fy(The)12 b(b)o(uf)o(fer)g(thread)g(is)f(a)i
(good)e(e)o(xample)h(of)g(a)g(common)f Fx(CML)h Fy(programming)f(idiom:)k
(using)c(threads)189 972 y(to)g(encapsulate)i(state.)18 b(This)12
b(style)f(has)h(the)g(additional)f(bene\256t)h(of)h(hiding)d(the)i(state)g
(of)g(the)g(system)f(in)189 1028 y(the)j(concurrenc)o(y)h(operations,)g
(which)f(makes)g(the)h(sequential)e(code)i(cleaner)m(.)27 b(These)15
b(threads)f(serv)o(e)189 1084 y(the)d(same)g(role)h(that)e
Fq(monitors)g Fy(do)h(in)g(some)g(shared-memory)g(concurrent)g(languages.)143
1178 y Fr(\017)23 b Fy(Once)17 b(created,)i(the)e(b)o(uf)o(fer)g(thread)g(ne)
o(v)o(er)g(terminates,)h(which)e(may)g(seem)h(to)f(pose)h(a)g(problem)f(for)
189 1235 y(resource)h(reco)o(v)o(ery)m(.)34 b(If)18 b(a)f(b)o(uf)o(fered)g
(channel)g(e)o(v)o(er)g(becomes)g(unreachable)g(from)g(all)f(non-blocked)189
1291 y(threads,)21 b(then)e(the)g(b)o(uf)o(fer)g(thread)h(and)f(channels)g
(will)f(be)h(reclaimed)g(by)g(the)g(garbage)g(collector)m(.)189
1348 y(Because)14 b(the)g(channels)f(and)g(suspended)g(thread)h(state)f(are)h
(normal)f Fx(SML/NJ)h Fy(heap)g(objects,)f(we)h(get)189 1404
y(thread)c(reclamation)h(for)g(free.)17 b(In)11 b(general,)g(threads)g(that)f
(communicate)g(in\256nitely)f(will)h(block)g(and)h(be)189 1461
y(garbage)h(collected)g(if)g(the)o(y)g(become)g(disconnected)f(from)h(the)f
(acti)o(v)o(e)i(part)f(of)g(the)f(system.)18 b(There)12 b(are)189
1517 y(certain)f(pathological)f Fq(live-loc)o(k)i Fy(situations,)e(in)g
(which)h(this)f(fails,)h(b)o(ut)g(these)g(do)g(not)g(arise)g(in)g(practice.)
75 1643 y(A)g(more)h(complete)e(v)o(ersion)i(of)f(this)f(abstraction)h(is)g
(included)g(in)g(the)g Fx(CML)h Fy(distrib)o(ution.)75 1788
y Fu(2.3)50 b(Other)12 b(synchr)o(onous)g(operations)75 1908
y Fy(One)h(of)g(the)g(nice)f(aspects)h(of)g(e)o(v)o(ents)g(is)f(that)h(other)
f(primiti)o(v)o(e)g(synchronous)f(operations)i(are)g(easily)g(accom-)75
1976 y(modated)g(in)h(the)f(frame)o(work.)25 b(There)14 b(are)h(three)f(e)o
(xamples)g(of)g(this)f(in)g Fx(CML)p Fy(:)i(synchronization)d(on)i(thread)75
2043 y(termination)c(\(sometimes)g(called)h Fq(pr)n(ocess)g(join)p
Fy(\),)g(lo)o(w-le)o(v)o(el)g(I/O)h(support)e(and)h(time-outs.)16
b(The)11 b(function)146 2151 y FA(val)21 b(wait)g(:)g(thread_id)f(->)i(unit)f
(event)75 2277 y Fy(produces)15 b(an)g(e)o(v)o(ent)g(for)g(synchronizing)f
(on)g(the)h(termination)e(of)i(another)g(thread.)28 b(This)14
b(is)g(often)h(used)f(by)75 2345 y(serv)o(ers)19 b(that)f(need)h(to)f
(release)h(resources)g(allocated)f(to)g(client)g(threads.)38
b(Support)18 b(for)h(lo)o(w-le)o(v)o(el)f(I/O)h(is)75 2413
y(pro)o(vided)11 b(by)g(the)g(functions:)146 2521 y FA(val)21
b(syncOnInput)41 b(:)22 b(int)f(->)g(unit)g(event)146 2570
y(val)g(syncOnOutput)e(:)j(int)f(->)g(unit)g(event)146 2620
y(val)g(syncOnExcept)e(:)j(int)f(->)g(unit)g(event)964 2802
y Fy(7)p eop
%%Page: 8 8
8 7 bop 75 82 a Fy(which)12 b(allo)o(w)g(threads)g(to)g(synchronize)g(on)g
(the)g(status)f(of)h(\256le)h(descriptions.)18 b(These)13 b(operations)e(are)
i(used)f(in)75 150 y Fx(CML)g Fy(to)e(implement)f(a)j(multi-threaded)e(I/O)g
(stream)h(library)m(.)17 b(There)11 b(are)h(two)e(functions)g(for)h
(synchronizing)75 218 y(with)g(the)g(clock:)146 326 y FA(val)21
b(waitUntil)f(:)h(time)g(->)h(unit)f(event)146 375 y(val)g(timeout)f(:)i
(time)f(->)g(unit)g(event)75 501 y Fy(The)14 b(function)g Fp(waitUntil)f
Fy(returns)h(an)g(e)o(v)o(ent)h(that)e(synchronizes)h(on)g(an)g(absolute)g
(time,)g(while)g Fp(timeout)75 569 y Fy(returns)d(an)h(e)o(v)o(ent)f(that)g
(synchronizes)g(on)g(a)h(time)e(that)h(is)g(relati)o(v)o(e)h(to)f(the)g
(application)f(of)i Fp(sync)p Fy(.)146 658 y Fx(CML)g Fy(also)e(pro)o(vides)h
(a)h(polling)e(mechanism)146 765 y FA(val)21 b(poll)g(:)g('a)h(event)e(->)i
('a)f(option)75 891 y Fy(where)12 b(the)f Fx(SML)i Fy(type)e(constructor)f
Fp(option)h Fy(is)146 999 y FA(datatype)20 b('a)h(option)g(=)g(NONE)g(|)h
(SOME)f(of)g('a)75 1125 y Fy(which)11 b(is)h(a)g(non-blocking)e(v)o(ersion)i
(of)g Fp(sync)p Fy(.)17 b(Applying)11 b Fp(poll)g Fy(to)g(an)h(e)o(v)o(ent)g
(v)o(alue)g(will)f(return)h Fp(NONE)f Fy(in)g(the)75 1193 y(case)h(that)f
Fp(sync)g Fy(would)f(block.)75 1339 y Fu(2.4)50 b(Extending)11
b(the)h(mechanism)75 1458 y Fy(The)d(concurrenc)o(y)h(mechanism)e(described)h
(thus)f(far)h(is)f(essentially)g(that)g(presented)h(in)g([Rep88])g(and)g
([Rep89].)75 1526 y Fx(CML)j Fy(e)o(xtends)g(this)e(model)h(in)h(se)o(v)o
(eral)g(important)e(ways,)i(in)f(this)f(section)i(we)f(moti)o(v)o(ate)g(and)g
(describe)h(these)75 1593 y(e)o(xtensions.)146 1682 y(Consider)i(a)g
(protocol)f(consisting)f(of)i(a)h(sequence)f(of)g(client-serv)o(er)h
(communications:)k Fi(c)1642 1689 y Fw(1)1661 1682 y Fy(;)8
b Fi(c)1702 1689 y Fw(2)1719 1682 y Fy(;)g Fr(\001)g(\001)g(\001)d
Fy(;)j Fi(c)1841 1689 y Fh(n)1864 1682 y Fy(.)75 1750 y(When)i(this)e
(protocol)h(is)h(packaged)g(up)f(in)g(an)h(e)o(v)o(ent)g(v)o(alue,)g(one)g
(of)g(the)f Fi(c)1242 1757 y Fh(i)1266 1750 y Fy(is)g(designated)g(as)h(the)f
Fq(commit)g(point)p Fy(;)75 1817 y(the)j(communication)e(on)h(which)g(this)g
(e)o(v)o(ent)h(is)f(chosen)h(in)f(a)i(selecti)o(v)o(e)e(communication.)17
b(In)11 b(the)h(mechanism)75 1885 y(of)d([Rep88)q(],)h(the)f(only)f(possible)
g(commit)g(point)g(is)h Fi(c)919 1892 y Fw(1)937 1885 y Fy(.)16
b(The)9 b Fp(wrap)g Fy(construct)f(allo)o(ws)h(on)g(to)f(tack)i(on)e
Fi(c)1712 1892 y Fw(2)1731 1885 y Fy(;)g Fr(\001)g(\001)g(\001)d
Fy(;)j Fi(c)1853 1892 y Fh(n)75 1953 y Fy(after)j Fi(c)189
1960 y Fw(1)217 1953 y Fy(is)e(chosen,)h(b)o(ut)g(there)g(is)f(no)h(way)f(to)
g(make)h(an)o(y)g(of)g(the)f(other)h Fi(c)1221 1960 y Fh(i)1245
1953 y Fy(the)f(commit)g(point.)15 b(This)9 b(asymmetry)75
2021 y(is)j(a)h(serious)f(limitation)f(to)h(the)g(original)g(mechanism.)20
b(T)l(o)13 b(illustrate)e(this)h(problem,)h(consider)f(a)h(serv)o(er)h(that)
75 2088 y(implements)d(an)i(input)e(stream)i(abstraction.)20
b(Since)13 b(this)f(abstraction)g(should)g(be)h(smoothly)d(inte)o(grated)j
(into)75 2156 y(the)e(concurrent)h(model,)f(we)h(make)e(the)i(input)e
(operations)h(e)o(v)o(ent-v)o(alued;)g(for)g(e)o(xample,)h(the)f(function)146
2264 y FA(val)21 b(input)f(:)i(instream)e(->)i(string)e(event)75
2390 y Fy(would)14 b(be)h(used)g(to)g(read)h(a)g(single)e(character)m(.)31
b(Other)15 b(operations,)h(such)f(as)g Fp(input_line)f Fy(would)g(also)h(be)
75 2458 y(pro)o(vided.)i(Let)11 b(us)g(assume)g(that)g(the)g(implementation)e
(of)i(these)g(operations)g(uses)g(a)h(request-reply)f(protocol;)75
2525 y(thus,)g(a)h(successful)f Fp(input)f Fy(operations)h(in)n(v)o(olv)o(es)
g(the)g(communication)f(sequence)146 2633 y FA(send)21 b(\()p
Fg(ch)324 2639 y Ff(r)q(eq)374 2633 y FA(,)h(REQ_INPUT\);)d(accept\()p
Fg(ch)880 2639 y Ff(r)q(eply)959 2633 y FA(\))964 2802 y Fy(8)p
eop
%%Page: 9 9
9 8 bop 75 82 a Fy(P)o(ackaging)12 b(this)e(up)h(as)g(an)h(e)o(v)o(ent)f
(\(as)h(we)f(did)g(in)g(section)f(2.1\),)i(will)f(make)g(the)g
Fp(send)f Fy(communication)g(be)h(the)75 150 y(commit)i(point,)i(b)o(ut)f
(this)g(is)g(not)g(the)h(right)f(semantics.)26 b(T)l(o)14 b(see)i(the)e
(problem,)h(consider)g(the)f(case)h(where)h(a)75 218 y(client)c(thread)h
(wants)f(to)h(synchronize)f(on)h(the)f(choice)h(of)g(reading)g(a)g(character)
h(and)f(a)g(\256v)o(e)h(second)f(timeout;)75 285 y(e.g.:)189
393 y FA(sync)21 b(\(choose)f([)276 443 y(wrap)h(\(timeout\(TIME{sec=5)o(,)e
(usec=0}\),)320 493 y(fn)i(\(\))h(=>)f(raise)g(Timeout\),)276
543 y(input)g(instream)233 593 y(]\))75 718 y Fy(The)14 b(serv)o(er)g(will)f
(probably)f(accept)j(the)e(request)g(within)g(the)g(\256v)o(e)h(second)g
(limit,)e(e)o(v)o(en)i(though)f(the)g(wait)g(for)75 786 y(input)c(might)g(be)
i(inde\256nite.)16 b(The)10 b(right)g(semantics)f(for)i(the)f
Fp(input)g Fy(operation)g(requires)g(making)g(the)g Fp(accept)75
854 y Fy(be)i(the)f(commit)f(point.)15 b(The)d Fp(guard)f Fy(combinator)f
(pro)o(vides)h(a)h(mechanism)e(for)i(doing)e(this.)146 942
y(The)j Fp(guard)g Fy(combinator)f(is)h(the)h(dual)f(of)g Fp(wrap)p
Fy(;)h(it)f(b)o(undles)g(code)h(to)f(be)g(e)o(x)o(ecuted)i
Fq(befor)n(e)e Fy(the)g(commit)75 1010 y(point;)d(this)g(code)i(can)g
(include)f(communications.)j(It)e(has)f(the)g(type)146 1118
y FA(val)21 b(guard)f(:)i(\(unit)f(->)g('a)h(event\))e(->)i('a)f(event)75
1244 y Fy(A)9 b(guard)h(is)f(essentially)f(a)i(suspension)e(that)h(is)g
(forced)h(when)g Fp(sync)e Fy(is)h(applied)g(to)g(it.)16 b(As)9
b(a)h(simple)e(e)o(xample)i(of)75 1312 y(the)h(use)g(of)g Fp(guard)p
Fy(,)g(the)g Fp(timeout)f Fy(function,)h(described)g(abo)o(v)o(e,)h(is)f
(actually)g(implemented)e(use)i Fp(waitUntil)75 1379 y Fy(and)g(a)h(guard:)
146 1487 y FA(fun)21 b(timeout)f(t)i(=)f(guard)g(\()276 1537
y(fn)h(\(\))f(=>)g(waitUntil)f(\(add_time)g(\(t,)h(currentTime\(\)\)\))75
1663 y Fy(where)12 b Fp(currentTime)e Fy(returns)h(the)g(current)h
(wall-clock)f(time.)146 1752 y(Returning)h(to)g(our)h(RPC)h(e)o(xample)e
(from)h(abo)o(v)o(e,)h(we)f(can)g(no)o(w)f(b)o(uild)f(an)i(abstract)g(RPC)h
(operation)e(with)75 1819 y(the)f(reply)g(as)h(the)f(commit)f(point.)16
b(The)11 b(two)g(dif)o(ferent)g(v)o(ersions)g(are:)146 1927
y FA(fun)21 b(clientCallEvt1)e(x)i(=)h(wrap)f(\()276 1977 y(transmit\(reqCh,)
e(x\),)276 2027 y(fn)j(\(\))f(=>)g(accept)g(replyCh\))146 2127
y(fun)g(clientCallEvt2)e(x)i(=)h(guard)f(\(fn)g(\(\))g(=>)g(\()276
2176 y(send\(reqCh,)f(x\);)276 2226 y(receive)h(replyCh\))75
2352 y Fy(where)12 b Fp(clientCallEvt1)e Fy(commits)g(on)h(the)h(serv)o(er')m
(s)h(acceptance)g(of)e(the)h(request)f(and)h Fp(clientCallEvt2)75
2420 y Fy(commits)h(on)h(the)g(serv)o(er')m(s)i(reply)e(to)g(the)g(request.)
26 b(Using)14 b(guards)g(to)g(generate)h(requests)f(like)g(this)f(raises)i(a)
75 2487 y(couple)d(of)g(other)g(problems.)18 b(First)12 b(of)g(all,)g(if)g
(the)g(serv)o(er)h(cannot)f(guarantee)h(that)e(requests)h(will)f(be)h
(accepted)75 2555 y(promptly)m(,)d(then)h(e)o(v)o(aluating)f(the)h(guard)g
(may)g(cause)h(delays.)16 b(The)10 b(solution)e(to)i(this)f(is)h(to)f(spa)o
(wn)h(a)h(ne)o(w)f(thread)75 2623 y(to)h(issue)g(the)g(request:)964
2802 y(9)p eop
%%Page: 10 10
10 9 bop 146 82 a FA(fun)21 b(clientCallEvt3)e(x)i(=)h(guard)f(\(fn)g(\(\))g
(=>)g(\()276 132 y(spawn\(fn)f(\(\))i(=>)f(send\(reqCh,)f(x\)\);)276
182 y(receive)h(replyCh\))75 295 y Fy(Another)13 b(alternati)o(v)o(e)f(is)h
(for)g(the)f(serv)o(er)i(to)f(be)f(a)i(clearing-house)e(for)h(requests;)g
(spa)o(wning)g(a)g(ne)o(w)f(thread)h(to)75 363 y(handle)e(each)h(ne)o(w)g
(request.)146 452 y(The)e(other)g(problem)f(is)h(more)g(serious:)15
b(what)9 b(if)h(this)g(RPC)h(e)o(v)o(ent)f(is)g(used)g(in)f(a)i(selecti)o(v)o
(e)f(communication)75 519 y(and)j(some)g(other)g(e)o(v)o(ent)g(is)g(chosen?)
22 b(Ho)o(w)12 b(does)h(the)g(serv)o(er)h(a)o(v)o(oid)f(blocking)f(fore)o(v)o
(er)i(on)f(sending)f(a)i(reply?)75 587 y(F)o(or)e(idempotent)d(services,)j
(this)d(can)j(be)f(handled)f(by)h(ha)o(ving)f(the)h(client)f(create)i(a)f
(dedicated)g(channel)g(for)g(the)75 655 y(reply)g(and)g(ha)o(ving)f(the)h
(serv)o(er)h(spa)o(wn)f(a)g(ne)o(w)g(thread)g(to)g(send)g(the)f(reply)m(.)17
b(The)11 b(client)g(side)f(of)h(this)f(protocol)h(is)146 751
y FA(fun)21 b(clientCallEvt4)e(x)i(=)h(guard)f(\(fn)g(\(\))g(=>)g(let)276
800 y(val)g(replyCh)g(=)g(channel\(\))276 850 y(in)320 900
y(spawn\(fn)f(\(\))h(=>)h(send\(reqCh,)d(\(replyCh,)h(x\)\)\);)320
950 y(receive)g(replyCh)276 1000 y(end\))75 1113 y Fy(When)11
b(the)h(serv)o(er)g(sends)f(the)g(reply)g(it)g(e)o(v)o(aluates)146
1209 y FA(spawn)20 b(\(fn)h(\(\))h(=>)f(send\(replyCh,)e(reply\)\))75
1323 y Fy(If)g(the)g(client)f(has)h(already)g(chosen)g(a)g(dif)o(ferent)g(e)o
(v)o(ent,)i(then)d(this)g(thread)h(blocks)f(and)h(will)f(be)h(garbage)75
1390 y(collected.)146 1479 y(F)o(or)c(services)h(that)e(are)i(not)f
(idempotent,)g(this)f(scheme)h(is)f(not)h(suf)o(\256cient;)h(the)f(serv)o(er)
h(needs)f(a)h(way)e(to)75 1547 y Fq(abort)c Fy(the)i(transaction.)k(The)11
b(function)146 1642 y FA(val)21 b(wrapAbort)f(:)h(\('a)g(event)g(*)h(\(unit)f
(->)g(unit\)\))f(->)i(unit)75 1756 y Fy(is)13 b(pro)o(vided)g(for)h(this)e
(purpose.)23 b(The)14 b(semantics)e(are)j(that)e(if)g(the)g(wrapped)h(e)o(v)o
(ent)g(is)f Fq(not)f Fy(chosen)i(in)f(a)h Fp(sync)75 1824 y
Fy(operation,)d(then)f(a)h(ne)o(w)g(thread)f(is)g(spa)o(wned)h(to)f(e)o(v)o
(aluate)h(the)f(second)h(ar)o(gument,)g(called)f(the)h Fq(abort)e
Fy(function.)75 1892 y(This)h(is)g(the)g(complement)g(of)g
Fp(wrap)g Fy(in)g(the)h(sense)f(that)g(if)h(you)f(vie)o(w)g(e)o(v)o(ery)h
(base-e)o(v)o(ent)g(in)f(a)h(choice)g(as)g(ha)o(ving)75 1959
y(both)i(a)g(wrapper)h(and)g(and)f(an)h(abort)f(function,)g(then,)h(when)g
Fp(sync)f Fy(is)f(applied,)i(the)f(wrapper)i(of)e(the)g(chosen)75
2027 y(e)o(v)o(ent)e(is)g(called)h(and)f(the)g(abort)h(functions)e(of)h(the)h
(other)f(base)g(e)o(v)o(ents)h(are)g(spa)o(wned)f(of)o(f.)146
2116 y(The)h(client)f(code)h(for)h(the)f(RPC)h(using)e(abort)h(must)f
(allocate)h(two)f(channels:)17 b(one)12 b(for)g(the)g(reply)g(and)g(one)75
2183 y(for)g(the)f(abort)g(message:)146 2279 y FA(fun)21 b(clientCallEvt5)e
(x)i(=)h(guard)f(\(fn)g(\(\))g(=>)g(let)276 2329 y(val)g(replyCh)g(=)g
(channel\(\))276 2379 y(val)g(abortCh)g(=)g(channel\(\))276
2428 y(fun)g(abortFn)g(\(\))g(=)h(send)f(\(abortCh,)f(\(\)\))276
2478 y(in)320 2528 y(spawn\(fn)g(\(\))h(=>)363 2578 y(send)g(\(reqCh,)g
(\(replyCh,)f(abortCh,)g(x\)\)\);)320 2628 y(wrapAbort)g(\(receive)g
(replyCh,)g(abortFn\))276 2677 y(end\))952 2802 y Fy(10)p eop
%%Page: 11 11
11 10 bop 75 82 a Fy(When)11 b(the)h(serv)o(er)g(is)f(ready)h(to)f(reply)g
(\(i.e.,)i(commit)d(the)h(transaction\),)g(it)g(synchronizes)g(on)g(the)g(v)o
(alue)146 190 y FA(choose[)233 240 y(wrap)21 b(\(receive)f(abortCh,)276
290 y(fn)i(\(\))f(=>)32 b Fe(abort)9 b(the)h(tr)o(ansaction)o
FA(\),)233 340 y(wrap)21 b(\(transmit)f(\(replyCh,)g(reply\),)276
389 y(fn)i(\(\))f(=>)32 b Fe(commit)9 b(the)i(tr)o(ansaction)n
FA(\))189 439 y(])75 565 y Fy(This)g(mechanism)f(is)h(used)g(to)g(implement)f
(the)h(concurrent)h(stream)f(I/O)g(library)g(in)g Fx(CML)p
Fy(.)146 654 y(Another)g(e)o(xtension)f(to)h([Rep88)q(])g(is)g(the)g
(function:)146 761 y FA(val)21 b(wrapHandler)e(:)j(\('a)f(event)g(*)g(\(exn)g
(->)h('a\)\))f(->)g('a)g(event)75 887 y Fy(wraps)10 b(an)f(e)o(xception)h
(handler)f(around)h(an)g(e)o(v)o(ent)866 871 y Fw(2)884 887
y Fy(.)17 b(F)o(or)10 b(e)o(xample,)g Fp(syncOnInput)e Fy(will)h(raise)h(an)g
(e)o(xception)f(if)75 955 y(the)i(\256le)g(speci\256ed)g(by)g(the)g
(descriptor)f Fp(fd)h Fy(has)g(been)g(closed.)17 b(Using)10
b Fp(wrapHandler)p Fy(,)g(we)h(can)g(de\256ne)h(a)f(better)75
1023 y(beha)o(v)o(ed)h(v)o(ersion)f(of)h Fp(syncOnInput)p Fy(:)146
1131 y FA(fun)21 b(waitForInput)e(fd)i(=)h(wrapHandler)e(\()276
1181 y(wrap)h(\(syncOnInput)f(fd,)h(fn)g(\(\))h(=>)f(true\),)276
1230 y(fn)h(_)f(=>)h(false\))75 1356 y Fy(Upon)11 b(synchronization,)f(this)h
(will)f(return)i Fp(true)f Fy(if)g(input)f(is)h(a)o(v)o(ailable,)h(and)f
Fp(false)g Fy(if)g(the)g(\256le)h(is)f(closed.)75 1502 y Fu(2.5)50
b(Str)o(eam)13 b(I/O)75 1621 y Fx(CML)j Fy(pro)o(vides)f(a)h(concurrent)f(v)o
(ersion)h(of)f(the)g Fx(SML)i Fy(stream)e(I/O)g(primiti)o(v)o(es.)28
b(Input)14 b(operations)h(in)g(this)75 1689 y(v)o(ersion)d(are)h(e)o(v)o(ent)
g(v)o(alued,)f(which)g(allo)o(ws)g(them)g(to)g(be)g(used)g(in)g(selecti)o(v)o
(e)g(communication.)18 b(F)o(or)c(e)o(xample,)75 1757 y(a)d(program)f(might)g
(want)g(to)g(gi)o(v)o(e)h(a)g(user)f(60)h(seconds)f(to)g(supply)g(a)h
(password.)k(This)10 b(can)h(be)g(programmed)f(as:)146 1865
y FA(fun)21 b(getpasswd)f(\(\))h(=)h(sync)f(\(choose)f([)320
1914 y(wrap)h(\(timeoutsec=60,)e(usec=0,)363 1964 y(fn)j(\(\))f(=>)h(NONE\),)
320 2014 y(wrap)f(\(input_line)e(std_in,)i(SOME\))276 2064
y(]\))75 2190 y Fy(This)c(will)g(return)h Fp(NONE)p Fy(,)g(if)g(the)f(user)h
(fails)f(to)h(respond)f(within)g(60)g(seconds,)j(otherwise)d(it)h(wraps)g
Fp(SOME)75 2257 y Fy(around)9 b(the)g(user')m(s)h(response)552
2241 y Fw(3)570 2257 y Fy(.)16 b(Streams)10 b(are)f(implemented)f(as)h
(threads)g(which)g(handle)g(b)o(uf)o(fering.)16 b(The)9 b(input)75
2325 y(operations)i(are)h(actually)f(request/reply/abort)f(protocols,)h
(similar)f(to)h(the)g(one)h(discussed)e(abo)o(v)o(e.)p 75 2366
720 2 v 128 2393 a Fo(2)142 2409 y Fn(exn)e Fs(is)i(the)f(type)f(of)i(e)o
(xception)e(v)o(alues.)128 2440 y Fo(3)142 2456 y Fs(Since)h
Fn(SOME)e Fs(is)j(a)f(constructor)f(function)h(\(i.e.,)i Fn(SOME)18
b(:)h('a)g(->)g('a)f(option)p Fs(\),)8 b(it)i(can)f(be)f(used)g(as)g(a)h
(function)g(ar)o(gument.)952 2802 y Fy(11)p eop
%%Page: 12 12
12 11 bop 75 82 a Fz(3)58 b(A)o(pplications)75 218 y Fx(CML)15
b Fy(is)g(more)f(than)h(an)f(e)o(x)o(ercise)i(in)f(language)f(design;)i(it)e
(is)g(intended)g(to)h(be)f(a)h(useful)g(tool)f(for)h(b)o(uilding)75
286 y(lar)o(ge)d(systems.)j(In)d(this)e(section)h(we)h(describe)f(two)g
(applications)f(of)h Fx(CML)p Fy(,)h(and)g(ho)o(w)f(the)o(y)g(use)g(the)g
(features)75 353 y(of)g Fx(CML)p Fy(.)75 499 y Fu(3.1)50 b(Interactive)11
b(systems)75 618 y Fy(Pro)o(viding)16 b(a)i(better)e(foundation)g(for)h
(programming)f(interacti)o(v)o(e)h(systems,)g(such)g(as)f(programming)g(en)n
(vi-)75 686 y(ronments,)h(was)f(the)g(original)f(moti)o(v)o(ation)f(for)j
(this)e(line)h(of)g(research)1245 672 y Fw([RG86])1347 686
y Fy(.)32 b(Because)17 b(of)g(their)f(naturally)75 754 y(concurrent)c
(structure,)f(interacti)o(v)o(e)h(systems)e(are)i(one)f(of)h(the)f(most)f
(important)g(application)g(areas)i(for)g Fx(CML)p Fy(.)75 822
y(Concurrenc)o(y)h(arises)e(in)g(se)o(v)o(eral)h(ways)f(in)g(interacti)o(v)o
(e)g(systems:)75 936 y Fx(User)h(interaction.)24 b Fy(Handling)9
b(user)i(input)e(is)i(the)f(most)f(comple)o(x)h(aspect)h(of)g(an)f(interacti)
o(v)o(e)h(program.)16 b(Most)189 993 y(interacti)o(v)o(e)11
b(systems)f(use)i(an)f Fq(e)o(vent-loop)h Fy(and)f Fq(call-bac)o(k)h
Fy(functions.)k(The)c(e)o(v)o(ent-loop)f(recei)o(v)o(es)h(input)189
1049 y(e)o(v)o(ents)g(\(e.g.,)j(mouse)c(clicks\))i(and)f(passes)h(them)f(to)g
(the)g(appropriate)h Fq(e)o(vent-handler)p Fy(.)20 b(This)12
b(structure)189 1106 y(is)17 b(a)g(poor)o(-man')m(s)h(concurrenc)o(y:)29
b(the)17 b(e)o(v)o(ent-handlers)h(are)g(coroutines)f(and)g(the)g(e)o(v)o
(ent-loop)g(is)g(the)189 1162 y(scheduler)m(.)75 1256 y Fx(Multiple)12
b(services.)23 b Fy(F)o(or)9 b(e)o(xample,)g(consider)f(a)h(document)e
(preparation)i(system)e(that)h(pro)o(vides)g(both)f(editing)189
1312 y(and)14 b(formatting.)23 b(These)14 b(two)g(services)g(are)g
(independent)g(and)g(can)g(be)g(naturally)g(or)o(ganized)g(as)g(two)189
1369 y(separate)e(threads.)k(Multiple)10 b(vie)o(ws)h(are)h(implemented)e(by)
h(replicating)g(the)g(threads.)75 1463 y Fx(Interlea)o(ving)h(computation.)24
b Fy(A)11 b(user)g(of)g(a)g(document)f(preparation)h(system)f(may)h(want)f
(to)h(edit)f(one)h(part)g(of)189 1519 y(a)j(document)g(while)f(another)i
(part)f(is)g(being)f(formatted.)25 b(Since)15 b(formatting)e(may)h(take)g(a)h
(signi\256cant)189 1575 y(amount)8 b(of)i(time,)g(pro)o(viding)e(a)j
(responsi)o(v)o(e)e(interface)h(requires)g(interlea)o(ving)f(formatting)f
(and)i(editing.)189 1632 y(If)h(the)h(editor)f(and)g(formatter)g(are)h
(separate)g(threads,)g(then)f(interlea)o(ving)g(comes)g(for)h(free.)75
1726 y Fx(Output)h(driven)e(applications.)23 b Fy(Most)12 b(windo)o(wing)f
(toolkits,)h(for)h(e)o(xample)f Fx(Xlib)1438 1711 y Fw([Nye90)o(])1549
1726 y Fy(,)i(pro)o(vide)e(an)h Fq(input)189 1782 y(oriented)j
Fy(model,)i(in)e(which)h(the)f(application)g(code)h(is)g(occasionally)f
(called)h(in)f(response)h(to)g(some)189 1839 y(e)o(xternal)12
b(e)o(v)o(ent.)19 b(But)12 b(man)o(y)g(applications)f(are)h
Fq(output)f Fy(oriented.)19 b(Consider)n(,)12 b(for)h(e)o(xample,)f(a)h
(compu-)189 1895 y(tationally)d(intensi)o(v)o(e)g(simulation)g(with)g(a)i
(graphical)g(display)e(of)i(the)f(current)h(state)f(of)g(the)h(simulation.)
189 1952 y(This)d(application)g(must)f(monitor)h(windo)o(w)g(e)o(v)o(ents,)h
(such)g(as)g(refresh)g(and)g(resize)h(noti\256cations,)e(so)h(that)189
2008 y(it)k(can)h(redra)o(w)h(itself)e(when)h(necessary)m(.)28
b(In)15 b(a)g(sequential)f(implementation,)g(the)h(handling)e(of)i(these)189
2064 y(e)o(v)o(ents)e(must)f(be)h(postponed)f(until)g(the)h(simulation)e(is)i
(ready)h(to)f(update)g(the)g(displayed)f(information.)189 2121
y(By)k(separating)g(the)f(display)g(code)h(and)g(simulation)e(code)i(into)f
(separate)i(threads,)g(the)f(handling)f(of)189 2177 y(asynchronous)10
b(redra)o(wing)i(is)f(easy)m(.)75 2303 y(The)k(root)g(cause)h(of)f(these)g
(forms)g(of)g(concurrenc)o(y)h(is)f(computer)o(-human)f(interaction:)23
b(humans)14 b(are)i(asyn-)75 2371 y(chronous)11 b(and)g(slo)o(w)m(.)146
2460 y Fx(CML)j Fy(has)f(been)h(used)f(to)g(b)o(uild)g(a)g(multi-threaded)g
(interface)h(to)f(the)g Fx(X)g Fy(protocol)1499 2445 y Fw([SG86)o(])1596
2460 y Fy(,)i(called)e Fx(eXene)p Fy(.)75 2527 y(This)h(system)g(pro)o(vides)
g(a)i(similar)d(le)o(v)o(el)i(of)g(function)f(as)h Fx(Xlib)1120
2513 y Fw([Nye90)o(])1231 2527 y Fy(,)h(b)o(ut)e(with)g(a)i(substantially)d
(dif)o(ferent,)75 2595 y(and)e(we)h(think)e(better)n(,)i(model)e(of)h(user)h
(interaction.)k(W)n(indo)o(ws)10 b(in)h Fx(eXene)h Fy(ha)o(v)o(e)g(an)g
Fq(en)n(vir)n(onment)p Fy(,)f(consisting)75 2663 y(of)h(three)g(streams)g(of)
g(input)e(from)i(the)g(windo)o(w')m(s)f(parent)h(\(mouse,)g(ke)o(yboard)g
(and)g(control\),)g(and)f(one)h(output)952 2802 y(12)p eop
%%Page: 13 13
13 12 bop 75 82 a Fy(stream)17 b(for)h(requesting)f(services)g(from)h(the)f
(windo)o(w')m(s)g(parent.)35 b(F)o(or)18 b(each)h(child)d(of)i(the)f(windo)o
(w)m(,)i(there)75 150 y(will)14 b(be)g(corresponding)g(output)g(streams)g
(and)g(an)h(input)e(stream.)27 b(The)14 b(input)g(streams)g(are)h
(represented)g(by)75 218 y(e)o(v)o(ent)c(v)o(alues)e(and)i(the)f(output)f
(streams)h(by)g(e)o(v)o(ent)h(v)o(alued)f(functions.)15 b(A)c(windo)o(w)e(is)
h(responsible)f(for)i(routing)75 285 y(messages)d(to)h(its)f(children,)i(b)o
(ut)e(this)g(can)i(almost)e(always)f(be)j(done)e(using)g(a)i(generic)f
(router)g(function)f(pro)o(vided)75 353 y(by)k Fx(eXene)p Fy(.)21
b(T)l(ypically)m(,)12 b(each)h(windo)o(w)e(has)i(a)f(separate)h(thread)f(for)
h(each)g(input)e(stream)h(as)h(well)f(as)g(a)g(thread,)75 421
y(or)h(two,)h(for)g(managing)e(state)h(and)h(coordinating)e(the)h(other)h
(threads.)22 b(By)14 b(breaking)f(the)h(code)f(up)g(this)g(way)m(,)75
489 y(each)f(indi)o(vidual)e(thread)h(is)g(quite)g(simple.)k(This)c(model)g
(is)f(similar)h(to)g(those)f(of)i([Pik89])f(and)h([Haa90]\).)146
577 y(This)17 b(structure)g(allo)o(ws)h(us)f(to)h(use)f Fq(dele)n(gation)g
Fy(techniques)h(to)f(de\256ne)i(ne)o(w)f(beha)o(vior)f(from)h(e)o(xisting)75
645 y(implementations.)24 b(Dele)o(gation)14 b(is)h(an)f(object-oriented)h
(technique)f(\(so)g(we)h(kno)o(w)f(it)h(must)e(be)i(good\),)h(that)75
713 y(originated)d(in)g(concurrent)i(actor)f(systems)784 698
y Fw([Lie86)n(])882 713 y Fy(.)24 b(As)14 b(an)g(e)o(xample,)h(consider)e
(the)h(case)g(of)g(adding)f(a)i(menu)75 780 y(to)g(an)h(e)o(xisting)e(te)o
(xt)h(windo)o(w)m(.)28 b(W)l(e)17 b(can)e(do)h(this)e(in)h(a)h(general)g(way)
f(by)g(de\256ning)g(a)h(wrapper)g(that)f(takes)g(a)75 848 y(windo)o(w')m(s)f
(en)n(vironment)f(and)i(returns)f(a)g(ne)o(w)m(,)i(wrapped,)g(en)n
(vironment.)25 b(The)14 b(wrapped)h(en)n(vironment)e(has)75
916 y(a)j(thread)f(monitoring)e(the)i(mouse)g(stream)g(of)g(the)g(old)f(en)n
(vironment.)28 b(Normally)m(,)16 b(this)e(thread)h(just)f(passes)75
984 y(messages)8 b(along)g(to)g(the)h(wrapped)g(windo)o(w)m(,)f(b)o(ut)g
(when)h(a)g(mouse)f(\252b)o(utton)f(do)o(wn\272)i(message)f(comes)g(along,)h
(the)75 1051 y(thread)j(pops)g(up)g(the)g(menu)g(and)g(consumes)f(mouse)h
(messages)g(until)f(an)h(item)g(is)f(chosen.)20 b(Emden)11
b(Gansner)n(,)75 1119 y(of)j(A)-5 b(T&T)14 b(Bell)g(Laboratories,)i(has)e(de)
o(v)o(eloped)g(a)h(\252widget\272)f(toolkit)e(on)i(top)g(of)h
Fx(eXene)p Fy(,)h(which)e(uses)g(these)75 1187 y(dele)o(gation)d(techniques)f
(hea)o(vily)m(.)146 1275 y(The)h(implementation)e(of)i Fx(eXene)20
b Fy(which)11 b(is)f(currently)h(about)g(8,500)g(lines)f(of)i
Fx(CML)f Fy(code,)h(uses)f(threads)75 1343 y(hea)o(vily)m(.)26
b(At)14 b(the)h(lo)o(west)f(le)o(v)o(el,)h(threads)g(are)g(used)g(to)f(b)o
(uf)o(fer)h(communication)e(with)h(the)g Fx(X)h Fy(serv)o(er)m(.)28
b(There)75 1411 y(are)12 b(threads)g(to)f(manage)g(shared)h(state,)g(such)f
(as)h(graphics)f(conte)o(xts,)h(fonts)f(and)g(ke)o(ycode)h(translation)e
(tables.)75 1479 y(Because)15 b(the)e(internal)g(threads)h(are)g(fairly)f
(specialized)h(and)f(tightly)f(inte)o(grated,)j(there)e(is)g(not)g(much)g
(use)h(of)75 1546 y(e)o(v)o(ents)d(as)h(an)f(abstraction)g(mechanism.)146
1635 y(The)16 b(use)h(of)g(e)o(v)o(ents)f(as)h(an)g(abstraction)f(mechanism)f
(is)i(common)e(at)i(the)f(application)g(programmer')m(s)75
1703 y(le)o(v)o(el.)k(In)12 b(addition)f(to)h(the)g(e)o(v)o(ent-v)o(alued)g
(interface)h(of)f(the)g(windo)o(w)g(en)n(vironments,)f(there)i(are)g(higher)o
(-le)o(v)o(el)75 1770 y(objects)d(that)g(ha)o(v)o(e)g(abstract)h(synchronous)
e(interfaces.)17 b(One)10 b(e)o(xample)g(is)g(a)h Fq(virtual)e(terminal)g
Fy(windo)o(w)g(\(vtty\).)75 1838 y(This)f(pro)o(vides)g(a)i(synchronous)d
(stream)i(interface)g(to)f(its)g(clients,)h(which)g(is)f(compatible)g(with)g
(the)h(signature)f(of)75 1906 y Fx(CML)p Fy(')m(s)k(concurrent)g(I/O)f
(library)m(.)17 b(If)11 b(the)g(client-code)g(is)g(implemented)f(as)h(a)h
Fq(functor)1477 1891 y Fw([Mac84)m(])1601 1906 y Fy(\(parameterized)75
1974 y(module\),)f(then)g(it)g(can)h(be)f(used)g(with)g(either)g(the)h
(concurrent)f(I/O)g(library)h(or)f(the)g(vtty)g(abstraction.)146
2062 y(The)h(vtty)g(abstraction)g(is)h(a)g(good)f(e)o(xample)h(of)f(where)i
(user)o(-de\256ned)f(abstract)g(synchronous)f(operations)75
2130 y(are)20 b(necessary)f(for)g(program)g(modularity)m(.)38
b(At)19 b(an)o(y)g(time,)h(the)f(vtty)f(thread)h(must)f(be)h(ready)h(to)e
(recei)o(v)o(e)75 2198 y(input)13 b(from)h(the)g(user)h(and)f(output)f(from)h
(the)g(application;)h(thus)e(it)h(needs)g(selecti)o(v)o(e)g(communication.)24
b(The)75 2265 y(underlying)12 b(windo)o(w)f(toolkit)h(\()p
Fx(eXene)p Fy(\))i(pro)o(vides)e(an)h(abstract)g(interface)g(to)f(the)h
(input)f(stream,)h(b)o(ut,)g(since)g(it)75 2333 y(is)e(e)o(v)o(ent-v)o
(alued,)h(it)e(can)i(be)g(used)f(in)g(the)g(selecti)o(v)o(e)g(communication.)
146 2422 y(Another)g(e)o(xample)g(of)g(the)g(use)g(of)h(ne)o(w)f
(communication)e(abstractions)i(is)g(a)g Fq(b)o(uf)o(fer)n(ed)g(multicast)f
Fy(channel)75 2489 y(\(a)i(simple)e(v)o(ersion)i(is)f(described)g(in)g
([Rep90b)q(]\).)17 b(This)11 b(abstraction)g(has)h(pro)o(v)o(en)g(quite)e
(useful)i(in)f(supporting)75 2557 y(multiple)d(vie)o(ws)i(of)g(an)g(object.)
16 b(When)10 b(the)g(vie)o(wed)f(object)h(is)f(updated,)i(the)e(thread)i
(managing)e(its)g(state)h(sends)75 2625 y(a)f(noti\256cation)f(on)h(the)f
(multicast)g(channel.)16 b(The)9 b(multicast)e(channel)i(basically)f(serv)o
(es)i(the)f(role)f(of)h(a)h(call-back)952 2802 y(13)p eop
%%Page: 14 14
14 13 bop 75 82 a Fy(function,)13 b(while)f(freeing)g(the)h(vie)o(wed)f
(object)g(from)h(the)f(details)g(on)g(managing)g(multiple)f(vie)o(ws.)20
b(All)12 b(of)g(the)75 150 y(details)j(of)g(creating/destroying)f(vie)o(ws)g
(and)i(distrib)o(uting)d(messages)i(are)h(taken)e(care)j(of)e(by)g(the)h
(multicast)75 218 y(abstraction.)75 363 y Fu(3.2)50 b(Distrib)o(uted)11
b(ML)75 482 y Fy(Another)h(project)h(in)n(v)o(olving)e Fx(CML)i
Fy(is)f(the)h(de)o(v)o(elopment)f(of)h(a)g(distrib)o(uted)e(programming)g
(toolkit)g(for)i Fx(ML)p Fy(,)75 550 y(which)k(is)h(being)f(done)h(in)f
(collaboration)g(with)g(Bard)i(Bloom,)g(Robert)f(Cooper)n(,)j(Chet)d(Murthy)f
(and)g(T)n(im)75 617 y(T)m(eitelbaum)7 b(at)g(Cornell)g(Uni)o(v)o(ersity)m(.)
13 b(The)7 b(lo)o(w-le)o(v)o(el)g(I/O)g(support)g(of)g Fx(CML)g
Fy(is)g(suf)o(\256cient)g(to)g(b)o(uil)o(d)g(a)g(structured)75
685 y(synchronous)16 b(interface)i(to)f(network)f(communication)g(\(as)h(was)
g(done)g(in)g(our)g Fx(X)p Fy(-windo)o(ws)f(application\).)75
753 y(Higher)o(-le)o(v)o(el)h(linguistic)e(support)h(for)h(distrib)o(uted)f
(programming,)h(such)g(as)g(the)g Fq(pr)n(omise)f Fy(mechanism)g(of)75
821 y([LS88],)g(can)f(be)g(b)o(uilt)f(using)g(e)o(v)o(ents)g(to)g(de\256ne)i
(the)e(ne)o(w)h(abstractions.)26 b(Some)15 b(of)f(these)h(ideas)f(ha)o(v)o(e)
i(been)75 888 y(prototyped)c(by)i(Chet)g(Murthy)e(as)h(part)h(of)g(a)g
(re-implementation)d(of)j(the)f Fx(Nuprl)i Fy(interacti)o(v)o(e)e(proof)h
(system.)75 956 y Fx(Nuprl)f Fy(can)f(require)g(v)o(ast)f(amounts)g(of)h
(system)f(resources)h(when)g(used)f(to)h(de)o(v)o(elop)f(lar)o(ge)i(proofs,)f
(b)o(ut)f(it)g(also)75 1024 y(pro)o(vides)e(ample)g(opportunity)f(for)i
(coarse-grain)g(parallelism.)15 b(The)10 b(system)e(is)h(structured)g(as)h(a)
g(pool)f(of)g Fq(pr)n(oof)75 1092 y(servers)h Fy(distrib)o(uted)g(across)h(a)
g(local)f(area)i(network)e(of)h(workstations.)k(A)c(user')m(s)g(session)f
(manager)h(will)f(farm)75 1159 y(out)16 b(pieces)g(of)h(the)f(proof)g(to)g
(idle)g(and)g(a)o(v)o(ailable)g(serv)o(ers;)k(it)15 b(uses)h(an)h(object)f
(similar)f(to)h(a)h(promise)e(as)i(a)75 1227 y(place-holder)12
b(for)f(the)h(outstanding)d(work.)75 1394 y Fz(4)58 b(Implementation)75
1529 y Fx(CML)11 b Fy(is)g(written)f(entirely)g(in)g Fx(SML)p
Fy(,)j(using)c(a)i(couple)g(of)g(non-standard)f(e)o(xtensions)g(pro)o(vided)g
(by)h Fx(SML/NJ)p Fy(:)75 1597 y Fq(\256rst-class)i(continuations)518
1583 y Fw([DHM91)m(])664 1597 y Fy(and)i Fq(async)o(hr)n(onous)g(signals)1143
1583 y Fw([Rep90a)m(])1265 1597 y Fy(.)28 b(W)l(e)16 b(added)g(one)f(minor)f
(primiti)o(v)o(e)75 1665 y(operation)h(to)g(the)h(compiler)f(\(a)h(ten)f
(line)g(change)h(in)f(a)h(30,000)f(line)g(compiler\),)i(which)e(was)g
(necessary)h(to)75 1733 y(guarantee)g(that)e Fp(sync)h Fy(preserv)o(e)h
(tail-recursion.)28 b(Threads)15 b(are)h(implemented)1404 1732
y Fq(\301)1400 1733 y(a)f(la)g Fy([W)l(an80],)i(using)d Fq(\256rst-)75
1800 y(class)8 b(continuations)p Fy(,)g(and)g(the)h Fx(SML/NJ)g
Fy(asynchronous)f(signal)g(facility)g(is)g(used)h(to)f(implement)f(pre-empti)
o(v)o(e)75 1868 y(scheduling.)146 1957 y(Unlike)14 b(other)i
(continuation-passing)d(style)i(compilers,)i(such)e(as)h([Ste78])g(and)g
([KKR)1598 1940 y Fd(+)1628 1957 y Fy(86],)h(the)f(code)75
2024 y(generated)k(by)f(the)h Fx(SML/NJ)g Fy(compiler)f(does)g(not)g(use)h(a)
f(run-time)g(stack.)42 b(This)18 b(means)i(that)f Fp(callcc)75
2092 y Fy(and)c Fp(throw)f Fy(are)i(constant-time)e(operations.)27
b(While)14 b(this)g(is)h(possible)f(using)g(a)h(stack)1515
2078 y Fw([HDB90)o(])1640 2092 y Fy(;)i(heap-based)75 2160
y(implementations)9 b(are)j(better)f(suited)g(for)h(implementing)d
(light-weight)g(threads)j(\(Haahr')m(s)g(e)o(xperience)h(bears)75
2228 y(this)d(out)211 2213 y Fw([Haa90)n(])320 2228 y Fy(\).)146
2316 y(Ev)o(ent)j(v)o(alues)h(ha)o(v)o(e)h(a)f(natural)g(implementation)d(in)
j(terms)f(of)h(\256rst-class)h(continuations.)22 b(W)n(ithout)13
b(the)75 2384 y Fp(choose)e Fy(operator)n(,)h(an)f(e)o(v)o(ent)h(v)o(alue)f
(could)g(be)g(represented)h(as)146 2488 y FA(type)21 b('a)g(event)g(=)g('a)h
(cont)f(->)g('a)75 2610 y Fy(with)13 b Fp(sync)g Fy(being)g(directly)g
(implemented)f(by)h Fp(callcc)p Fy(.)23 b(This)13 b(representation)g
(captures)h(the)f(intuition)f(that)75 2677 y(an)20 b(e)o(v)o(ent)f(is)g(just)
f(a)i(synchronous)e(operation)h(with)g(its)g(synchronization)f(point)g
(continuation)g(as)h(a)h(free)952 2802 y(14)p eop
%%Page: 15 15
15 14 bop 75 82 a Fy(v)o(ariable.)26 b(The)15 b Fp(choose)e
Fy(operator)i(requires)g(polling,)f(since)g(we)h(need)g(to)f(see)h(which)f
(\(if)g(an)o(y\))h(base)g(e)o(v)o(ents)75 150 y(are)i(immediately)d(a)o(v)o
(ailable)i(for)g(synchronization.)30 b(Thus,)17 b(the)f(implementation)e(of)i
(an)g(e)o(v)o(ent)g(v)o(alue)g(is)g(a)75 218 y(list)e(of)h(base)g(e)o(v)o
(ents,)i(with)d(each)i(base)f(e)o(v)o(ent)g(represented)h(by)f(a)g(polling)f
(function,)h(a)h(function)e(to)h(call)g(for)75 285 y(immediate)8
b(synchronization)f(and)i(a)g(function)f(for)h(blocking.)15
b(The)9 b(implementation)e(of)i(a)g(precursor)g(to)f Fx(CML)75
353 y Fy(is)j(described)g(in)g(detail)g(in)g([Rep89].)146 442
y(The)h(support)f(of)i Fp(poll)f Fy(requires)g(grouping)g(base)g(e)o(v)o
(ents)h(that)f(are)h(being)f(polled)f(as)i(a)g(group.)19 b(Note)13
b(that)75 509 y Fp(poll)e Fy(has)g(the)g(property)g(that)g(the)h(e)o(v)o(ent)
146 601 y FA(poll\(poll)19 b($ev_1$\))75 711 y Fy(is)11 b(equi)o(v)o(alent)f
(to)146 803 y FA(wrap\(poll)19 b($ev_1$,)i(SOME\))75 912 y
Fy(W)l(e)12 b(use)f(this)g(property)g(to)g(collapse)g(nested)g(applications)f
(of)i Fp(poll)p Fy(.)146 1001 y(The)j(implementation)f(of)h
Fp(guard)g Fy(is)g(straight)g(forward:)25 b(a)16 b(guard)f(e)o(v)o(ent)h(v)o
(alue)g(is)f(represented)h(by)f(the)75 1069 y(guard)10 b(function,)g(when)g
Fp(sync)f Fy(is)h(applied)f(to)h(a)g(guard)g(e)o(v)o(ent,)h(the)f(guard)g
(function)f(is)g(e)o(v)o(aluated.)17 b(This)9 b Fq(for)n(cing)75
1136 y Fy(is)i(recursi)o(v)o(e,)j(since)d(a)i(guard)f(function)f(might)f
(return)i(a)h(guard)f(e)o(v)o(ent.)18 b(When)12 b(a)h(combinator)n(,)e(such)h
(as)g Fp(wrap)p Fy(,)75 1204 y(is)g(applied)f(to)h(a)g(guard)g(e)o(v)o(ent,)h
(the)e(suspension)g(is)g(just)g(pulled)h(up)f(one)h(le)o(v)o(el.)19
b(F)o(or)13 b(e)o(xample,)g(the)e(guard)h(case)75 1272 y(of)f(the)h
Fp(wrap)f Fy(implementation)e(is)146 1364 y FA(fun)21 b(wrap)g(\(GUARD)f(g,)i
(f\))f(=)h(GUARD)e(\(fn\(\))h(=>)g(wrap\(g\(\),)f(f\)\))189
1413 y(|)i(wrap)f(...)75 1523 y Fy(where)8 b Fp(GUARD)g Fy(is)f(the)h
(internal)f(representation')m(s)h(constructor)g(for)g(guard)g(e)o(v)o(ents.)
15 b(The)8 b(application)f(of)h Fp(choose)75 1591 y Fy(to)j(a)h(guard)f(e)o
(v)o(ent)h(is)e(a)i(little)e(more)h(trick)o(y)m(,)h(since)f(multiple)f
(guards)h(may)g(be)h(in)n(v)o(olv)o(ed.)146 1679 y(The)f(most)f(dif)o
(\256cult)i Fx(CML)g Fy(feature)g(to)f(support)g(is)g Fp(wrapAbort)p
Fy(.)16 b(If)c Fp(wrapAbort)e Fy(is)h(applied)g(to)g(a)h(choice)75
1747 y(of)h(se)o(v)o(eral)h(e)o(v)o(ents,)f(then,)h(at)f(synchronization)f
(time,)h(we)g(must)f(in)n(v)o(oke)g(the)h(abort)g(function)f(if,)h(and)g
(only)g(if,)75 1815 y(none)e(of)g(the)f(e)o(v)o(ents)h(was)g(selected.)17
b(W)l(e)11 b(handle)g(this)f(by)h(supplying)e(an)i(abort)f(function)h(for)g
(each)g(element)g(of)75 1883 y(the)e(choice,)i(with)d(one)i(designated)e(as)i
(the)f Fq(leader)p Fy(.)16 b(When)10 b(in)n(v)o(oked,)f(the)g(other)g(abort)h
(threads)f(send)g(the)g(leader)75 1950 y(a)k(message;)g(if)g(the)f(leader)i
(collects)e(messages)g(from)h(all)f(of)h(the)g(other)f(threads,)i(then)e(it)g
(e)o(v)o(aluates)h(the)f(abort)75 2018 y(function.)k(The)c(abort)f(function)f
(will)h(be)g(e)o(v)o(aluated)g(if,)h(and)g(only)e(if,)i(all)f(of)g(the)h
(abort)f(threads)g(are)h(in)n(v)o(oked.)146 2107 y(The)g(implementation)e
(consists)h(of)h(about)f(1,380)h(lines)g(of)g(commented)f(code.)20
b(This)11 b(breaks)i(do)o(wn)e(into:)75 2174 y(810)e(lines)f(to)h(implement)e
(threads,)j(channels,)g(e)o(v)o(ents,)g(lo)o(w-le)o(v)o(el)e(I/O)h(support)f
(and)i(pre-empti)o(v)o(e)e(scheduling;)75 2242 y(430)h(lines)g(to)g
(implement)f(the)h(stream)h(I/O)f(library;)h(and)g(140)f(lines)g(to)g(handle)
g(initialization)e(and)j(termination.)75 2310 y(In)h(addition,)g(there)h(is)f
(a)g(small)g(library)g(of)g(useful)g(abstractions,)g(such)g(as)h(b)o(uf)o
(fered)g(channels.)75 2474 y Fz(5)58 b(P)o(erf)o(ormance)75
2610 y Fy(Pro)o(viding)13 b(a)h(better)g(notation)e(for)i(programming)e(is)h
(not)g(enough;)h(it)f(must)g(be)h(ef)o(\256cient)g(enough)f(that)g(users)75
2677 y(will)h(be)h(willing)f(to)g(write)h(major)g(systems)f(in)g(it.)28
b(T)l(o)15 b(a)g(great)h(e)o(xtent,)g Fx(SML/NJ)f Fy(has)g(met)g(this)f(goal)
h(as)g(an)952 2802 y(15)p eop
%%Page: 16 16
16 15 bop 75 82 a Fy(implementation)9 b(of)i(a)g(high-le)o(v)o(el)g
(language[AJ89)o(].)17 b(Our)11 b(benchmark)g(results)g(sho)o(w)f(that)h
Fx(CML)g Fy(maintains)75 150 y(this)f(standard.)75 293 y Fu(5.1)50
b(The)13 b(benchmarks)75 413 y Fy(W)l(e)g(ha)o(v)o(e)g(conducted)f(a)h
(series)f(of)g(benchmarks)g(on)g(three)h(dif)o(ferent)g(machines)e(\(see)i
(table)f(2\).)20 b(Each)13 b(bench-)p 313 468 1314 2 v 312
518 2 50 v 321 518 V 450 503 a Fl(Machine)p 731 518 V 200 w(Pr)o(ocessor)p
1046 518 V 98 w(Memory)p 1248 518 V 50 w(Operating)d(System)p
1617 518 V 1626 518 V 313 520 1314 2 v 312 569 2 50 v 321 569
V 346 555 a Fk(SP)l(ARCstation)f(1)p 731 569 V 141 w(20MHz)h(SP)l(ARC)p
1046 569 V 76 w(28Mb)p 1248 569 V 130 w(SunOS)g(4.1.1)p 1617
569 V 1626 569 V 313 571 1314 2 v 312 621 2 50 v 321 621 V
346 606 a(Sun)g(4/490)p 731 621 V 240 w(33MHz)g(SP)l(ARC)p
1046 621 V 76 w(32Mb)p 1248 621 V 130 w(SunOS)g(4.0.3)p 1617
621 V 1626 621 V 313 623 1314 2 v 312 672 2 50 v 321 672 V
346 657 a(DECstation)g(5000/200)p 731 672 V 56 w(25MHz)g(R3000)p
1046 672 V 83 w(16Mb)p 1248 672 V 130 w(UL)l(TRIX)h(4.1)p 1617
672 V 1626 672 V 313 674 1314 2 v 696 720 a Fy(T)l(able)h(2:)k(Benchmark)c
(machines)75 826 y(marked)g(operation)g(was)f(performed)i(100)p
Fi(;)8 b Fy(000)i(times;)i(the)g(loops)f(were)i(unrolled)f(ten)g(times)f(to)h
(reduce)h(loop)75 894 y(o)o(v)o(erhead.)k(F)o(or)10 b(each)g(benchmark,)h(we)
e(gi)o(v)o(e)h(the)f(combined)f(user)i(and)f(system)f(CPU)j(time)d(and)i(the)
f(time)g(spent)75 962 y(garbage)k(collecting.)21 b(All)12 b(times)g(are)i(in)
e(micro-seconds.)21 b(The)13 b(benchmarks)f(were)i(run)f(using)e(v)o(ersion)i
(0.67)75 1029 y(of)e Fx(SML/NJ)h Fy(and)g(v)o(ersion)f(0.9.3)h(of)f
Fx(CML)p Fy(.)146 1118 y(The)g(\256rst)g(set)h(of)f(benchmarks)g(\(see)h
(table)f(3\))h(measures)f(the)g(cost)g(of)h(some)e(basic)i(operations:)p
164 1175 1612 2 v 163 1225 2 50 v 172 1225 V 259 1210 a Fl(Operation)p
528 1225 V 211 w(SP)m(ARC)f(1)p 941 1225 V 242 w(Sun)g(4/490)p
1354 1225 V 233 w(DEC)f(5000)p 1766 1225 V 1775 1225 V 163
1275 V 172 1275 V 528 1275 V 528 1275 V 554 1260 a Fk(time)g(\()p
Fj(\026S)r Fk(\))50 b(GC)10 b(\()p Fj(\026S)r Fk(\))p 941 1275
V 50 w(time)h(\()p Fj(\026S)r Fk(\))50 b(GC)10 b(\()p Fj(\026S)r
Fk(\))p 1354 1275 V 50 w(time)h(\()p Fj(\026S)r Fk(\))50 b(GC)10
b(\()p Fj(\026S)r Fk(\))p 1766 1275 V 1775 1275 V 164 1276
1612 2 v 163 1326 2 50 v 172 1326 V 197 1311 a(Null)f(function)g(call)p
528 1326 V 175 w(1)p Fj(:)p Fk(9)177 b(0)p 941 1326 V 161 w(1)p
Fj(:)p Fk(0)g(0)p 1354 1326 V 161 w(0)p Fj(:)p Fk(7)g(0)p 1766
1326 V 1775 1326 V 164 1328 1612 2 v 163 1378 2 50 v 172 1378
V 197 1363 a(Thread)11 b(switch)p 528 1378 V 243 w(26)177 b(8)p
941 1378 V 173 w(13)g(4)p 1354 1378 V 193 w(8)h(7)p 1766 1378
V 1775 1378 V 164 1379 1612 2 v 163 1429 2 50 v 172 1429 V
197 1414 a(Thread)11 b(spa)o(wn/e)o(xit)p 528 1429 V 173 w(85)156
b(13)p 941 1429 V 173 w(38)177 b(7)p 1354 1429 V 173 w(22)156
b(12)p 1766 1429 V 1775 1429 V 164 1431 1612 2 v 163 1481 2
50 v 172 1481 V 197 1466 a(Rendezv)o(ous)p 528 1481 V 278 w(94)g(19)p
941 1481 V 173 w(45)g(12)p 1354 1481 V 173 w(27)g(18)p 1766
1481 V 1775 1481 V 164 1482 1612 2 v 163 1532 2 50 v 172 1532
V 197 1517 a(Ev)o(ent)11 b(rendezv)o(ous)p 528 1532 V 164 w(163)156
b(24)p 941 1532 V 173 w(77)g(14)p 1354 1532 V 173 w(44)g(22)p
1766 1532 V 1775 1532 V 164 1534 1612 2 v 516 1580 a Fy(T)l(able)12
b(3:)k(Basic)c(concurrenc)o(y)g(operation)f(benchmarks)75 1730
y Fx(Null)g(function)i(call)22 b Fy(This)10 b(measures)g(the)g(time)g
(required)h(to)f(call)g(the)g(null)g(function;)f(this)h(operation)g(is)g
(about)189 1786 y(12)15 b(instructions)f(on)h(the)g(SP)l(ARC.)j(Because)e(of)
g(the)g(compiler)e(technology)h(used)g(by)h Fx(SML/NJ)23 b
Fy(the)189 1843 y(cost)10 b(of)h(this)f(operation)g(depends)g(hea)o(vily)g
(on)h(the)f(calling)h(conte)o(xt;)f(if)h(there)g(are)g(man)o(y)g(re)o
(gisters)g(to)f(be)189 1899 y(sa)o(v)o(ed,)i(then)f(the)g(cost)g(will)g(be)g
(higher)m(.)75 1989 y Fx(Thr)o(ead)i(switch)23 b Fy(This)11
b(measures)g(the)g(cost)g(of)h(an)f(e)o(xplicit)g(conte)o(xt)g(switch.)75
2078 y Fx(Thr)o(ead)i(spawn/exit)23 b Fy(This)10 b(measures)g(the)h(time)e
(it)h(takes)g(to)g(spa)o(wn)h(and)f(run)h(a)g(null)e(thread,)j(which)e
(includes)189 2135 y(the)g(cost)g(of)h(two)f(conte)o(xt)g(switches)g(\(the)h
Fp(spawn)f Fy(operation)g(switches)g(control)g(to)g(the)h(ne)o(wly)f(spa)o
(wned)189 2191 y(thread)h(and)h(a)f(terminating)f(thread)i(must)e(dispatch)h
(a)g(ne)o(w)h(thread\).)75 2281 y Fx(Rendezvous)24 b Fy(This)10
b(measures)i(the)f(cost)g(of)g(a)h Fp(send)p Fy(/)p Fp(accept)e
Fy(rendezv)o(ous)h(between)h(two)e(threads.)75 2370 y Fx(Event)i(r)o
(endezvous)24 b Fy(This)7 b(is)g(an)g(implementatio)o(n)g(of)g(th)o(e)g
(rendezv)o(ous)g(benchmark)g(usi)o(ng)g Fp(tran)o(smit)p Fy(/)p
Fp(r)o(eceive)189 2427 y Fy(and)k Fp(sync)p Fy(.)146 2542 y(The)g(second)h
(set)f(\(see)h(table)g(4\))g(measures)f(the)h(cost)f(of)h(se)o(v)o(eral)g
(dif)o(ferent)f(implementations)f(of)h(a)h(simple)75 2610 y(service.)17
b(The)12 b(simple)e(service)i(is)f(essentially)f(a)h(memory)g(cell;)g(a)h
(transaction)f(sets)g(a)g(ne)o(w)h(v)o(alue)f(and)g(returns)75
2677 y(the)g(old)g(v)o(alue.)17 b(The)11 b(implementations)e(are:)952
2802 y(16)p eop
%%Page: 17 17
17 16 bop 218 92 1514 2 v 217 142 2 50 v 226 142 V 265 127
a Fl(Operation)p 484 142 V 161 w(SP)m(ARC)11 b(1)p 897 142
V 242 w(Sun)g(4/490)p 1310 142 V 234 w(DEC)f(5000)p 1723 142
V 1732 142 V 217 192 V 226 192 V 484 192 V 484 192 V 510 177
a Fk(time)g(\()p Fj(\026S)r Fk(\))50 b(GC)10 b(\()p Fj(\026S)r
Fk(\))p 897 192 V 51 w(time)g(\()p Fj(\026S)r Fk(\))50 b(GC)10
b(\()p Fj(\026S)r Fk(\))p 1310 192 V 51 w(time)g(\()p Fj(\026S)r
Fk(\))50 b(GC)10 b(\()p Fj(\026S)r Fk(\))p 1723 192 V 1732
192 V 218 193 1514 2 v 217 243 2 50 v 226 243 V 251 228 a(function)f(call)p
484 243 V 162 w(4)p Fj(:)p Fk(8)176 b(0)p 897 243 V 161 w(2)p
Fj(:)p Fk(3)h(0)p 1310 243 V 161 w(1)p Fj(:)p Fk(5)g(0)p 1723
243 V 1732 243 V 218 245 1514 2 v 217 295 2 50 v 226 295 V
251 280 a(RPC)p 484 295 V 282 w(197)156 b(35)p 897 295 V 173
w(92)g(20)p 1310 295 V 173 w(54)g(32)p 1723 295 V 1732 295
V 218 296 1514 2 v 217 346 2 50 v 226 346 V 251 331 a(e)o(v)o(ent)11
b(RPC)p 484 346 V 183 w(252)156 b(35)p 897 346 V 152 w(117)g(20)p
1310 346 V 173 w(68)g(33)p 1723 346 V 1732 346 V 218 348 1514
2 v 652 444 a Fy(T)l(able)12 b(4:)k(RPC)d(protocol)d(benchmarks)75
578 y Fx(Function)i(call)23 b Fy(This)12 b(is)g(the)g(sequential)g
(implementation,)f(which)h(uses)g(an)h(o)o(wn)f(v)o(ariable)h(to)f(keep)g
(track)h(of)189 635 y(the)e(state)g(between)h(calls.)75 729
y Fx(RPC)23 b Fy(This)10 b(uses)h(a)h(request/reply)f(e)o(xchange)h
(implemented)e(using)g Fp(send)h Fy(and)g Fp(accept)p Fy(.)75
823 y Fx(Event)h(RPC)23 b Fy(This)10 b(implements)g(the)h(request/reply)g(e)o
(xchange)h(as)f(an)h(e)o(v)o(ent)f(v)o(alue.)75 968 y Fu(5.2)50
b(Garbage)12 b(collection)f(overhead)75 1088 y Fy(The)20 b(high)g(garbage)h
(collection)e(o)o(v)o(erhead)i(in)f(these)h(benchmarks)f(is)f(mostly)g(a)i
(result)f(of)g(the)g(way)g(the)75 1155 y(current)10 b Fx(SML/NJ)g
Fy(collector)n(,)g(which)f(is)f(a)i(simple)e(generational)h(collector)n(,)h
(keeps)f(track)h(of)f(inter)o(generational)75 1223 y(references)261
1209 y Fw([App89])375 1223 y Fy(.)28 b(Each)15 b(time)g(a)g(mutable)f(object)
h(is)f(updated,)i(a)g(record)f(of)h(that)e(update)h(is)f(added)i(to)e(the)75
1291 y Fq(stor)n(e-list)p Fy(.)h(This)10 b(store)g(list)f(is)h(e)o(xamined)h
(for)f(potential)f(roots)h(at)h(the)f(be)o(ginning)f(of)i(each)g(garbage)f
(collection.)75 1358 y(The)k(implementation)d(of)j Fx(CML)g
Fy(uses)f(a)h(small)e(number)h(of)h(v)o(ery)g(frequently)f(updated)h
(objects:)19 b(the)14 b(thread)75 1426 y(ready)h(queue,)h(current)g(thread)f
(pointer)f(and)h(channel)g(waiting)e(queues.)27 b(This)14 b(\252hot-spot\272)
g(beha)o(vior)h(is)f(the)75 1494 y(worst-case)j(scenario)f(for)h
Fx(SML/NJ)p Fy(')m(s)h(collector)n(,)g(destroying)e(the)g Fi(O)q
Fc(\()p Fr(j)p Fy(LIVE)o Fr(j)p Fc(\))g Fy(normally)g(e)o(xpected)h(from)75
1562 y(copying)9 b(collection.)15 b(The)10 b(collector)g(also)g(suf)o(fers)g
(from)g(the)g(problem)f(of)h(poor)g(\252real-time\272)g(responsi)o(v)o
(eness.)146 1650 y(W)l(e)j(ha)o(v)o(e)h(designed)e(a)h(ne)o(w)m(,)h
(multi-generational,)e(collector)g(for)h Fx(SML/NJ)1388 1636
y Fw([Rep])1464 1650 y Fy(,)h(which)e(uses)h(the)g(page-)75
1718 y(protection)f(techniques)h(of)g([Sha87])h(and)f([AEL88)o(])h(to)e
(implement)g(the)h(write)g(barrier)m(.)23 b(This)12 b(ne)o(w)h(collector)75
1786 y(impro)o(v)o(es)8 b(the)h(performance)h(of)f Fx(CML)g
Fy(in)f(two)g(ways:)15 b(the)8 b(hot-spot)g(update)g(beha)o(vior)h(only)f
(incurs)h(a)g(constant)75 1853 y(cost)g(for)g(garbage)h(collection)e(and)h
(eliminating)e(the)i(store-list)f(reduces)i(the)f(frequenc)o(y)h(of)f
(garbage)h(collection)75 1921 y(and)15 b(the)f(cost)g(of)h(update)f
(operations.)26 b(An)15 b(instruction)e(count)h(analysis)f(predicts)i(a)g
(25\045)f(reduction)g(in)g(the)75 1989 y(cost)g(of)g(a)h Fx(CML)g
Fy(conte)o(xt)f(switch.)26 b(Unfortunately)m(,)14 b(at)h(the)f(time)g(of)g
(this)g(writing)f(\(March)i(1991\),)g(the)f(ne)o(w)75 2057
y(collector)d(is)g(not)g(stable)g(enough)g(to)g(run)g(the)g
Fx(CML)h Fy(benchmarks.)75 2202 y Fu(5.3)50 b(Analysis)75 2322
y Fy(W)l(e)14 b(ha)o(v)o(e)f(noticed)f(a)h(discrepanc)o(y)g(between)g(the)g
(measured)g(times)f(and)g(instruction)f(counts)h(on)h(the)g(SP)l(ARC)75
2389 y(processors.)27 b(F)o(or)16 b(e)o(xample;)g(a)g Fx(CML)f
Fy(thread)g(switch)f(takes)h(about)f(100)g(instructions,)h(which)f(suggests)g
(an)75 2457 y(a)o(v)o(erage)k(of)e Fr(\030)p Fy(5)h(c)o(ycles)f(per)h
(instruction)e(\(CPI\))i(on)f(the)g(SP)l(ARCstation)h(1.)31
b(The)17 b(SP)l(ARCstation)f(1)h(has)f(a)75 2525 y(write-through)e(cache,)k
(which)d(we)h(suspect)e(is)h(causing)g(this)f(high)h(CPI)h(\256gure.)29
b(F)o(or)16 b(the)f(DECstation,)h(the)75 2593 y(number)11 b(is)g(around)g(2)g
(CPI,)i(which)e(seems)g(more)g(reasonable.)952 2802 y(17)p
eop
%%Page: 18 18
18 17 bop 146 82 a Fy(The)19 b(measurements)f(sho)o(w)g(that)h(the)g(penalty)
f(for)i(using)e(abstract)h(interfaces)g(\(i.e.,)j(hiding)c(channel)75
150 y(communication)10 b(in)i(e)o(v)o(ent)g(v)o(alues\))g(is)f(acceptable.)19
b(T)l(able)13 b(5)f(gi)o(v)o(es)f(the)h(ratio)g(between)g(the)g(non-GC)g
(time)f(of)75 218 y(the)f(e)o(v)o(ent)h(v)o(ersion)f(and)g(the)g(non-e)o(v)o
(ent)g(v)o(ersion)g(of)h(the)f(two)f(communication)g(protocols)g(we)i
(benchmarked.)p 539 279 862 2 v 538 329 2 50 v 547 329 V 630
314 a Fl(Machine)p 866 329 V 108 w(Event)e(cost)i(:)k(non-e)o(vent)10
b(cost)p 1391 329 V 1400 329 V 538 379 V 547 379 V 866 379
V 892 364 a Fk(Rendezv)o(ous)122 b(RPC)p 1391 379 V 1400 379
V 539 380 862 2 v 538 430 2 50 v 547 430 V 572 415 a(SP)l(ARCstation)9
b(1)p 866 430 V 86 w(1)p Fj(:)p Fk(73)h(:)h(1)p 1118 430 V
134 w(1)p Fj(:)p Fk(27)f(:)h(1)p 1391 430 V 1400 430 V 539
432 862 2 v 538 482 2 50 v 547 482 V 572 467 a(Sun)f(4/490)p
866 482 V 185 w(1)p Fj(:)p Fk(71)g(:)h(1)p 1118 482 V 134 w(1)p
Fj(:)p Fk(27)f(:)h(1)p 1391 482 V 1400 482 V 539 483 862 2
v 538 533 2 50 v 547 533 V 572 518 a(DEC)g(5000/200)p 866 533
V 103 w(1)p Fj(:)p Fk(62)f(:)h(1)p 1118 533 V 134 w(1)p Fj(:)p
Fk(25)f(:)h(1)p 1391 533 V 1400 533 V 539 535 862 2 v 721 582
a Fy(T)l(able)g(5:)16 b(Cost)c(of)f(abstraction)146 711 y(These)d(numbers)f
(demonstrate)g(that)h(we)g(can)h(b)o(uild)e(real)i(system)e(software)g(using)
g(our)h(high-le)o(v)o(el)g(notation,)75 779 y(without)h(paying)i(an)g
(unacceptable)g(performance)g(penalty)m(.)17 b(W)n(ith)10 b(specialized)h
(compiler)f(support,)g(such)h(as)g(a)75 847 y(dedicated)g(re)o(gister)h(for)g
(the)f(thread)g(ready)h(queue,)g(performance)g(would)e(impro)o(v)o(e)i
(substantially)m(.)75 992 y Fu(5.4)50 b(Comparison)12 b(with)g(the)g
Fb(\026)p Fu(System)75 1112 y Fy(Lastly)m(,)e(to)g(put)g(our)h(measurements)e
(into)h(perspecti)o(v)o(e,)h(we)g(implemented)e(a)i(similar)e(\(allo)o(wing)g
(for)i(linguistic)75 1180 y(dif)o(ferences\))h(set)f(of)g(benchmarks)f(in)h
(the)g Fi(\026)p Fx(System)p Fy(,)h(which)f(is)f(a)i Fx(C)f
Fy(light-weight)e(process)i(library)1692 1165 y Fw([BS90)o(])1788
1180 y Fy(.)16 b(W)l(e)75 1247 y(ran)11 b(these)f(benchmarks)f(on)h(the)g
(same)g(machines;)g(the)g(results)g(are)h(reported)f(in)g(table)g(6.)16
b(The)10 b(times)f(are)i(gi)o(v)o(en)p 446 1309 1048 2 v 445
1359 2 50 v 454 1359 V 479 1344 a Fl(Operation)p 813 1359 V
397 w(T)o(ime)f(\()p Fj(\026S)r Fl(\))p 1484 1359 V 1493 1359
V 445 1408 V 454 1408 V 813 1408 V 839 1393 a(SP)m(ARC)h(1)49
b(Sun)11 b(4/490)48 b(DEC)10 b(5000)p 1484 1408 V 1493 1408
V 446 1410 1048 2 v 445 1460 2 50 v 454 1460 V 479 1445 a Fk(Null)g(function)
e(call)p 813 1460 V 180 w(0)p Fj(:)p Fk(3)p 1029 1460 V 170
w(0)p Fj(:)p Fk(2)p 1253 1460 V 177 w(0)p Fj(:)p Fk(4)p 1484
1460 V 1493 1460 V 446 1461 1048 2 v 445 1511 2 50 v 454 1511
V 479 1496 a(T)m(ask)j(switch)p 813 1511 V 267 w(131)p 1029
1511 V 149 w(54)p Fj(:)p Fk(3)p 1253 1511 V 177 w(9)p Fj(:)p
Fk(6)p 1484 1511 V 1493 1511 V 446 1513 1048 2 v 445 1563 2
50 v 454 1563 V 479 1548 a(T)m(ask)g(create)p 813 1563 V 278
w(371)p 1029 1563 V 161 w(126)p 1253 1563 V 156 w(40)p Fj(:)p
Fk(0)p 1484 1563 V 1493 1563 V 446 1564 1048 2 v 445 1614 2
50 v 454 1614 V 479 1599 a(Send/recei)o(v)o(e)p 813 1614 V
252 w(292)p 1029 1614 V 161 w(119)p 1253 1614 V 156 w(27)p
Fj(:)p Fk(7)p 1484 1614 V 1493 1614 V 446 1616 1048 2 v 445
1666 2 50 v 454 1666 V 479 1651 a(Send/recei)o(v)o(e/reply)p
813 1666 V 154 w(308)p 1029 1666 V 161 w(123)p 1253 1666 V
156 w(28)p Fj(:)p Fk(4)p 1484 1666 V 1493 1666 V 446 1667 1048
2 v 694 1714 a Fy(T)l(able)g(6:)16 b Fi(\026)p Fx(System)d
Fy(benchmarks)75 1831 y(in)g(micro-seconds)h(and)f(represent)i(the)e(sum)g
(of)h(the)g(user)g(and)f(system)g(CPU)i(times;)f(ob)o(viously)e(there)i(is)f
(no)75 1899 y(garbage)f(collection)f(o)o(v)o(erhead.)19 b(Ev)o(en)12
b(though)f(the)g Fi(\026)p Fx(System)i Fy(pro)o(vides)e(a)h(lo)o(wer)o(-le)o
(v)o(el)g(concurrenc)o(y)h(model)75 1967 y(\(no)h(selecti)o(v)o(e)g
(communication,)g(for)h(e)o(xample\),)g(and)g(is)e(implemented)g(in)h(a)h(lo)
o(wer)o(-le)o(v)o(el)f(language,)h Fx(CML)75 2034 y Fy(pro)o(vides)d(as)g
(good)f(or)h(better)g(performance.)19 b(This)11 b(sho)o(ws)g(that)h(we)g(can)
g(ha)o(v)o(e)h(the)f(adv)o(antages)g(of)g(the)f(higher)75 2102
y(le)o(v)o(el)g(language)h(without)e(sacri\256cing)h(performance;)h(a)g(rare)
g(situation)e(indeed.)75 2269 y Fz(6)58 b(Related)15 b(w)o(ork)75
2405 y Fy(There)20 b(are)g(man)o(y)f(approaches)h(to)f(concurrent)h(language)
f(design)g(\(see)g([AS83)q(])g(for)h(an)f(o)o(v)o(ervie)o(w\);)24
b(our)75 2473 y(approach)c(is)f(an)g(of)o(fshoot)f(of)i(the)f
Fx(CSP)p Fy(-school)g(of)g(concurrent)h(language)f(design.)40
b Fx(CML)20 b Fy(be)o(gan)f(as)h(a)75 2541 y(reimplementation)11
b(of)h(the)g(concurrenc)o(y)i(primiti)o(v)o(es)c(of)j Fx(PML)1113
2526 y Fw([Rep88)o(])1235 2541 y Fy(in)f Fx(SML/NJ)p Fy(,)h(b)o(ut)f(has)g(e)
o(v)o(olv)o(ed)g(into)g(a)75 2608 y(signi\256cantly)e(more)g(po)o(werful)h
(language.)17 b Fx(PML)11 b Fy(in)g(turn)f(was)h(hea)o(vily)f(in\257uenced)h
(by)g Fx(amber)1637 2594 y Fw([Car86])1741 2608 y Fy(.)17 b(There)75
2676 y(ha)o(v)o(e)11 b(been)f(other)f(attempts)g(at)h(adding)f(concurrenc)o
(y)i(to)e(v)o(arious)h(v)o(ersions)f(of)h Fx(ML)p Fy(.)h(Most)e(of)h(these)f
(ha)o(v)o(e)i(been)952 2802 y(18)p eop
%%Page: 19 19
19 18 bop 75 82 a Fy(based)13 b(on)g(message)h(passing)e(\([Hol83)o(],)j
([Mat89)o(],)g(and)e([Ram90])h(for)g(e)o(xample\),)g(b)o(ut)f(there)h(is)f
(at)g(least)g(one)75 150 y(shared)g(memory)f(approach)539 136
y Fw([CM90)o(])646 150 y Fy(.)20 b(As)13 b(we)g(ha)o(v)o(e)g(sho)o(wn)e(in)i
(this)e(paper)n(,)j(message)e(passing)g(\256ts)g(v)o(ery)h(nicely)75
218 y(into)i Fx(SML)p Fy(.)j(It)e(allo)o(ws)g(an)g(applicati)o(v)o(e)g(style)
f(of)i(programming)e(to)h(be)g(used)g(most)f(of)h(the)h(time;)g(the)f(state)
75 285 y(modifying)9 b(operations)g(are)i(hidden)f(in)g(the)g(thread)h(and)f
(channel)g(abstractions.)16 b Fx(CML)11 b Fy(e)o(xtends)f(the)g(message)75
353 y(passing)j(paradigm)g(by)g(making)g(synchronous)f(operations)h
(\256rst-class,)i(which)e(pro)o(vides)g(a)h(mechanism)f(for)75
421 y(b)o(uilding)e(user)o(-de\256ned)i(synchronization)e(abstractions.)19
b(While)12 b(this)f(idea)i(was)f(\256rst)g(proposed)g(in)g([Rep88],)75
489 y(we)g(ha)o(v)o(e)g(made)f(se)o(v)o(eral)h(signi\256cant)f(impro)o(v)o
(ements:)143 603 y Fr(\017)23 b Fx(CML)17 b Fy(impro)o(v)o(es)g(the)h
Fp(event)e Fy(type)h(in)g(se)o(v)o(eral)h(ways.)34 b(The)17
b Fp(poll)g Fy(operation)g(pro)o(vides)g(a)g(cleaner)189 660
y(semantics)7 b(than)g(the)g Fx(PML)g Fy(polling)g(mechanism,)e(and)i(the)g
Fp(wrapHandler)g Fy(operation)g(pro)o(vides)g(needed)189 716
y(support)17 b(for)h(writing)f(wrappers.)37 b(The)18 b Fp(guard)f
Fy(and)h Fp(wrapAbort)f Fy(operations)g(are)i(important)d(ne)o(w)189
773 y(features)c(that)e(allo)o(w)h(substantially)e(more)j(sophisticated)e
(protocols)g(to)h(be)g(implemented)f(as)i(e)o(v)o(ents.)143
866 y Fr(\017)23 b Fy(Because)11 b Fx(CML)h Fy(is)e(implemented)f(in)h
Fx(SML)p Fy(,)i(objects)e(such)h(as)f(threads,)i(channels)e(and)h(the)f
(scheduling)189 923 y(queue)g(are)h(heap)f(allocated.)16 b(This)9
b(has)h(two)g(adv)o(antages:)15 b(threads)10 b(cannot)g(o)o(v)o(er\257o)o(w)g
(\256x)o(ed-size)h(stacks)189 979 y(\(a)j(common)g(problem)f(in)h(man)o(y)g
(thread)g(packages\),)i(and)f(the)f(memory)f(resources)i(used)f(by)g(threads)
189 1036 y(and)d(channels)h(are)g(reclaimed)g(by)g(the)f(garbage)h(collector)
m(.)18 b(The)12 b(latter)g(is)f(hea)o(vily)g(e)o(xploited)g(in)g
Fx(CML)189 1092 y Fy(programs)g(\(see)g(section)g(2.2\).)143
1186 y Fr(\017)23 b Fx(CML)13 b Fy(threads)f(are)h(signi\256cantly)e(lighter)
o(-weight)h(than)g(those)f(of)i(most)e(threads)i(packages.)20
b(Because)189 1242 y(the)10 b(memory)f(o)o(v)o(erhead)i(of)f
Fx(CML)h Fy(threads)f(is)f(v)o(ery)i(small)e(\(tens)h(of)g(bytes)f(compared)h
(to)g(kilo-bytes)f(for)189 1299 y Fx(PML)p Fy(\),)j(a)g(more)f(pro\257igate)g
(use)h(of)f(threads)g(is)g(possible.)143 1393 y Fr(\017)23
b Fx(CML)12 b Fy(pro)o(vides)f(inte)o(grated)g(support)f(for)i(both)f(lo)o
(w-le)o(v)o(el)f(and)i(stream-based)f(I/O.)146 1519 y(Our)g(implementation)e
(techniques)h(are)i(not)f(particularly)g(no)o(v)o(el.)17 b(The)11
b(use)g(of)h(timers)e(to)h(implement)e(pre-)75 1586 y(emption)e(is)h(an)g
(old)g(technique)g(used)g(by)g(most)f(threads)i(packages,)g(and)g(the)f(use)g
(of)h(\256rst-class)f(continuations)e(to)75 1654 y(implement)h(concurrenc)o
(y)j(goes)f(back,)h(at)f(least,)g(to)f([W)l(an80)q(].)16 b(A)9
b(number)f(of)h(papers)g(ha)o(v)o(e)h(been)f(published)e(on)75
1722 y(the)12 b(use)h(of)f(\256rst-class)h(continuations)d(to)i(implement)f
(concurrenc)o(y)j(in)e Fx(scheme)h Fy(\(e.g.,)i([W)l(an80],)e([HFW84)q(])75
1790 y(and)h([DH89]\),)i(b)o(ut)e(we)h(break)g(ne)o(w)g(ground)e(in)i(a)f
(couple)h(of)f(ways:)22 b(we)15 b(describe)f(the)h(implementation)d(of)75
1857 y(\256rst-class)f(synchronous)f(operations)h(using)f(\256rst-class)i
(continuations;)d(we)i(describe)h(a)f(complete)g(language)75
1925 y(for)i(concurrent)h(programming)e(and)h(its)f(use;)i(and)f(we)h(pro)o
(vide)f(performance)g(\256gures.)23 b(The)13 b(one)g(published)75
1993 y(application)i(of)i(continuation-based)e(concurrenc)o(y)j(in)e
Fx(scheme)h Fy(\(which)g(we)g(kno)o(w)f(of\))g(claims)g(that)g(most)75
2061 y Fx(scheme)i Fy(implementations)d(do)i(not)g(implement)e(continuations)
h(ef)o(\256ciently)h(enough)g(to)g(support)f(this)g(use)75
2128 y(of)g(concurrenc)o(y)353 2114 y Fw([Haa90])479 2128 y
Fy(\(the)g(techniques)f(of)h([HDB90])g(may)g(address)g(this)f(problem\).)29
b(Our)16 b(performance)75 2196 y(numbers)11 b(and)g(e)o(xperience)i
(\252in-the-\256eld\272)e(suggest)g(that)g(the)g(opposite)f(is)h(true)g(for)h
Fx(CML)p Fy(.)146 2285 y(Using)i(concurrenc)o(y)i(to)e(implement)f(interacti)
o(v)o(e)i(systems)f(has)h(been)g(proposed)f(and)h(implemented)e(by)75
2352 y(se)o(v)o(eral)k(people.)31 b(In)16 b([RG86])h(we)f(made)h(the)f(ar)o
(gument)g(that)f(concurrenc)o(y)j(is)d(vital)h(for)g(the)g(construction)75
2420 y(of)i(interacti)o(v)o(e)f(programming)f(en)n(vironments.)35
b([Pik89)o(])18 b(and)g([Haa90])g(describe)g(e)o(xperimental)f(windo)o(w)75
2488 y(systems)10 b(b)o(uilt)g(out)h(of)g(threads)h(and)f(channels,)h(b)o(ut)
f(neither)g(of)g(these)h(were)g(fast)f(enough)f(for)i(real)g(use.)952
2802 y(19)p eop
%%Page: 20 20
20 19 bop 75 82 a Fz(7)58 b(Conclusions)75 218 y Fy(W)l(e)16
b(ha)o(v)o(e)g(described)g(a)f(higher)o(-order)h(concurrent)g(language,)g
Fx(CML)p Fy(,)h(and)e(its)g(use)g(in)g(real-world)g(applica-)75
286 y(tions.)i Fx(CML)12 b Fy(supports)f(\256rst-class)g(synchronous)g
(operations,)h(which)f(pro)o(vide)g(a)i(po)o(werful)e(mechanism)g(for)75
353 y(communication)f(and)h(synchronization)f(abstraction.)17
b(Our)11 b(e)o(xperience)i(with)e Fx(CML)h Fy(\252in-the-\256eld\272)g(and)f
(our)75 421 y(measurements)16 b(of)g(the)h(performance)g(of)f(the)h
(implementation)d(sho)o(w)i(that)g Fx(CML)h Fy(is)f(a)g(practical)h(tool)f
(for)75 489 y(b)o(uilding)9 b(real)i(systems.)k(W)l(e)c(feel)g(that)f
Fx(CML)h Fy(is)e(unique)h(in)g(that)g(it)g(combines)f(a)i(\257e)o(xible)g
(high-le)o(v)o(el)e(notation)75 557 y(with)i(good)f(performance.)146
645 y Fx(CML)g Fy(is)f(a)h(stable)f(system,)g(and)h(is)f(freely)h(a)o(v)o
(ailable)f(for)h(distrib)o(ution.)k(The)c(latest)f(v)o(ersion)g(of)h(both)e
Fx(CML)75 713 y Fy(and)j(its)f(manual)g(are)h(a)o(v)o(ailable)g(via)f(anon)o
(ymous)g(ftp)g(from)h Fp(cs.cornell.edu)p Fy(;)d(for)j(more)g(information)e
(send)75 781 y(electronic)i(mail)g(to:)189 907 y Fp(cml-bugs@cs.cornell.edu)
75 1074 y Fz(Ackno)o(wledgements)75 1210 y Fy(The)g(work)g(on)g
Fx(eXene)h Fy(has)g(bene\256ted)f(greatly)g(from)g(the)g(contrib)o(utions)f
(of)h(Emden)g(Gansner;)g(in)g(the)g(form)g(of)75 1277 y(both)g(source)h(code)
g(and)g(suggestions.)17 b(T)n(im)12 b(T)m(eitelbaum)e(pro)o(vided)i(useful)f
(comments)g(on)h(v)o(arious)f(drafts)h(of)75 1345 y(this)e(paper)m(.)75
1506 y Fz(Refer)o(ences)75 1611 y Fk([AB86])79 b(Abramsk)o(y)m(,)12
b(S.)g(and)f(R.)g(Bornat.)17 b(P)o(ascal-m:)g(A)11 b(language)g(for)g
(loosely)f(coupled)h(distrib)o(uted)e(systems.)17 b(In)282
1661 y(Y)-5 b(.)11 b(P)o(aker)h(and)g(J.-P)-5 b(.)12 b(V)-5
b(erjus)12 b(\(eds.\),)g Fe(Distrib)o(uted)e(Computing)f(Systems)p
Fk(,)j(pp.)f(163\261189.)f(Academic)j(Press,)282 1711 y(Ne)o(w)e(Y)-5
b(ork,)10 b(N.Y)-5 b(.,)11 b(1986.)75 1786 y([AEL88])57 b(Appel,)17
b(A.)g(W)l(.,)h(J.)f(R.)f(Ellis,)h(and)f(K.)g(Li.)30 b(Real-time)16
b(concurrent)f(collection)g(on)h(stock)f(multiproces-)282 1835
y(sors.)25 b(In)13 b Fe(Pr)n(oceedings)i(of)e(the)h(SIGPLAN'88)g(Confer)n
(ence)g(on)g(Pr)n(ogr)o(amming)f(Language)f(Design)i(and)282
1885 y(Implementation)p Fk(,)8 b(June)j(1988,)f(pp.)g(11\26120.)75
1960 y([Agh86])65 b(Agha,)11 b(G.)17 b Fe(Actors:)f(A)c(Model)e(of)g(Concurr)
n(ent)h(Computation)d(in)i(Distrib)o(uted)f(Systems)p Fk(.)17
b(The)12 b(MIT)f(Press,)282 2010 y(Cambridge,)f(Mass.,)i(1986.)75
2084 y([AJ89])91 b(Appel,)11 b(A.)h(W)l(.)f(and)g(T)m(.)h(Jim.)17
b(Continuation-passing)o(,)9 b(closure-passing)h(style.)17
b(In)10 b Fe(Confer)n(ence)i(Recor)n(d)h(of)282 2134 y(the)e(16th)f(Annual)g
(A)o(CM)g(Symposium)g(on)h(Principles)f(of)h(Pr)n(ogr)o(amming)f(Languages)p
Fk(,)f(January)j(1989,)e(pp.)282 2184 y(293\261302.)75 2259
y([AM87])70 b(Appel,)16 b(A.)g(W)l(.)f(and)g(D.)h(B.)f(MacQueen.)29
b(A)15 b(Standard)g(ML)g(compiler)n(.)27 b(In)15 b Fe(Functional)e(Pr)n(ogr)o
(amming)282 2309 y(Languages)7 b(and)g(Computer)g(Ar)n(c)o(hitectur)n(e)p
Fk(,)k(v)o(ol.)d(274)f(of)h Fe(Lectur)n(e)h(Notes)f(in)g(Computer)f(Science)p
Fk(.)i(Springer)o(-)282 2358 y(V)-5 b(erlag,)11 b(September)g(1987,)f(pp.)g
(301\261324.)75 2433 y([App89])65 b(Appel,)14 b(A.)f(W)l(.)23
b(Simple)13 b(generational)f(garbage)i(collection)e(and)h(fast)f(allocation.)
22 b Fe(Softwar)n(e)12 b(\261)h(Pr)o(actice)282 2483 y(and)d(Experience)p
Fk(,)i Fl(19)p Fk(\(2\),)e(February)g(1989,)g(pp.)g(275\261279.)75
2558 y([AS83])84 b(Andre)o(ws.,)10 b(G.)g(R.)f(and)g(F)m(.)g(B.)h(Schneider)n
(.)j(Concepts)8 b(and)i(notations)d(for)i(concurrent)f(programming.)13
b Fe(A)o(CM)282 2608 y(Computing)8 b(Surve)o(ys)p Fk(,)k Fl(15)p
Fk(\(1\),)d(March)i(1983,)f(pp.)g(3\26143.)952 2802 y Fy(20)p
eop
%%Page: 21 21
21 20 bop 75 82 a Fk([BCJ)161 67 y Fa(+)188 82 y Fk(90])38
b(Birman,)13 b(K.,)g(R.)g(Cooper)n(,)g(T)m(.)g(A.)g(Joseph,)g(K.)g(Marzullo,)
f(M.)h(Makpangou,)f(K.)h(Kane,)h(F)m(.)e(Schmuck,)i(and)282
132 y(M.)i(W)m(ood.)28 b Fe(The)16 b(ISIS)f(system)h(manual,)g(version)f(2.0)
p Fk(.)29 b(Department)15 b(of)h(Computer)e(Science,)k(Cornell)282
182 y(Uni)o(v)o(ersity)m(,)10 b(Ithaca,)h(N.Y)-5 b(.,)11 b(March)g(1990.)75
257 y([Bor86])74 b(Bornat,)18 b(R.)33 b(A)17 b(protocol)e(for)h(generalized)i
(occam.)34 b Fe(Softwar)n(e)16 b(\261)h(Pr)o(actice)h(and)e(Experience)p
Fk(,)21 b Fl(16)p Fk(\(9\),)282 306 y(September)11 b(1986,)f(pp.)g
(783\261799.)75 381 y([BS90])86 b(Buhr)n(,)17 b(P)-5 b(.)17
b(A.)f(and)g(R.)g(A.)g(Stroobosscher)n(.)28 b(The)17 b Fj(\026)p
Fk(System:)25 b(Pro)o(viding)14 b(light-weight)f(concurrenc)o(y)j(on)282
431 y(shared-memory)11 b(multiprocessor)f(computers)h(running)e(UNIX.)16
b Fe(Softwar)n(e)10 b(\261)h(Pr)o(actice)h(and)e(Experience)p
Fk(,)282 481 y Fl(20)p Fk(\(9\),)g(September)h(1990,)e(pp.)i(929\261963.)75
555 y([Bur88])74 b(Burns,)10 b(A.)15 b Fe(Pr)n(ogr)o(amming)10
b(in)f(occam)i(2)p Fk(.)k(Addison-W)m(esle)o(y)m(,)10 b(Reading,)g(Mass.,)i
(1988.)75 630 y([Car86])77 b(Cardelli,)17 b(L.)32 b(Amber)n(.)f(In)16
b Fe(Combinators)e(and)i(Functional)f(Pr)n(ogr)o(amming)g(Languages)p
Fk(,)i(v)o(ol.)f(242)f(of)282 680 y Fe(Lectur)n(e)d(Notes)e(in)f(Computer)h
(Science)p Fk(.)h(Springer)o(-V)-5 b(erlag,)10 b(July)g(1986,)g(pp.)g
(21\26147.)75 755 y([CM90])72 b(Cooper)n(,)11 b(E.)g(C.)g(and)f(J.)i(G.)f
(Morrisett.)j(Adding)9 b(threads)i(to)f(Standard)g(ML.)16 b
Fe(T)l(ec)o(hnical)11 b(Report)g(CMU-CS-)282 804 y(90-186)p
Fk(,)e(School)h(of)g(Computer)g(Science,)h(Carne)o(gie)g(Mellon)e(Uni)o(v)o
(ersity)m(,)h(December)i(1990.)75 879 y([CP85])86 b(Cardelli,)9
b(L.)h(and)f(R.)h(Pike.)j(Squeak:)h(A)c(language)f(for)g(communicating)g
(with)f(mice.)14 b(In)9 b Fe(SIGGRAPH)h('85)p Fk(,)282 929
y(July)g(1985,)f(pp.)i(199\261204.)75 1004 y([DH89])77 b(Dyb)o(vig,)13
b(R.)g(K.)g(and)g(R.)g(Hieb)n(.)22 b(Engines)13 b(from)f(continuations.)20
b Fe(Computing)10 b(Languages)p Fk(,)j Fl(14)p Fk(\(2\),)g(1989,)282
1054 y(pp.)d(109\261123.)75 1128 y([DHM91])40 b(Duba,)11 b(B.,)g(R.)g(Harper)
n(,)g(and)g(D.)g(MacQueen.)17 b(T)m(ype-checking)10 b(\256rst-class)g
(continuations.)k(In)c Fe(Confer)n(ence)282 1178 y(Recor)n(d)i(of)e(the)g
(18th)g(Annual)f(A)o(CM)h(Symposium)g(on)g(Principles)g(of)g(Pr)n(ogr)o
(amming)g(Languages)p Fk(,)f(January)282 1228 y(1991,)h(pp.)g(163\261173.)75
1303 y([Haa90])71 b(Haahr)n(,)11 b(D.)i(Montage:)g(Breaking)c(windo)o(ws)f
(into)g(small)h(pieces.)14 b(In)9 b Fe(USENIX)g(Summer)g(Confer)n(ence)p
Fk(,)i(June)282 1352 y(1990,)f(pp.)g(289\261297.)75 1427 y([Har86])75
b(Harper)n(,)16 b(R.)24 b(Introduction)12 b(to)h(Standard)g(ML.)26
b Fe(T)l(ec)o(hnical)14 b(Report)g(ECS-LFCS-86-14)p Fk(,)f(Laboratory)h(for)
282 1477 y(F)o(oundations)7 b(of)g(Computer)g(Science,)j(Computer)c(Science)j
(Department,)g(Edinb)o(ur)o(gh)d(Uni)o(v)o(ersity)m(,)i(August)282
1527 y(1986.)75 1601 y([HDB90])49 b(Hieb,)13 b(R.,)g(R.)f(K.)h(Dyb)o(vig,)f
(and)g(C.)g(Bruggeman.)20 b(Representing)11 b(control)g(in)h(the)g(presence)h
(of)f(\256rst-class)282 1651 y(continuations.)7 b(In)g Fe(Pr)n(oceedings)g
(of)g(the)g(SIGPLAN'90)g(Conf)o(er)n(ence)g(on)g(Pr)n(ogr)o(amming)g(Langu)o
(ag)o(e)g(Design)282 1701 y(and)j(Implementation)p Fk(,)e(June)j(1990,)e(pp.)
i(66\26177.)75 1776 y([HFW84])45 b(Haynes,)9 b(C.)f(T)m(.,)i(D.)e(P)-5
b(.)8 b(Friedman,)h(and)f(M.)g(W)m(and.)j(Continuations)5 b(and)i
(coroutines.)j(In)e Fe(Confer)n(ence)g(r)n(ecor)n(d)282 1826
y(of)i(the)g(1984)f(A)o(CM)h(Confer)n(ence)h(on)f(Lisp)g(and)g(Functional)e
(Pr)n(ogr)o(amming)p Fk(,)i(July)g(1984,)f(pp.)i(293\261298.)75
1900 y([Hol83])74 b(Holmstr)s(\310)-17 b(om,)11 b(S.)17 b(PFL:)11
b(A)g(functional)f(language)h(for)f(parallel)h(programming.)16
b(In)10 b Fe(Declar)o(ative)i(pr)n(ogr)o(am-)282 1950 y(ming)d(workshop)p
Fk(,)i(April)e(1983,)g(pp.)i(114\261139.)75 2025 y([KKR)177
2010 y Fa(+)204 2025 y Fk(86])22 b(Kranz,)d(D.,)h(R.)c(K)o(else)o(y)m(,)k(J.)
e(Rees,)h(P)-5 b(.)18 b(Hudak,)g(J.)g(Philbin,)e(and)h(N.)g(Adams.)33
b(Orbit:)27 b(An)16 b(optimizing)282 2075 y(compiler)8 b(for)g(Scheme.)13
b(In)8 b Fe(Pr)n(oceedings)h(of)f(the)g(SIGPLAN'86)g(Symposium)g(on)g
(Compiler)f(Construction)p Fk(,)282 2125 y(July)j(1986,)f(pp.)i(219\261233.)
75 2199 y([LCJS87])45 b(Lisko)o(v)m(,)11 b(B.,)g(D.)g(Curtis,)f(P)-5
b(.)11 b(Johnson,)f(and)h(R.)g(Schei\257er)n(.)16 b(Implementation)10
b(of)g(Ar)o(gus.)16 b(In)10 b Fe(Pr)n(oceedings)i(of)282 2249
y(the)e(11th)f(A)o(CM)h(Symposium)g(on)f(Oper)o(ating)h(System)h(Principles)p
Fk(,)f(No)o(v)o(ember)h(1987,)f(pp.)g(111\261122.)75 2324 y([Lie86])82
b(Lieberman,)21 b(H.)34 b(Using)17 b(prototypical)e(objects)j(to)f(implement)
g(shared)h(beha)o(vior)f(in)g(object)g(oriented)282 2374 y(systems.)f(In)10
b Fe(OOPSLA)n('86)g(Pr)n(oceedings)p Fk(,)i(September)f(1986,)f(pp.)g
(214\261223.)75 2448 y([LS88])89 b(Lisko)o(v)m(,)17 b(B.)e(and)g(L.)h
(Shrira.)28 b(Promises:)c(Linguistic)14 b(support)g(for)g(ef)o(\256cient)i
(asynchronous)e(procedure)282 2498 y(calls)g(in)f(distrib)o(uted)e(systems.)
25 b(In)13 b Fe(Pr)n(oceedings)h(of)f(the)g(SIGPLAN'88)g(Confer)n(ence)i(on)e
(Pr)n(ogr)o(amming)282 2548 y(Language)c(Design)h(and)f(Implementation)p
Fk(,)g(June)h(1988,)g(pp.)g(260\261267.)75 2623 y([Mac84])64
b(MacQueen,)11 b(D.)e(B.)k(Modules)8 b(for)h(Standard)f(ML.)14
b(In)8 b Fe(Confer)n(ence)i(r)n(ecor)n(d)h(of)d(the)h(1984)f(A)o(CM)g(Confer)
n(ence)282 2672 y(on)i(Lisp)g(and)g(Functional)e(Pr)n(ogr)o(amming)p
Fk(,)i(July)f(1984,)h(pp.)g(198\261207.)952 2802 y Fy(21)p
eop
%%Page: 22 22
22 21 bop 75 82 a Fk([Mat89])70 b(Matthe)o(ws,)14 b(D.)f(C.)f(J.)22
b(Processes)14 b(for)f(Poly)f(and)g(ML.)22 b(In)13 b Fe(P)m(apers)f(on)g(P)m
(oly/ML,)h(T)l(ec)o(hnical)g(Report)f(161)p Fk(.)282 132 y(Uni)o(v)o(ersity)d
(of)h(Cambridge,)g(February)g(1989.)75 207 y([MTH90])45 b(Milner)n(,)9
b(R.,)h(M.)f(T)m(ofte,)h(and)f(R.)g(Harper)n(.)k Fe(The)c(De\256nition)e(of)i
(Standar)n(d)e(ML)p Fk(.)13 b(The)d(MIT)f(Press,)h(Cambridge,)282
257 y(Mass,)h(1990.)75 331 y([Nye90])68 b(Nye,)11 b(A.)k Fe(Xlib)10
b(Pr)n(ogr)o(amming)f(Manual)p Fk(,)g(v)o(ol.)h(1.)15 b(O'Reilly)9
b(&)i(Associates,)g(Inc.,)g(1990.)75 406 y([P)o(au91])76 b(P)o(aulson,)11
b(L.)h(C.)j Fe(ML)c(for)f(the)g(W)l(orking)g(Pr)n(ogr)o(ammer)p
Fk(.)17 b(Cambridge)10 b(Uni)o(v)o(ersity)g(Press,)h(Ne)o(w)g(Y)-5
b(ork,)11 b(N.Y)-5 b(.,)282 456 y(1991.)75 531 y([Pik89])81
b(Pike,)10 b(R.)15 b(A)c(concurrent)e(windo)o(w)h(system.)15
b Fe(Computing)8 b(Systems)p Fk(,)j Fl(2)p Fk(\(2\),)f(1989,)g(pp.)g
(133\261153.)75 605 y([Ram90])59 b(Ramse)o(y)m(,)15 b(N.)20
b(Concurrent)11 b(programming)g(in)h(ML.)20 b Fe(T)l(ec)o(hnical)13
b(Report)f(CS-TR-262-90)p Fk(,)f(Department)h(of)282 655 y(Computer)d
(Science,)j(Princeton)e(Uni)o(v)o(ersity)m(,)f(April)h(1990.)75
730 y([Rep])112 b(Reppy)m(,)19 b(J.)g(H.)35 b(T)m(wo)17 b(garbage)h
(collectors)g(for)f(SML/NJ.)35 b(Cornell)17 b(Uni)o(v)o(ersity)f(technical)i
(report)f(\()p Fe(in)282 780 y(pr)n(epar)o(ation)p Fk(\).)75
854 y([Rep88])70 b(Reppy)m(,)13 b(J.)g(H.)21 b(Synchronous)11
b(operations)h(as)h(\256rst-class)f(v)o(alues.)21 b(In)12 b
Fe(Pr)n(oceedings)i(of)d(the)i(SIGPLAN'88)282 904 y(Confer)n(ence)e(on)f(Pr)n
(ogr)o(amming)g(Language)e(Design)i(and)g(Implementation)p
Fk(,)e(June)j(1988,)e(pp.)i(250\261259.)75 979 y([Rep89])70
b(Reppy)m(,)10 b(J.)h(H.)16 b(First-class)10 b(synchronous)f(operations)h(in)
f(Standard)h(ML.)16 b Fe(T)l(ec)o(hnical)11 b(Report)f(TR)h(89-1068)p
Fk(,)282 1029 y(Department)f(of)g(Computer)g(Science,)i(Cornell)d(Uni)o(v)o
(ersity)m(,)g(December)j(1989.)75 1103 y([Rep90a])52 b(Reppy)m(,)10
b(J.)i(H.)j(Asynchronous)10 b(signals)g(in)g(Standard)g(ML.)16
b Fe(T)l(ec)o(hnical)11 b(Report)g(TR)g(90-1144)p Fk(,)e(Department)282
1153 y(of)h(Computer)f(Science,)j(Cornell)d(Uni)o(v)o(ersity)m(,)h(August)f
(1990.)75 1228 y([Rep90b])49 b(Reppy)m(,)12 b(J.)h(H.)19 b
Fe(Concurr)n(ent)12 b(pr)n(ogr)o(amming)f(with)f(e)o(vents)j(\261)f(The)g
(Concurr)n(ent)g(ML)g(manual)p Fk(.)18 b(Department)282 1278
y(of)12 b(Computer)f(Science,)j(Cornell)d(Uni)o(v)o(ersity)m(,)h(Ithaca,)i
(N.Y)-5 b(.,)13 b(No)o(v)o(ember)g(1990.)20 b(\(Last)12 b(re)o(vised)g
(October)282 1328 y(1991\).)75 1402 y([Rep92])70 b(Reppy)m(,)13
b(J.)f(H.)21 b Fe(Higher)o(-or)n(der)13 b(concurr)n(ency)p
Fk(.)22 b(Ph.D.)13 b(dissertation,)f(Department)g(of)g(Computer)g(Science,)
282 1452 y(Cornell)d(Uni)o(v)o(ersity)m(,)h(Ithaca,)h(NY)-5
b(,)10 b(January)h(1992.)j(A)m(v)o(ailable)c(as)h(T)m(echnical)g(Report)e(TR)
i(92-1285.)75 1527 y([RG86])79 b(Reppy)m(,)16 b(J.)g(H.)g(and)f(E.)h(R.)g
(Gansner)n(.)28 b(A)16 b(foundation)d(for)i(programming)f(en)n(vironments.)28
b(In)15 b Fe(Pr)n(oceed-)282 1577 y(ings)d(of)h(the)g(A)o(CM)f
(SIGSOFT/SIGPLAN)h(Softwar)n(e)f(Engineering)g(Symposium)g(on)h(Pr)o(actical)
g(Softwar)n(e)282 1626 y(De)o(velopment)e(En)n(vir)n(onments)p
Fk(,)g(December)h(1986,)d(pp.)i(218\261227.)75 1701 y([SG86])84
b(Schei\257er)n(,)16 b(R.)d(W)l(.)h(and)g(J.)g(Gettys.)22 b(The)14
b(X)g(windo)o(w)e(system.)24 b Fe(A)o(CM)13 b(T)n(r)o(ansactions)f(on)h(Gr)o
(aphics)p Fk(,)h Fl(5)p Fk(\(2\),)282 1751 y(April)9 b(1986,)h(pp.)g
(79\261109.)75 1826 y([Sha87])75 b(Sha)o(w)m(,)16 b(R.)e(A.)26
b(Impro)o(ving)12 b(garbage)i(collection)f(performance)i(in)e(virtual)g
(memory)m(.)26 b Fe(T)l(ec)o(hnical)14 b(Report)282 1875 y(CSL-TR-87-323)p
Fk(,)9 b(Computer)g(Systems)i(Laboratory)m(,)g(Stanford)e(Uni)o(v)o(ersity)m
(,)h(1987.)75 1950 y([Ste78])84 b(Steele)11 b(Jr)n(.,)g(G.)f(L.)16
b(Rabbit:)d(A)e(compiler)f(for)f(Scheme.)17 b(Master')n(s)11
b(dissertation,)e(MIT)m(,)h(May)h(1978.)75 2025 y([W)m(an80])62
b(W)m(and,)11 b(M.)17 b(Continuation)o(-based)9 b(multiprocessing.)14
b(In)d Fe(Confer)n(ence)h(Recor)n(d)g(of)e(the)g(1980)g(Lisp)h(Confer)o(-)282
2075 y(ence)p Fk(,)h(August)d(1980,)h(pp.)g(19\26128.)75 2242
y Fz(A)o(ppendix)15 b(\261)g(A)f(brief)h(intr)o(oduction)i(to)e(Standard)h
(ML)75 2367 y Fy(This)f(appendix)f(gi)o(v)o(es)h(a)h(brief)f(introduction)f
(to)h(the)g(major)g(aspects)g(of)h(Standard)f(ML.)h Fx(SML)g
Fy(is)f(formally)75 2423 y(de\256ned)20 b(in)e([MTH90];)23
b(for)c(a)h(tutorial)e(introduction)f(see)j([P)o(au91)q(])f(or)g([Har86)q(].)
40 b(It)19 b(has)h(the)f(follo)o(wing)75 2479 y(important)10
b(characteristics:)143 2594 y Fr(\017)23 b Fx(SML)12 b Fy(is)f(a)h(higher)o
(-order)f(language:)16 b(functions)11 b(are)h(\256rst-class)f(v)o(alues.)952
2802 y(22)p eop
%%Page: 23 23
23 22 bop 143 82 a Fr(\017)23 b Fx(SML)11 b Fy(is)e(strongly)g(typed:)15
b(e)o(v)o(ery)10 b(e)o(xpression)g(has)g(a)g(type,)g(which)g(is)f(inferred)i
(by)e(the)h(compiler)m(.)17 b(There)189 139 y(are)12 b(no)f(run-time)g(type)g
(errors.)143 232 y Fr(\017)23 b Fx(SML)14 b Fy(has)f(a)g(polymorphic)f
(type-system:)18 b(the)13 b(type)g(of)g(an)g(e)o(xpression)g(inferred)g(by)g
(the)g(compiler)g(is)189 289 y(the)e(most)f(general)i(possible)e(type)h(for)h
(the)f(e)o(xpression.)143 383 y Fr(\017)23 b Fx(SML)12 b Fy(is)f(le)o
(xically)g(scoped.)143 477 y Fr(\017)23 b Fx(SML)12 b Fy(has)f(a)g(pattern)g
(matching)f(facility)g(for)i(decomposing)d(structured)i(v)o(alues.)16
b(This)11 b(facility)f(is)g(used)189 533 y(in)h Fq(equational)e
Fy(de\256nitions)i(of)g(functions)f(and)i(in)f(a)g(generalized)h
Fp(case)p Fy(-e)o(xpression.)143 627 y Fr(\017)23 b Fx(SML)12
b Fy(has)g(a)g(po)o(werful)f(datatype)h(mechanism:)k(datatype)11
b(declarations)h(introduce)f Fq(constructors)f Fy(that)189
683 y(may)h(be)g(used)g(to)g(b)o(uild)g(v)o(alues)g(in)g(e)o(xpressions)f
(and)i(to)f(decompose)f(v)o(alues)h(in)g(patterns.)143 777
y Fr(\017)23 b Fx(SML)12 b Fy(has)f(a)h(type-safe)g(e)o(xception)f
(mechanism.)143 871 y Fr(\017)23 b Fx(SML)12 b Fy(has)f(a)h
(\252state-of-the-art\272)g(module)f(facility)m(.)75 985 y(A)g(fe)o(w)h(e)o
(xamples)f(illustrate)g(most)f(of)h(the)g(features)h(used)f(in)g(this)g
(paper)m(.)146 1063 y Fx(SML)h Fy(has)f(a)h(prede\256ned)g(list)e(type)h
(constructor)n(,)h(which)f(is)g(de\256ned)h(by)f(the)g(declaration:)146
1171 y FA(datatype)20 b('a)h(list)g(=)h(nil)f(|)g(::)h(of)f(\('a)g(*)h('a)f
(list\))146 1220 y(infix)f(::)75 1335 y Fy(The)10 b(\256rst)g(line)g(says)f
(that)h Fp(list)f Fy(is)h(a)g(type)g(constructor)g(with)f(two)g
(constructors:)15 b Fp(nil)p Fy(,)10 b(which)g(is)f(the)h(polymor)o(-)75
1391 y(phic)i(empty-list,)g(and)g(\252)p Fp(::)p Fy(\272)19
b(\(pronounced)12 b Fq(cons)p Fy(\).)20 b(Constructors)12 b(are)h(use)g(in)f
(e)o(xpressions)g(to)g(b)o(uild)f(v)o(alues,)75 1448 y(and)h(used)h(in)f
(patterns)g(to)g(destruct)g(v)o(alues.)20 b(Note)12 b(that)g(type)g
(constructors)g(are)h(post\256x)f(operators)g(\(the)h(\252)p
Fp('a)p Fy(\272)75 1504 y(is)e(a)h(type)f(v)o(ariable\),)h(with)e(the)i(e)o
(xception)f(of)g(two)g(b)o(uilt-in)f(constructors:)15 b(\252)p
Fp(->)p Fy(\272)d(for)g(function)e(types)h(and)h(\252)p Fp(*)p
Fy(\272)75 1561 y(for)g(tuple)e(types.)17 b(The)11 b(second)g(line)g
(declares)h(\252)p Fp(::)p Fy(\272)17 b(to)11 b(be)g(an)h(in\256x)f(operator)
m(.)146 1638 y(Because)i(lists)d(are)j(an)f(important)e(type,)j
Fx(SML)g Fy(pro)o(vides)e(syntactic)g(sugar)h(for)g(list)f(patterns)g(and)h
(e)o(xpres-)75 1694 y(sions.)k(The)11 b(syntax)146 1802 y FA([$e_1,)20
b(...,)h(e_n$])75 1917 y Fy(is)11 b(syntactic)g(sugar)g(for)146
2025 y FA($e_1$::$e_2$::)18 b($...$)j(::$e_n$::nil)75 2139
y Fy(The)11 b(list)g(re)o(v)o(erse)h(function)f(uses)g(this)f(syntax)h(for)g
(the)h(empty)e(list)g(in)h(its)g(patterns:)146 2247 y FA(fun)21
b(rev)g(l)g(=)h(let)276 2297 y(fun)f(rev')g(\([],)g(l\))h(=)f(l)320
2347 y(|)g(rev')g(\(x::r,)g(l\))g(=)h(rev')f(\(r,)g(x::l\))276
2397 y(in)320 2447 y(rev')g(\(l,)g([]\))276 2496 y(end)75 2611
y Fy(The)11 b(tail-recursi)o(v)o(e)g(function)g Fp(rev')f Fy(is)h(a)g
(function)g(from)g(a)g(pair)g(of)g(lists)f(to)h(a)g(list.)16
b(It)11 b(is)g(de\256ned)g(equationally)75 2667 y(in)h(two)f(clauses.)19
b(The)13 b(\256rst)f(clause)g(says)g(to)g(return)g(the)g(second)g(ar)o
(gument)g(if)g(the)g(\256rst)h(is)f(the)g(empty)f(list;)g(the)952
2802 y(23)p eop
%%Page: 24 24
24 23 bop 75 82 a Fy(second)11 b(clause)g(is)f(a)h(tail-recursi)o(v)o(e)g
(call)g(which)g(conses)f(the)h(head)g(of)g(the)g(\256rst)g(ar)o(gument)f(to)h
(the)f(second.)17 b(The)75 139 y(function)10 b Fp(rev)g Fy(is)h(polymorphic;)
e(it)h(will)g(work)g(on)h(lists)e(of)i(an)o(y)g(type.)17 b(T)l(ail-recursion)
10 b(is)h(the)f(standard)h(way)f(to)75 195 y(code)i(loops)e(in)h
Fx(SML)p Fy(.)146 272 y(A)f(more)h(complicated)f(e)o(xample)h(is)g(the)g
(follo)o(wing)e(functional)h(implementation)f(of)i(polymorphic)e(FIFO)75
329 y(queues:)146 432 y FA(abstype)20 b('a)h(queue)g(=)h(Q)f(of)189
482 y({front)g(:)g('a)h(list,)e(rear)h(:)h('a)f(list})146 531
y(with)189 581 y(fun)g(queue)g(\(\))g(=)h(Q{front)e(=)i([],)f(rear)g(=)h([]})
189 631 y(fun)f(insert)g(\(x,)g(Q{front,)f(rear}\))h(=)320
681 y(Q{front)f(=)i(front,)e(rear)h(=)h(x::rear})189 731 y(exception)e
(EmptyQ)189 780 y(fun)h(remove)g(\(Q{front)f(=)i([],)f(rear)g(=)g([]}\))g(=)
320 830 y(raise)g(EmptyQ)233 880 y(|)g(remove)g(\(Q{front)f(=)i([],)f
(rear}\))f(=)320 930 y(remove\(Q{front)f(=)i(rev)h(rear,)e(rear)h(=)h([]}\))
233 980 y(|)f(remove)g(\(Q{front)f(=)i(x::r,)e(rear}\))h(=)320
1030 y(\(x,)g(Q{front)f(=)i(r,)f(rear)g(=)h(rear}\))189 1079
y(fun)f(head)g(q)h(=)f(let)h(val)f(\(x,)g(_\))g(=)h(remove)e(q)i(in)f(x)h
(end)146 1129 y(end)f(\(*)g(abstype)f(*\))75 1239 y Fy(The)11
b(syntax)146 1342 y FA({$l_1$)20 b(=)i($e_1$,)e($...$,)h($l_n$)g(=)g($e_n$})
75 1452 y Fy(de\256nes)11 b(a)g(labeled)f(record.)17 b(This)10
b(syntax)g(is)g(also)g(used)g(in)g(patterns)g(to)g(destruct)h(record)g(v)o
(alues.)16 b(It)10 b(is)g(possible)75 1508 y(to)k(abbre)o(viate)h(a)h
(labeled)e(record)i(pattern)f(in)f(two)g(ways,)i(as)e(illustrated)g(by)h(the)
f(follo)o(wing)g(e)o(xample.)27 b(The)75 1564 y(abbre)o(viated)11
b(pattern:)146 1667 y FA(\(Q{front,)19 b(...}\))75 1777 y Fy(is)11
b(syntactic)g(sugar)g(for)g(the)h(pattern)146 1880 y FA(\(Q{front)20
b(=)h(front,)g(rear)g(=)g(rear}\))75 1990 y Fy(This)c Fp(abstype)f
Fy(declaration)i(de\256nes)g(a)f(ne)o(w)h(type)f(constructor)n(,)i
Fp(queue)p Fy(,)g(together)e(with)g(a)g(collection)g(of)75
2046 y(operations.)27 b(A)15 b Fp(queue)f Fy(v)o(alue)h(is)f(represented)i
(by)e(the)h(constructor)g Fp(Q)f Fy(applied)h(to)f(a)i(record)f(of)g(two)f
(\256elds:)75 2103 y Fp(front)e Fy(and)g Fp(rear)p Fy(,)h(which)f(are)i(both)
d(lists.)19 b(This)12 b(declaration)h(introduces)e(the)i(follo)o(wing)e
(bindings)g(into)g(the)75 2159 y(en)n(vironment:)146 2262 y
FA(type)21 b('a)g(queue)146 2312 y(val)g(queue)f(:)i(unit)f(->)g('a)h(queue)
146 2362 y(val)f(insert)f(:)i('a)f(*)h('a)f(queue)g(->)g('a)h(queue)146
2412 y(exception)d(EmptyQ)146 2462 y(val)i(remove)f(:)i('a)f(queue)g(->)g('a)
h(*)f('a)h(queue)146 2511 y(val)f(head)g(:)g('a)h(queue)e(->)i('a)75
2621 y Fy(Because)17 b(this)e(is)g(an)g Fp(abstype)g Fy(declaration,)i(the)f
(representation)f(of)h(a)g Fp(queue)f Fy(is)g(not)g(visible)g(outside)f(the)
75 2677 y(declaration.)j(The)11 b(type)g Fp(unit)g Fy(is)g(the)g(type)g(with)
g(one)g(member:)16 b(the)11 b(empty)g(tuple)g(\252)p Fp(\(\))p
Fy(.)m(\272)952 2802 y(24)p eop
%%Page: 25 25
25 24 bop 146 82 a Fx(SML/NJ)12 b Fy(pro)o(vides)g(\256rst-class)g
(continuations)f(as)h(an)g(e)o(xperimental)g(e)o(xtension)1470
68 y Fw([DHM91)n(])1602 82 y Fy(.)20 b(The)12 b(interface)75
139 y(is:)146 247 y FA(type)21 b('a)g(cont)146 296 y(val)g(callcc)f(:)i(\('a)
f(cont)g(->)g('a\))h(->)f('a)146 346 y(val)g(throw)f(:)i('a)f(cont)g(->)h('a)
f(->)h('b)75 461 y Fy(These)11 b(are)i(used)e(in)g(the)g(implementation)e(of)
i Fx(CML)h Fy(to)f(implement)f(threads.)952 2802 y(25)p eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
